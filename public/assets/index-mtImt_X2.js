function eb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function tb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wx={exports:{}},au={},jx={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bo=Symbol.for("react.element"),nb=Symbol.for("react.portal"),rb=Symbol.for("react.fragment"),sb=Symbol.for("react.strict_mode"),ab=Symbol.for("react.profiler"),ib=Symbol.for("react.provider"),ob=Symbol.for("react.context"),lb=Symbol.for("react.forward_ref"),cb=Symbol.for("react.suspense"),ub=Symbol.for("react.memo"),db=Symbol.for("react.lazy"),Eg=Symbol.iterator;function hb(t){return t===null||typeof t!="object"?null:(t=Eg&&t[Eg]||t["@@iterator"],typeof t=="function"?t:null)}var _x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nx=Object.assign,bx={};function ri(t,e,n){this.props=t,this.context=e,this.refs=bx,this.updater=n||_x}ri.prototype.isReactComponent={};ri.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ri.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kx(){}kx.prototype=ri.prototype;function _p(t,e,n){this.props=t,this.context=e,this.refs=bx,this.updater=n||_x}var Np=_p.prototype=new kx;Np.constructor=_p;Nx(Np,ri.prototype);Np.isPureReactComponent=!0;var Ig=Array.isArray,Tx=Object.prototype.hasOwnProperty,bp={current:null},Ex={key:!0,ref:!0,__self:!0,__source:!0};function Ix(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Tx.call(e,r)&&!Ex.hasOwnProperty(r)&&(a[r]=e[r]);var l=arguments.length-2;if(l===1)a.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];a.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)a[r]===void 0&&(a[r]=l[r]);return{$$typeof:Bo,type:t,key:i,ref:o,props:a,_owner:bp.current}}function pb(t,e){return{$$typeof:Bo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bo}function fb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Sg=/\/+/g;function dd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fb(""+t.key):e.toString(36)}function Kl(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Bo:case nb:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+dd(o,0):r,Ig(a)?(n="",t!=null&&(n=t.replace(Sg,"$&/")+"/"),Kl(a,e,n,"",function(d){return d})):a!=null&&(kp(a)&&(a=pb(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Sg,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",Ig(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+dd(i,l);o+=Kl(i,e,n,u,a)}else if(u=hb(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+dd(i,l++),o+=Kl(i,e,n,u,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Nl(t,e,n){if(t==null)return t;var r=[],a=0;return Kl(t,r,"","",function(i){return e.call(n,i,a++)}),r}function mb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Yt={current:null},Gl={transition:null},gb={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:Gl,ReactCurrentOwner:bp};function Sx(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Nl,forEach:function(t,e,n){Nl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Nl(t,function(){e++}),e},toArray:function(t){return Nl(t,function(e){return e})||[]},only:function(t){if(!kp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ce.Component=ri;Ce.Fragment=rb;Ce.Profiler=ab;Ce.PureComponent=_p;Ce.StrictMode=sb;Ce.Suspense=cb;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gb;Ce.act=Sx;Ce.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Nx({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=bp.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Tx.call(e,u)&&!Ex.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Bo,type:t.type,key:a,ref:i,props:r,_owner:o}};Ce.createContext=function(t){return t={$$typeof:ob,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ib,_context:t},t.Consumer=t};Ce.createElement=Ix;Ce.createFactory=function(t){var e=Ix.bind(null,t);return e.type=t,e};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(t){return{$$typeof:lb,render:t}};Ce.isValidElement=kp;Ce.lazy=function(t){return{$$typeof:db,_payload:{_status:-1,_result:t},_init:mb}};Ce.memo=function(t,e){return{$$typeof:ub,type:t,compare:e===void 0?null:e}};Ce.startTransition=function(t){var e=Gl.transition;Gl.transition={};try{t()}finally{Gl.transition=e}};Ce.unstable_act=Sx;Ce.useCallback=function(t,e){return Yt.current.useCallback(t,e)};Ce.useContext=function(t){return Yt.current.useContext(t)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(t){return Yt.current.useDeferredValue(t)};Ce.useEffect=function(t,e){return Yt.current.useEffect(t,e)};Ce.useId=function(){return Yt.current.useId()};Ce.useImperativeHandle=function(t,e,n){return Yt.current.useImperativeHandle(t,e,n)};Ce.useInsertionEffect=function(t,e){return Yt.current.useInsertionEffect(t,e)};Ce.useLayoutEffect=function(t,e){return Yt.current.useLayoutEffect(t,e)};Ce.useMemo=function(t,e){return Yt.current.useMemo(t,e)};Ce.useReducer=function(t,e,n){return Yt.current.useReducer(t,e,n)};Ce.useRef=function(t){return Yt.current.useRef(t)};Ce.useState=function(t){return Yt.current.useState(t)};Ce.useSyncExternalStore=function(t,e,n){return Yt.current.useSyncExternalStore(t,e,n)};Ce.useTransition=function(){return Yt.current.useTransition()};Ce.version="18.3.1";jx.exports=Ce;var C=jx.exports;const Tp=tb(C),vb=eb({__proto__:null,default:Tp},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yb=C,xb=Symbol.for("react.element"),wb=Symbol.for("react.fragment"),jb=Object.prototype.hasOwnProperty,_b=yb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Nb={key:!0,ref:!0,__self:!0,__source:!0};function Cx(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)jb.call(e,r)&&!Nb.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:xb,type:t,key:i,ref:o,props:a,_owner:_b.current}}au.Fragment=wb;au.jsx=Cx;au.jsxs=Cx;wx.exports=au;var s=wx.exports,Yd={},Px={exports:{}},gn={},Rx={exports:{}},Ax={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,D){var q=W.length;W.push(D);e:for(;0<q;){var G=q-1>>>1,I=W[G];if(0<a(I,D))W[G]=D,W[q]=I,q=G;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var D=W[0],q=W.pop();if(q!==D){W[0]=q;e:for(var G=0,I=W.length,O=I>>>1;G<O;){var F=2*(G+1)-1,H=W[F],X=F+1,te=W[X];if(0>a(H,q))X<I&&0>a(te,H)?(W[G]=te,W[X]=q,G=X):(W[G]=H,W[F]=q,G=F);else if(X<I&&0>a(te,q))W[G]=te,W[X]=q,G=X;else break e}}return D}function a(W,D){var q=W.sortIndex-D.sortIndex;return q!==0?q:W.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,f=null,m=3,_=!1,E=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var D=n(d);D!==null;){if(D.callback===null)r(d);else if(D.startTime<=W)r(d),D.sortIndex=D.expirationTime,e(u,D);else break;D=n(d)}}function R(W){if(w=!1,S(W),!E)if(n(u)!==null)E=!0,B(L);else{var D=n(d);D!==null&&ee(R,D.startTime-W)}}function L(W,D){E=!1,w&&(w=!1,v(y),y=-1),_=!0;var q=m;try{for(S(D),f=n(u);f!==null&&(!(f.expirationTime>D)||W&&!A());){var G=f.callback;if(typeof G=="function"){f.callback=null,m=f.priorityLevel;var I=G(f.expirationTime<=D);D=t.unstable_now(),typeof I=="function"?f.callback=I:f===n(u)&&r(u),S(D)}else r(u);f=n(u)}if(f!==null)var O=!0;else{var F=n(d);F!==null&&ee(R,F.startTime-D),O=!1}return O}finally{f=null,m=q,_=!1}}var U=!1,N=null,y=-1,k=5,b=-1;function A(){return!(t.unstable_now()-b<k)}function z(){if(N!==null){var W=t.unstable_now();b=W;var D=!0;try{D=N(!0,W)}finally{D?T():(U=!1,N=null)}}else U=!1}var T;if(typeof j=="function")T=function(){j(z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,Q=$.port2;$.port1.onmessage=z,T=function(){Q.postMessage(null)}}else T=function(){x(z,0)};function B(W){N=W,U||(U=!0,T())}function ee(W,D){y=x(function(){W(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){E||_||(E=!0,B(L))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(W){switch(m){case 1:case 2:case 3:var D=3;break;default:D=m}var q=m;m=D;try{return W()}finally{m=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,D){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var q=m;m=W;try{return D()}finally{m=q}},t.unstable_scheduleCallback=function(W,D,q){var G=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?G+q:G):q=G,W){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=q+I,W={id:h++,callback:D,priorityLevel:W,startTime:q,expirationTime:I,sortIndex:-1},q>G?(W.sortIndex=q,e(d,W),n(u)===null&&W===n(d)&&(w?(v(y),y=-1):w=!0,ee(R,q-G))):(W.sortIndex=I,e(u,W),E||_||(E=!0,B(L))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var D=m;return function(){var q=m;m=D;try{return W.apply(this,arguments)}finally{m=q}}}})(Ax);Rx.exports=Ax;var bb=Rx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kb=C,mn=bb;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dx=new Set,ho={};function Js(t,e){Fa(t,e),Fa(t+"Capture",e)}function Fa(t,e){for(ho[t]=e,t=0;t<e.length;t++)Dx.add(e[t])}var _r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xd=Object.prototype.hasOwnProperty,Tb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cg={},Pg={};function Eb(t){return Xd.call(Pg,t)?!0:Xd.call(Cg,t)?!1:Tb.test(t)?Pg[t]=!0:(Cg[t]=!0,!1)}function Ib(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Sb(t,e,n,r){if(e===null||typeof e>"u"||Ib(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xt(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rt[t]=new Xt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rt[e]=new Xt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rt[t]=new Xt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rt[t]=new Xt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rt[t]=new Xt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rt[t]=new Xt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rt[t]=new Xt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rt[t]=new Xt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rt[t]=new Xt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ep=/[\-:]([a-z])/g;function Ip(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ep,Ip);Rt[e]=new Xt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ep,Ip);Rt[e]=new Xt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ep,Ip);Rt[e]=new Xt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sp(t,e,n,r){var a=Rt.hasOwnProperty(e)?Rt[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Sb(e,n,a,r)&&(n=null),r||a===null?Eb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Cr=kb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bl=Symbol.for("react.element"),ma=Symbol.for("react.portal"),ga=Symbol.for("react.fragment"),Cp=Symbol.for("react.strict_mode"),eh=Symbol.for("react.profiler"),zx=Symbol.for("react.provider"),Lx=Symbol.for("react.context"),Pp=Symbol.for("react.forward_ref"),th=Symbol.for("react.suspense"),nh=Symbol.for("react.suspense_list"),Rp=Symbol.for("react.memo"),Or=Symbol.for("react.lazy"),Ox=Symbol.for("react.offscreen"),Rg=Symbol.iterator;function Ei(t){return t===null||typeof t!="object"?null:(t=Rg&&t[Rg]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,hd;function Ui(t){if(hd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hd=e&&e[1]||""}return`
`+hd+t}var pd=!1;function fd(t,e){if(!t||pd)return"";pd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var u=`
`+a[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{pd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ui(t):""}function Cb(t){switch(t.tag){case 5:return Ui(t.type);case 16:return Ui("Lazy");case 13:return Ui("Suspense");case 19:return Ui("SuspenseList");case 0:case 2:case 15:return t=fd(t.type,!1),t;case 11:return t=fd(t.type.render,!1),t;case 1:return t=fd(t.type,!0),t;default:return""}}function rh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ga:return"Fragment";case ma:return"Portal";case eh:return"Profiler";case Cp:return"StrictMode";case th:return"Suspense";case nh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Lx:return(t.displayName||"Context")+".Consumer";case zx:return(t._context.displayName||"Context")+".Provider";case Pp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rp:return e=t.displayName||null,e!==null?e:rh(t.type)||"Memo";case Or:e=t._payload,t=t._init;try{return rh(t(e))}catch{}}return null}function Pb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rh(e);case 8:return e===Cp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function os(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Vx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Rb(t){var e=Vx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function kl(t){t._valueTracker||(t._valueTracker=Rb(t))}function Mx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Vx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function mc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sh(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ag(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=os(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ux(t,e){e=e.checked,e!=null&&Sp(t,"checked",e,!1)}function ah(t,e){Ux(t,e);var n=os(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ih(t,e.type,n):e.hasOwnProperty("defaultValue")&&ih(t,e.type,os(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ih(t,e,n){(e!=="number"||mc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fi=Array.isArray;function Ea(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+os(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function oh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Fi(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:os(n)}}function Fx(t,e){var n=os(e.value),r=os(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Lg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Bx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Bx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tl,$x=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tl=Tl||document.createElement("div"),Tl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function po(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ab=["Webkit","ms","Moz","O"];Object.keys(Zi).forEach(function(t){Ab.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Zi[e]=Zi[t]})});function qx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Zi.hasOwnProperty(t)&&Zi[t]?(""+e).trim():e+"px"}function Wx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=qx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var Db=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ch(t,e){if(e){if(Db[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function uh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=null;function Ap(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hh=null,Ia=null,Sa=null;function Og(t){if(t=Wo(t)){if(typeof hh!="function")throw Error(re(280));var e=t.stateNode;e&&(e=uu(e),hh(t.stateNode,t.type,e))}}function Hx(t){Ia?Sa?Sa.push(t):Sa=[t]:Ia=t}function Kx(){if(Ia){var t=Ia,e=Sa;if(Sa=Ia=null,Og(t),e)for(t=0;t<e.length;t++)Og(e[t])}}function Gx(t,e){return t(e)}function Qx(){}var md=!1;function Zx(t,e,n){if(md)return t(e,n);md=!0;try{return Gx(t,e,n)}finally{md=!1,(Ia!==null||Sa!==null)&&(Qx(),Kx())}}function fo(t,e){var n=t.stateNode;if(n===null)return null;var r=uu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var ph=!1;if(_r)try{var Ii={};Object.defineProperty(Ii,"passive",{get:function(){ph=!0}}),window.addEventListener("test",Ii,Ii),window.removeEventListener("test",Ii,Ii)}catch{ph=!1}function zb(t,e,n,r,a,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ji=!1,gc=null,vc=!1,fh=null,Lb={onError:function(t){Ji=!0,gc=t}};function Ob(t,e,n,r,a,i,o,l,u){Ji=!1,gc=null,zb.apply(Lb,arguments)}function Vb(t,e,n,r,a,i,o,l,u){if(Ob.apply(this,arguments),Ji){if(Ji){var d=gc;Ji=!1,gc=null}else throw Error(re(198));vc||(vc=!0,fh=d)}}function Ys(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Jx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vg(t){if(Ys(t)!==t)throw Error(re(188))}function Mb(t){var e=t.alternate;if(!e){if(e=Ys(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Vg(a),t;if(i===r)return Vg(a),e;i=i.sibling}throw Error(re(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function Yx(t){return t=Mb(t),t!==null?Xx(t):null}function Xx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xx(t);if(e!==null)return e;t=t.sibling}return null}var ew=mn.unstable_scheduleCallback,Mg=mn.unstable_cancelCallback,Ub=mn.unstable_shouldYield,Fb=mn.unstable_requestPaint,ht=mn.unstable_now,Bb=mn.unstable_getCurrentPriorityLevel,Dp=mn.unstable_ImmediatePriority,tw=mn.unstable_UserBlockingPriority,yc=mn.unstable_NormalPriority,$b=mn.unstable_LowPriority,nw=mn.unstable_IdlePriority,iu=null,Qn=null;function qb(t){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(iu,t,void 0,(t.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:Kb,Wb=Math.log,Hb=Math.LN2;function Kb(t){return t>>>=0,t===0?32:31-(Wb(t)/Hb|0)|0}var El=64,Il=4194304;function Bi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~a;l!==0?r=Bi(l):(i&=o,i!==0&&(r=Bi(i)))}else o=n&~a,o!==0?r=Bi(o):i!==0&&(r=Bi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-zn(e),a=1<<n,r|=t[n],e&=~a;return r}function Gb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-zn(i),l=1<<o,u=a[o];u===-1?(!(l&n)||l&r)&&(a[o]=Gb(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function mh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function rw(){var t=El;return El<<=1,!(El&4194240)&&(El=64),t}function gd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $o(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-zn(e),t[e]=n}function Zb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-zn(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function zp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-zn(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var Be=0;function sw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var aw,Lp,iw,ow,lw,gh=!1,Sl=[],Qr=null,Zr=null,Jr=null,mo=new Map,go=new Map,Mr=[],Jb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ug(t,e){switch(t){case"focusin":case"focusout":Qr=null;break;case"dragenter":case"dragleave":Zr=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":mo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":go.delete(e.pointerId)}}function Si(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Wo(e),e!==null&&Lp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Yb(t,e,n,r,a){switch(e){case"focusin":return Qr=Si(Qr,t,e,n,r,a),!0;case"dragenter":return Zr=Si(Zr,t,e,n,r,a),!0;case"mouseover":return Jr=Si(Jr,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return mo.set(i,Si(mo.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,go.set(i,Si(go.get(i)||null,t,e,n,r,a)),!0}return!1}function cw(t){var e=Cs(t.target);if(e!==null){var n=Ys(e);if(n!==null){if(e=n.tag,e===13){if(e=Jx(n),e!==null){t.blockedOn=e,lw(t.priority,function(){iw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ql(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);dh=r,n.target.dispatchEvent(r),dh=null}else return e=Wo(n),e!==null&&Lp(e),t.blockedOn=n,!1;e.shift()}return!0}function Fg(t,e,n){Ql(t)&&n.delete(e)}function Xb(){gh=!1,Qr!==null&&Ql(Qr)&&(Qr=null),Zr!==null&&Ql(Zr)&&(Zr=null),Jr!==null&&Ql(Jr)&&(Jr=null),mo.forEach(Fg),go.forEach(Fg)}function Ci(t,e){t.blockedOn===e&&(t.blockedOn=null,gh||(gh=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,Xb)))}function vo(t){function e(a){return Ci(a,t)}if(0<Sl.length){Ci(Sl[0],t);for(var n=1;n<Sl.length;n++){var r=Sl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Qr!==null&&Ci(Qr,t),Zr!==null&&Ci(Zr,t),Jr!==null&&Ci(Jr,t),mo.forEach(e),go.forEach(e),n=0;n<Mr.length;n++)r=Mr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Mr.length&&(n=Mr[0],n.blockedOn===null);)cw(n),n.blockedOn===null&&Mr.shift()}var Ca=Cr.ReactCurrentBatchConfig,wc=!0;function ek(t,e,n,r){var a=Be,i=Ca.transition;Ca.transition=null;try{Be=1,Op(t,e,n,r)}finally{Be=a,Ca.transition=i}}function tk(t,e,n,r){var a=Be,i=Ca.transition;Ca.transition=null;try{Be=4,Op(t,e,n,r)}finally{Be=a,Ca.transition=i}}function Op(t,e,n,r){if(wc){var a=vh(t,e,n,r);if(a===null)Td(t,e,r,jc,n),Ug(t,r);else if(Yb(a,t,e,n,r))r.stopPropagation();else if(Ug(t,r),e&4&&-1<Jb.indexOf(t)){for(;a!==null;){var i=Wo(a);if(i!==null&&aw(i),i=vh(t,e,n,r),i===null&&Td(t,e,r,jc,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Td(t,e,r,null,n)}}var jc=null;function vh(t,e,n,r){if(jc=null,t=Ap(r),t=Cs(t),t!==null)if(e=Ys(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Jx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jc=t,null}function uw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bb()){case Dp:return 1;case tw:return 4;case yc:case $b:return 16;case nw:return 536870912;default:return 16}default:return 16}}var Wr=null,Vp=null,Zl=null;function dw(){if(Zl)return Zl;var t,e=Vp,n=e.length,r,a="value"in Wr?Wr.value:Wr.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return Zl=a.slice(t,1<r?1-r:void 0)}function Jl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Cl(){return!0}function Bg(){return!1}function vn(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cl:Bg,this.isPropagationStopped=Bg,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Cl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Cl)},persist:function(){},isPersistent:Cl}),e}var si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mp=vn(si),qo=st({},si,{view:0,detail:0}),nk=vn(qo),vd,yd,Pi,ou=st({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Up,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pi&&(Pi&&t.type==="mousemove"?(vd=t.screenX-Pi.screenX,yd=t.screenY-Pi.screenY):yd=vd=0,Pi=t),vd)},movementY:function(t){return"movementY"in t?t.movementY:yd}}),$g=vn(ou),rk=st({},ou,{dataTransfer:0}),sk=vn(rk),ak=st({},qo,{relatedTarget:0}),xd=vn(ak),ik=st({},si,{animationName:0,elapsedTime:0,pseudoElement:0}),ok=vn(ik),lk=st({},si,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ck=vn(lk),uk=st({},si,{data:0}),qg=vn(uk),dk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pk[t])?!!e[t]:!1}function Up(){return fk}var mk=st({},qo,{key:function(t){if(t.key){var e=dk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Jl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Up,charCode:function(t){return t.type==="keypress"?Jl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gk=vn(mk),vk=st({},ou,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wg=vn(vk),yk=st({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Up}),xk=vn(yk),wk=st({},si,{propertyName:0,elapsedTime:0,pseudoElement:0}),jk=vn(wk),_k=st({},ou,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nk=vn(_k),bk=[9,13,27,32],Fp=_r&&"CompositionEvent"in window,Yi=null;_r&&"documentMode"in document&&(Yi=document.documentMode);var kk=_r&&"TextEvent"in window&&!Yi,hw=_r&&(!Fp||Yi&&8<Yi&&11>=Yi),Hg=" ",Kg=!1;function pw(t,e){switch(t){case"keyup":return bk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var va=!1;function Tk(t,e){switch(t){case"compositionend":return fw(e);case"keypress":return e.which!==32?null:(Kg=!0,Hg);case"textInput":return t=e.data,t===Hg&&Kg?null:t;default:return null}}function Ek(t,e){if(va)return t==="compositionend"||!Fp&&pw(t,e)?(t=dw(),Zl=Vp=Wr=null,va=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hw&&e.locale!=="ko"?null:e.data;default:return null}}var Ik={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ik[t.type]:e==="textarea"}function mw(t,e,n,r){Hx(r),e=_c(e,"onChange"),0<e.length&&(n=new Mp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xi=null,yo=null;function Sk(t){Tw(t,0)}function lu(t){var e=wa(t);if(Mx(e))return t}function Ck(t,e){if(t==="change")return e}var gw=!1;if(_r){var wd;if(_r){var jd="oninput"in document;if(!jd){var Qg=document.createElement("div");Qg.setAttribute("oninput","return;"),jd=typeof Qg.oninput=="function"}wd=jd}else wd=!1;gw=wd&&(!document.documentMode||9<document.documentMode)}function Zg(){Xi&&(Xi.detachEvent("onpropertychange",vw),yo=Xi=null)}function vw(t){if(t.propertyName==="value"&&lu(yo)){var e=[];mw(e,yo,t,Ap(t)),Zx(Sk,e)}}function Pk(t,e,n){t==="focusin"?(Zg(),Xi=e,yo=n,Xi.attachEvent("onpropertychange",vw)):t==="focusout"&&Zg()}function Rk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lu(yo)}function Ak(t,e){if(t==="click")return lu(e)}function Dk(t,e){if(t==="input"||t==="change")return lu(e)}function zk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mn=typeof Object.is=="function"?Object.is:zk;function xo(t,e){if(Mn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Xd.call(e,a)||!Mn(t[a],e[a]))return!1}return!0}function Jg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yg(t,e){var n=Jg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jg(n)}}function yw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?yw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function xw(){for(var t=window,e=mc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=mc(t.document)}return e}function Bp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Lk(t){var e=xw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&yw(n.ownerDocument.documentElement,n)){if(r!==null&&Bp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=Yg(n,i);var o=Yg(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ok=_r&&"documentMode"in document&&11>=document.documentMode,ya=null,yh=null,eo=null,xh=!1;function Xg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xh||ya==null||ya!==mc(r)||(r=ya,"selectionStart"in r&&Bp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),eo&&xo(eo,r)||(eo=r,r=_c(yh,"onSelect"),0<r.length&&(e=new Mp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ya)))}function Pl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xa={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},_d={},ww={};_r&&(ww=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function cu(t){if(_d[t])return _d[t];if(!xa[t])return t;var e=xa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ww)return _d[t]=e[n];return t}var jw=cu("animationend"),_w=cu("animationiteration"),Nw=cu("animationstart"),bw=cu("transitionend"),kw=new Map,ev="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){kw.set(t,e),Js(e,[t])}for(var Nd=0;Nd<ev.length;Nd++){var bd=ev[Nd],Vk=bd.toLowerCase(),Mk=bd[0].toUpperCase()+bd.slice(1);fs(Vk,"on"+Mk)}fs(jw,"onAnimationEnd");fs(_w,"onAnimationIteration");fs(Nw,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(bw,"onTransitionEnd");Fa("onMouseEnter",["mouseout","mouseover"]);Fa("onMouseLeave",["mouseout","mouseover"]);Fa("onPointerEnter",["pointerout","pointerover"]);Fa("onPointerLeave",["pointerout","pointerover"]);Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Js("onBeforeInput",["compositionend","keypress","textInput","paste"]);Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $i="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uk=new Set("cancel close invalid load scroll toggle".split(" ").concat($i));function tv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Vb(r,e,void 0,t),t.currentTarget=null}function Tw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&a.isPropagationStopped())break e;tv(a,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&a.isPropagationStopped())break e;tv(a,l,d),i=u}}}if(vc)throw t=fh,vc=!1,fh=null,t}function Qe(t,e){var n=e[bh];n===void 0&&(n=e[bh]=new Set);var r=t+"__bubble";n.has(r)||(Ew(e,t,2,!1),n.add(r))}function kd(t,e,n){var r=0;e&&(r|=4),Ew(n,t,r,e)}var Rl="_reactListening"+Math.random().toString(36).slice(2);function wo(t){if(!t[Rl]){t[Rl]=!0,Dx.forEach(function(n){n!=="selectionchange"&&(Uk.has(n)||kd(n,!1,t),kd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Rl]||(e[Rl]=!0,kd("selectionchange",!1,e))}}function Ew(t,e,n,r){switch(uw(e)){case 1:var a=ek;break;case 4:a=tk;break;default:a=Op}n=a.bind(null,e,n,t),a=void 0,!ph||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Td(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Cs(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Zx(function(){var d=i,h=Ap(n),f=[];e:{var m=kw.get(t);if(m!==void 0){var _=Mp,E=t;switch(t){case"keypress":if(Jl(n)===0)break e;case"keydown":case"keyup":_=gk;break;case"focusin":E="focus",_=xd;break;case"focusout":E="blur",_=xd;break;case"beforeblur":case"afterblur":_=xd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=$g;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=sk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=xk;break;case jw:case _w:case Nw:_=ok;break;case bw:_=jk;break;case"scroll":_=nk;break;case"wheel":_=Nk;break;case"copy":case"cut":case"paste":_=ck;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Wg}var w=(e&4)!==0,x=!w&&t==="scroll",v=w?m!==null?m+"Capture":null:m;w=[];for(var j=d,S;j!==null;){S=j;var R=S.stateNode;if(S.tag===5&&R!==null&&(S=R,v!==null&&(R=fo(j,v),R!=null&&w.push(jo(j,R,S)))),x)break;j=j.return}0<w.length&&(m=new _(m,E,null,n,h),f.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==dh&&(E=n.relatedTarget||n.fromElement)&&(Cs(E)||E[Nr]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(E=n.relatedTarget||n.toElement,_=d,E=E?Cs(E):null,E!==null&&(x=Ys(E),E!==x||E.tag!==5&&E.tag!==6)&&(E=null)):(_=null,E=d),_!==E)){if(w=$g,R="onMouseLeave",v="onMouseEnter",j="mouse",(t==="pointerout"||t==="pointerover")&&(w=Wg,R="onPointerLeave",v="onPointerEnter",j="pointer"),x=_==null?m:wa(_),S=E==null?m:wa(E),m=new w(R,j+"leave",_,n,h),m.target=x,m.relatedTarget=S,R=null,Cs(h)===d&&(w=new w(v,j+"enter",E,n,h),w.target=S,w.relatedTarget=x,R=w),x=R,_&&E)t:{for(w=_,v=E,j=0,S=w;S;S=la(S))j++;for(S=0,R=v;R;R=la(R))S++;for(;0<j-S;)w=la(w),j--;for(;0<S-j;)v=la(v),S--;for(;j--;){if(w===v||v!==null&&w===v.alternate)break t;w=la(w),v=la(v)}w=null}else w=null;_!==null&&nv(f,m,_,w,!1),E!==null&&x!==null&&nv(f,x,E,w,!0)}}e:{if(m=d?wa(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var L=Ck;else if(Gg(m))if(gw)L=Dk;else{L=Rk;var U=Pk}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=Ak);if(L&&(L=L(t,d))){mw(f,L,n,h);break e}U&&U(t,m,d),t==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&ih(m,"number",m.value)}switch(U=d?wa(d):window,t){case"focusin":(Gg(U)||U.contentEditable==="true")&&(ya=U,yh=d,eo=null);break;case"focusout":eo=yh=ya=null;break;case"mousedown":xh=!0;break;case"contextmenu":case"mouseup":case"dragend":xh=!1,Xg(f,n,h);break;case"selectionchange":if(Ok)break;case"keydown":case"keyup":Xg(f,n,h)}var N;if(Fp)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else va?pw(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(hw&&n.locale!=="ko"&&(va||y!=="onCompositionStart"?y==="onCompositionEnd"&&va&&(N=dw()):(Wr=h,Vp="value"in Wr?Wr.value:Wr.textContent,va=!0)),U=_c(d,y),0<U.length&&(y=new qg(y,t,null,n,h),f.push({event:y,listeners:U}),N?y.data=N:(N=fw(n),N!==null&&(y.data=N)))),(N=kk?Tk(t,n):Ek(t,n))&&(d=_c(d,"onBeforeInput"),0<d.length&&(h=new qg("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=N))}Tw(f,e)})}function jo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _c(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=fo(t,n),i!=null&&r.unshift(jo(t,i,a)),i=fo(t,e),i!=null&&r.push(jo(t,i,a))),t=t.return}return r}function la(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nv(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,a?(u=fo(n,i),u!=null&&o.unshift(jo(n,u,l))):a||(u=fo(n,i),u!=null&&o.push(jo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Fk=/\r\n?/g,Bk=/\u0000|\uFFFD/g;function rv(t){return(typeof t=="string"?t:""+t).replace(Fk,`
`).replace(Bk,"")}function Al(t,e,n){if(e=rv(e),rv(t)!==e&&n)throw Error(re(425))}function Nc(){}var wh=null,jh=null;function _h(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nh=typeof setTimeout=="function"?setTimeout:void 0,$k=typeof clearTimeout=="function"?clearTimeout:void 0,sv=typeof Promise=="function"?Promise:void 0,qk=typeof queueMicrotask=="function"?queueMicrotask:typeof sv<"u"?function(t){return sv.resolve(null).then(t).catch(Wk)}:Nh;function Wk(t){setTimeout(function(){throw t})}function Ed(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),vo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);vo(e)}function Yr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function av(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ai=Math.random().toString(36).slice(2),Kn="__reactFiber$"+ai,_o="__reactProps$"+ai,Nr="__reactContainer$"+ai,bh="__reactEvents$"+ai,Hk="__reactListeners$"+ai,Kk="__reactHandles$"+ai;function Cs(t){var e=t[Kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Nr]||n[Kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=av(t);t!==null;){if(n=t[Kn])return n;t=av(t)}return e}t=n,n=t.parentNode}return null}function Wo(t){return t=t[Kn]||t[Nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function uu(t){return t[_o]||null}var kh=[],ja=-1;function ms(t){return{current:t}}function Ye(t){0>ja||(t.current=kh[ja],kh[ja]=null,ja--)}function Ke(t,e){ja++,kh[ja]=t.current,t.current=e}var ls={},qt=ms(ls),rn=ms(!1),Ms=ls;function Ba(t,e){var n=t.type.contextTypes;if(!n)return ls;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function sn(t){return t=t.childContextTypes,t!=null}function bc(){Ye(rn),Ye(qt)}function iv(t,e,n){if(qt.current!==ls)throw Error(re(168));Ke(qt,e),Ke(rn,n)}function Iw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(re(108,Pb(t)||"Unknown",a));return st({},n,r)}function kc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ls,Ms=qt.current,Ke(qt,t),Ke(rn,rn.current),!0}function ov(t,e,n){var r=t.stateNode;if(!r)throw Error(re(169));n?(t=Iw(t,e,Ms),r.__reactInternalMemoizedMergedChildContext=t,Ye(rn),Ye(qt),Ke(qt,t)):Ye(rn),Ke(rn,n)}var hr=null,du=!1,Id=!1;function Sw(t){hr===null?hr=[t]:hr.push(t)}function Gk(t){du=!0,Sw(t)}function gs(){if(!Id&&hr!==null){Id=!0;var t=0,e=Be;try{var n=hr;for(Be=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hr=null,du=!1}catch(a){throw hr!==null&&(hr=hr.slice(t+1)),ew(Dp,gs),a}finally{Be=e,Id=!1}}return null}var _a=[],Na=0,Tc=null,Ec=0,yn=[],xn=0,Us=null,fr=1,mr="";function Es(t,e){_a[Na++]=Ec,_a[Na++]=Tc,Tc=t,Ec=e}function Cw(t,e,n){yn[xn++]=fr,yn[xn++]=mr,yn[xn++]=Us,Us=t;var r=fr;t=mr;var a=32-zn(r)-1;r&=~(1<<a),n+=1;var i=32-zn(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,fr=1<<32-zn(e)+a|n<<a|r,mr=i+t}else fr=1<<i|n<<a|r,mr=t}function $p(t){t.return!==null&&(Es(t,1),Cw(t,1,0))}function qp(t){for(;t===Tc;)Tc=_a[--Na],_a[Na]=null,Ec=_a[--Na],_a[Na]=null;for(;t===Us;)Us=yn[--xn],yn[xn]=null,mr=yn[--xn],yn[xn]=null,fr=yn[--xn],yn[xn]=null}var fn=null,un=null,et=!1,An=null;function Pw(t,e){var n=wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fn=t,un=Yr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fn=t,un=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Us!==null?{id:fr,overflow:mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fn=t,un=null,!0):!1;default:return!1}}function Th(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Eh(t){if(et){var e=un;if(e){var n=e;if(!lv(t,e)){if(Th(t))throw Error(re(418));e=Yr(n.nextSibling);var r=fn;e&&lv(t,e)?Pw(r,n):(t.flags=t.flags&-4097|2,et=!1,fn=t)}}else{if(Th(t))throw Error(re(418));t.flags=t.flags&-4097|2,et=!1,fn=t}}}function cv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fn=t}function Dl(t){if(t!==fn)return!1;if(!et)return cv(t),et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_h(t.type,t.memoizedProps)),e&&(e=un)){if(Th(t))throw Rw(),Error(re(418));for(;e;)Pw(t,e),e=Yr(e.nextSibling)}if(cv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){un=Yr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}un=null}}else un=fn?Yr(t.stateNode.nextSibling):null;return!0}function Rw(){for(var t=un;t;)t=Yr(t.nextSibling)}function $a(){un=fn=null,et=!1}function Wp(t){An===null?An=[t]:An.push(t)}var Qk=Cr.ReactCurrentBatchConfig;function Ri(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function zl(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uv(t){var e=t._init;return e(t._payload)}function Aw(t){function e(v,j){if(t){var S=v.deletions;S===null?(v.deletions=[j],v.flags|=16):S.push(j)}}function n(v,j){if(!t)return null;for(;j!==null;)e(v,j),j=j.sibling;return null}function r(v,j){for(v=new Map;j!==null;)j.key!==null?v.set(j.key,j):v.set(j.index,j),j=j.sibling;return v}function a(v,j){return v=ns(v,j),v.index=0,v.sibling=null,v}function i(v,j,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<j?(v.flags|=2,j):S):(v.flags|=2,j)):(v.flags|=1048576,j)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,j,S,R){return j===null||j.tag!==6?(j=zd(S,v.mode,R),j.return=v,j):(j=a(j,S),j.return=v,j)}function u(v,j,S,R){var L=S.type;return L===ga?h(v,j,S.props.children,R,S.key):j!==null&&(j.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Or&&uv(L)===j.type)?(R=a(j,S.props),R.ref=Ri(v,j,S),R.return=v,R):(R=sc(S.type,S.key,S.props,null,v.mode,R),R.ref=Ri(v,j,S),R.return=v,R)}function d(v,j,S,R){return j===null||j.tag!==4||j.stateNode.containerInfo!==S.containerInfo||j.stateNode.implementation!==S.implementation?(j=Ld(S,v.mode,R),j.return=v,j):(j=a(j,S.children||[]),j.return=v,j)}function h(v,j,S,R,L){return j===null||j.tag!==7?(j=Ls(S,v.mode,R,L),j.return=v,j):(j=a(j,S),j.return=v,j)}function f(v,j,S){if(typeof j=="string"&&j!==""||typeof j=="number")return j=zd(""+j,v.mode,S),j.return=v,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case bl:return S=sc(j.type,j.key,j.props,null,v.mode,S),S.ref=Ri(v,null,j),S.return=v,S;case ma:return j=Ld(j,v.mode,S),j.return=v,j;case Or:var R=j._init;return f(v,R(j._payload),S)}if(Fi(j)||Ei(j))return j=Ls(j,v.mode,S,null),j.return=v,j;zl(v,j)}return null}function m(v,j,S,R){var L=j!==null?j.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return L!==null?null:l(v,j,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case bl:return S.key===L?u(v,j,S,R):null;case ma:return S.key===L?d(v,j,S,R):null;case Or:return L=S._init,m(v,j,L(S._payload),R)}if(Fi(S)||Ei(S))return L!==null?null:h(v,j,S,R,null);zl(v,S)}return null}function _(v,j,S,R,L){if(typeof R=="string"&&R!==""||typeof R=="number")return v=v.get(S)||null,l(j,v,""+R,L);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case bl:return v=v.get(R.key===null?S:R.key)||null,u(j,v,R,L);case ma:return v=v.get(R.key===null?S:R.key)||null,d(j,v,R,L);case Or:var U=R._init;return _(v,j,S,U(R._payload),L)}if(Fi(R)||Ei(R))return v=v.get(S)||null,h(j,v,R,L,null);zl(j,R)}return null}function E(v,j,S,R){for(var L=null,U=null,N=j,y=j=0,k=null;N!==null&&y<S.length;y++){N.index>y?(k=N,N=null):k=N.sibling;var b=m(v,N,S[y],R);if(b===null){N===null&&(N=k);break}t&&N&&b.alternate===null&&e(v,N),j=i(b,j,y),U===null?L=b:U.sibling=b,U=b,N=k}if(y===S.length)return n(v,N),et&&Es(v,y),L;if(N===null){for(;y<S.length;y++)N=f(v,S[y],R),N!==null&&(j=i(N,j,y),U===null?L=N:U.sibling=N,U=N);return et&&Es(v,y),L}for(N=r(v,N);y<S.length;y++)k=_(N,v,y,S[y],R),k!==null&&(t&&k.alternate!==null&&N.delete(k.key===null?y:k.key),j=i(k,j,y),U===null?L=k:U.sibling=k,U=k);return t&&N.forEach(function(A){return e(v,A)}),et&&Es(v,y),L}function w(v,j,S,R){var L=Ei(S);if(typeof L!="function")throw Error(re(150));if(S=L.call(S),S==null)throw Error(re(151));for(var U=L=null,N=j,y=j=0,k=null,b=S.next();N!==null&&!b.done;y++,b=S.next()){N.index>y?(k=N,N=null):k=N.sibling;var A=m(v,N,b.value,R);if(A===null){N===null&&(N=k);break}t&&N&&A.alternate===null&&e(v,N),j=i(A,j,y),U===null?L=A:U.sibling=A,U=A,N=k}if(b.done)return n(v,N),et&&Es(v,y),L;if(N===null){for(;!b.done;y++,b=S.next())b=f(v,b.value,R),b!==null&&(j=i(b,j,y),U===null?L=b:U.sibling=b,U=b);return et&&Es(v,y),L}for(N=r(v,N);!b.done;y++,b=S.next())b=_(N,v,y,b.value,R),b!==null&&(t&&b.alternate!==null&&N.delete(b.key===null?y:b.key),j=i(b,j,y),U===null?L=b:U.sibling=b,U=b);return t&&N.forEach(function(z){return e(v,z)}),et&&Es(v,y),L}function x(v,j,S,R){if(typeof S=="object"&&S!==null&&S.type===ga&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case bl:e:{for(var L=S.key,U=j;U!==null;){if(U.key===L){if(L=S.type,L===ga){if(U.tag===7){n(v,U.sibling),j=a(U,S.props.children),j.return=v,v=j;break e}}else if(U.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Or&&uv(L)===U.type){n(v,U.sibling),j=a(U,S.props),j.ref=Ri(v,U,S),j.return=v,v=j;break e}n(v,U);break}else e(v,U);U=U.sibling}S.type===ga?(j=Ls(S.props.children,v.mode,R,S.key),j.return=v,v=j):(R=sc(S.type,S.key,S.props,null,v.mode,R),R.ref=Ri(v,j,S),R.return=v,v=R)}return o(v);case ma:e:{for(U=S.key;j!==null;){if(j.key===U)if(j.tag===4&&j.stateNode.containerInfo===S.containerInfo&&j.stateNode.implementation===S.implementation){n(v,j.sibling),j=a(j,S.children||[]),j.return=v,v=j;break e}else{n(v,j);break}else e(v,j);j=j.sibling}j=Ld(S,v.mode,R),j.return=v,v=j}return o(v);case Or:return U=S._init,x(v,j,U(S._payload),R)}if(Fi(S))return E(v,j,S,R);if(Ei(S))return w(v,j,S,R);zl(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,j!==null&&j.tag===6?(n(v,j.sibling),j=a(j,S),j.return=v,v=j):(n(v,j),j=zd(S,v.mode,R),j.return=v,v=j),o(v)):n(v,j)}return x}var qa=Aw(!0),Dw=Aw(!1),Ic=ms(null),Sc=null,ba=null,Hp=null;function Kp(){Hp=ba=Sc=null}function Gp(t){var e=Ic.current;Ye(Ic),t._currentValue=e}function Ih(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Pa(t,e){Sc=t,Hp=ba=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nn=!0),t.firstContext=null)}function bn(t){var e=t._currentValue;if(Hp!==t)if(t={context:t,memoizedValue:e,next:null},ba===null){if(Sc===null)throw Error(re(308));ba=t,Sc.dependencies={lanes:0,firstContext:t}}else ba=ba.next=t;return e}var Ps=null;function Qp(t){Ps===null?Ps=[t]:Ps.push(t)}function zw(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,Qp(e)):(n.next=a.next,a.next=n),e.interleaved=n,br(t,r)}function br(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vr=!1;function Zp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,br(t,n)}return a=r.interleaved,a===null?(e.next=e,Qp(r)):(e.next=a.next,a.next=e),r.interleaved=e,br(t,n)}function Yl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zp(t,n)}}function dv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Cc(t,e,n,r){var a=t.updateQueue;Vr=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var f=a.baseState;o=0,h=d=u=null,l=i;do{var m=l.lane,_=l.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=t,w=l;switch(m=e,_=n,w.tag){case 1:if(E=w.payload,typeof E=="function"){f=E.call(_,f,m);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=w.payload,m=typeof E=="function"?E.call(_,f,m):E,m==null)break e;f=st({},f,m);break e;case 2:Vr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else _={eventTime:_,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=_,u=f):h=h.next=_,o|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(h===null&&(u=f),a.baseState=u,a.firstBaseUpdate=d,a.lastBaseUpdate=h,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Bs|=o,t.lanes=o,t.memoizedState=f}}function hv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(re(191,a));a.call(r)}}}var Ho={},Zn=ms(Ho),No=ms(Ho),bo=ms(Ho);function Rs(t){if(t===Ho)throw Error(re(174));return t}function Jp(t,e){switch(Ke(bo,e),Ke(No,t),Ke(Zn,Ho),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lh(e,t)}Ye(Zn),Ke(Zn,e)}function Wa(){Ye(Zn),Ye(No),Ye(bo)}function Ow(t){Rs(bo.current);var e=Rs(Zn.current),n=lh(e,t.type);e!==n&&(Ke(No,t),Ke(Zn,n))}function Yp(t){No.current===t&&(Ye(Zn),Ye(No))}var nt=ms(0);function Pc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sd=[];function Xp(){for(var t=0;t<Sd.length;t++)Sd[t]._workInProgressVersionPrimary=null;Sd.length=0}var Xl=Cr.ReactCurrentDispatcher,Cd=Cr.ReactCurrentBatchConfig,Fs=0,rt=null,xt=null,bt=null,Rc=!1,to=!1,ko=0,Zk=0;function Lt(){throw Error(re(321))}function ef(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mn(t[n],e[n]))return!1;return!0}function tf(t,e,n,r,a,i){if(Fs=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Xl.current=t===null||t.memoizedState===null?eT:tT,t=n(r,a),to){i=0;do{if(to=!1,ko=0,25<=i)throw Error(re(301));i+=1,bt=xt=null,e.updateQueue=null,Xl.current=nT,t=n(r,a)}while(to)}if(Xl.current=Ac,e=xt!==null&&xt.next!==null,Fs=0,bt=xt=rt=null,Rc=!1,e)throw Error(re(300));return t}function nf(){var t=ko!==0;return ko=0,t}function Wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?rt.memoizedState=bt=t:bt=bt.next=t,bt}function kn(){if(xt===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=xt.next;var e=bt===null?rt.memoizedState:bt.next;if(e!==null)bt=e,xt=t;else{if(t===null)throw Error(re(310));xt=t,t={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},bt===null?rt.memoizedState=bt=t:bt=bt.next=t}return bt}function To(t,e){return typeof e=="function"?e(t):e}function Pd(t){var e=kn(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=xt,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((Fs&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=f,o=r):u=u.next=f,rt.lanes|=h,Bs|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Mn(r,e.memoizedState)||(nn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,rt.lanes|=i,Bs|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Rd(t){var e=kn(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Mn(i,e.memoizedState)||(nn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Vw(){}function Mw(t,e){var n=rt,r=kn(),a=e(),i=!Mn(r.memoizedState,a);if(i&&(r.memoizedState=a,nn=!0),r=r.queue,rf(Bw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Eo(9,Fw.bind(null,n,r,a,e),void 0,null),kt===null)throw Error(re(349));Fs&30||Uw(n,e,a)}return a}function Uw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Fw(t,e,n,r){e.value=n,e.getSnapshot=r,$w(e)&&qw(t)}function Bw(t,e,n){return n(function(){$w(e)&&qw(t)})}function $w(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mn(t,n)}catch{return!0}}function qw(t){var e=br(t,1);e!==null&&Ln(e,t,1,-1)}function pv(t){var e=Wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:t},e.queue=t,t=t.dispatch=Xk.bind(null,rt,t),[e.memoizedState,t]}function Eo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ww(){return kn().memoizedState}function ec(t,e,n,r){var a=Wn();rt.flags|=t,a.memoizedState=Eo(1|e,n,void 0,r===void 0?null:r)}function hu(t,e,n,r){var a=kn();r=r===void 0?null:r;var i=void 0;if(xt!==null){var o=xt.memoizedState;if(i=o.destroy,r!==null&&ef(r,o.deps)){a.memoizedState=Eo(e,n,i,r);return}}rt.flags|=t,a.memoizedState=Eo(1|e,n,i,r)}function fv(t,e){return ec(8390656,8,t,e)}function rf(t,e){return hu(2048,8,t,e)}function Hw(t,e){return hu(4,2,t,e)}function Kw(t,e){return hu(4,4,t,e)}function Gw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Qw(t,e,n){return n=n!=null?n.concat([t]):null,hu(4,4,Gw.bind(null,e,t),n)}function sf(){}function Zw(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ef(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jw(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ef(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Yw(t,e,n){return Fs&21?(Mn(n,e)||(n=rw(),rt.lanes|=n,Bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nn=!0),t.memoizedState=n)}function Jk(t,e){var n=Be;Be=n!==0&&4>n?n:4,t(!0);var r=Cd.transition;Cd.transition={};try{t(!1),e()}finally{Be=n,Cd.transition=r}}function Xw(){return kn().memoizedState}function Yk(t,e,n){var r=ts(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ej(t))tj(e,n);else if(n=zw(t,e,n,r),n!==null){var a=Qt();Ln(n,t,r,a),nj(n,e,r)}}function Xk(t,e,n){var r=ts(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ej(t))tj(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(a.hasEagerState=!0,a.eagerState=l,Mn(l,o)){var u=e.interleaved;u===null?(a.next=a,Qp(e)):(a.next=u.next,u.next=a),e.interleaved=a;return}}catch{}finally{}n=zw(t,e,a,r),n!==null&&(a=Qt(),Ln(n,t,r,a),nj(n,e,r))}}function ej(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function tj(t,e){to=Rc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function nj(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zp(t,n)}}var Ac={readContext:bn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},eT={readContext:bn,useCallback:function(t,e){return Wn().memoizedState=[t,e===void 0?null:e],t},useContext:bn,useEffect:fv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ec(4194308,4,Gw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ec(4194308,4,t,e)},useInsertionEffect:function(t,e){return ec(4,2,t,e)},useMemo:function(t,e){var n=Wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Yk.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=Wn();return t={current:t},e.memoizedState=t},useState:pv,useDebugValue:sf,useDeferredValue:function(t){return Wn().memoizedState=t},useTransition:function(){var t=pv(!1),e=t[0];return t=Jk.bind(null,t[1]),Wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,a=Wn();if(et){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),kt===null)throw Error(re(349));Fs&30||Uw(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,fv(Bw.bind(null,r,i,t),[t]),r.flags|=2048,Eo(9,Fw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wn(),e=kt.identifierPrefix;if(et){var n=mr,r=fr;n=(r&~(1<<32-zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ko++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Zk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tT={readContext:bn,useCallback:Zw,useContext:bn,useEffect:rf,useImperativeHandle:Qw,useInsertionEffect:Hw,useLayoutEffect:Kw,useMemo:Jw,useReducer:Pd,useRef:Ww,useState:function(){return Pd(To)},useDebugValue:sf,useDeferredValue:function(t){var e=kn();return Yw(e,xt.memoizedState,t)},useTransition:function(){var t=Pd(To)[0],e=kn().memoizedState;return[t,e]},useMutableSource:Vw,useSyncExternalStore:Mw,useId:Xw,unstable_isNewReconciler:!1},nT={readContext:bn,useCallback:Zw,useContext:bn,useEffect:rf,useImperativeHandle:Qw,useInsertionEffect:Hw,useLayoutEffect:Kw,useMemo:Jw,useReducer:Rd,useRef:Ww,useState:function(){return Rd(To)},useDebugValue:sf,useDeferredValue:function(t){var e=kn();return xt===null?e.memoizedState=t:Yw(e,xt.memoizedState,t)},useTransition:function(){var t=Rd(To)[0],e=kn().memoizedState;return[t,e]},useMutableSource:Vw,useSyncExternalStore:Mw,useId:Xw,unstable_isNewReconciler:!1};function Pn(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Sh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var pu={isMounted:function(t){return(t=t._reactInternals)?Ys(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qt(),a=ts(t),i=xr(r,a);i.payload=e,n!=null&&(i.callback=n),e=Xr(t,i,a),e!==null&&(Ln(e,t,a,r),Yl(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qt(),a=ts(t),i=xr(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Xr(t,i,a),e!==null&&(Ln(e,t,a,r),Yl(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qt(),r=ts(t),a=xr(n,r);a.tag=2,e!=null&&(a.callback=e),e=Xr(t,a,r),e!==null&&(Ln(e,t,r,n),Yl(e,t,r))}};function mv(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!xo(n,r)||!xo(a,i):!0}function rj(t,e,n){var r=!1,a=ls,i=e.contextType;return typeof i=="object"&&i!==null?i=bn(i):(a=sn(e)?Ms:qt.current,r=e.contextTypes,i=(r=r!=null)?Ba(t,a):ls),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function gv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&pu.enqueueReplaceState(e,e.state,null)}function Ch(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Zp(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=bn(i):(i=sn(e)?Ms:qt.current,a.context=Ba(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Sh(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&pu.enqueueReplaceState(a,a.state,null),Cc(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Ha(t,e){try{var n="",r=e;do n+=Cb(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function Ad(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ph(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var rT=typeof WeakMap=="function"?WeakMap:Map;function sj(t,e,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zc||(zc=!0,Fh=r),Ph(t,e)},n}function aj(t,e,n){n=xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){Ph(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ph(t,e),typeof r!="function"&&(es===null?es=new Set([this]):es.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function vv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new rT;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=vT.bind(null,t,e,n),e.then(t,t))}function yv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function xv(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xr(-1,1),e.tag=2,Xr(n,e,1))),n.lanes|=1),t)}var sT=Cr.ReactCurrentOwner,nn=!1;function Gt(t,e,n,r){e.child=t===null?Dw(e,null,n,r):qa(e,t.child,n,r)}function wv(t,e,n,r,a){n=n.render;var i=e.ref;return Pa(e,a),r=tf(t,e,n,r,i,a),n=nf(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,kr(t,e,a)):(et&&n&&$p(e),e.flags|=1,Gt(t,e,r,a),e.child)}function jv(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!pf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ij(t,e,i,r,a)):(t=sc(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:xo,n(o,r)&&t.ref===e.ref)return kr(t,e,a)}return e.flags|=1,t=ns(i,r),t.ref=e.ref,t.return=e,e.child=t}function ij(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(xo(i,r)&&t.ref===e.ref)if(nn=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(nn=!0);else return e.lanes=t.lanes,kr(t,e,a)}return Rh(t,e,n,r,a)}function oj(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(Ta,cn),cn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ke(Ta,cn),cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ke(Ta,cn),cn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ke(Ta,cn),cn|=r;return Gt(t,e,a,n),e.child}function lj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Rh(t,e,n,r,a){var i=sn(n)?Ms:qt.current;return i=Ba(e,i),Pa(e,a),n=tf(t,e,n,r,i,a),r=nf(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,kr(t,e,a)):(et&&r&&$p(e),e.flags|=1,Gt(t,e,n,a),e.child)}function _v(t,e,n,r,a){if(sn(n)){var i=!0;kc(e)}else i=!1;if(Pa(e,a),e.stateNode===null)tc(t,e),rj(e,n,r),Ch(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=sn(n)?Ms:qt.current,d=Ba(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&gv(e,o,r,d),Vr=!1;var m=e.memoizedState;o.state=m,Cc(e,r,o,a),u=e.memoizedState,l!==r||m!==u||rn.current||Vr?(typeof h=="function"&&(Sh(e,n,h,r),u=e.memoizedState),(l=Vr||mv(e,n,l,r,m,u,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Lw(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Pn(e.type,l),o.props=d,f=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=bn(u):(u=sn(n)?Ms:qt.current,u=Ba(e,u));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==u)&&gv(e,o,r,u),Vr=!1,m=e.memoizedState,o.state=m,Cc(e,r,o,a);var E=e.memoizedState;l!==f||m!==E||rn.current||Vr?(typeof _=="function"&&(Sh(e,n,_,r),E=e.memoizedState),(d=Vr||mv(e,n,d,r,m,E,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Ah(t,e,n,r,i,a)}function Ah(t,e,n,r,a,i){lj(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&ov(e,n,!1),kr(t,e,i);r=e.stateNode,sT.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=qa(e,t.child,null,i),e.child=qa(e,null,l,i)):Gt(t,e,l,i),e.memoizedState=r.state,a&&ov(e,n,!0),e.child}function cj(t){var e=t.stateNode;e.pendingContext?iv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iv(t,e.context,!1),Jp(t,e.containerInfo)}function Nv(t,e,n,r,a){return $a(),Wp(a),e.flags|=256,Gt(t,e,n,r),e.child}var Dh={dehydrated:null,treeContext:null,retryLane:0};function zh(t){return{baseLanes:t,cachePool:null,transitions:null}}function uj(t,e,n){var r=e.pendingProps,a=nt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Ke(nt,a&1),t===null)return Eh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=gu(o,r,0,null),t=Ls(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=zh(n),e.memoizedState=Dh,t):af(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return aT(t,e,o,r,l,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,l=a.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=ns(a,u),r.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=ns(l,i):(i=Ls(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?zh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Dh,r}return i=t.child,t=i.sibling,r=ns(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function af(t,e){return e=gu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ll(t,e,n,r){return r!==null&&Wp(r),qa(e,t.child,null,n),t=af(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function aT(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Ad(Error(re(422))),Ll(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=gu({mode:"visible",children:r.children},a,0,null),i=Ls(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&qa(e,t.child,null,o),e.child.memoizedState=zh(o),e.memoizedState=Dh,i);if(!(e.mode&1))return Ll(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(re(419)),r=Ad(i,r,void 0),Ll(t,e,o,r)}if(l=(o&t.childLanes)!==0,nn||l){if(r=kt,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,br(t,a),Ln(r,t,a,-1))}return hf(),r=Ad(Error(re(421))),Ll(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=yT.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,un=Yr(a.nextSibling),fn=e,et=!0,An=null,t!==null&&(yn[xn++]=fr,yn[xn++]=mr,yn[xn++]=Us,fr=t.id,mr=t.overflow,Us=e),e=af(e,r.children),e.flags|=4096,e)}function bv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ih(t.return,e,n)}function Dd(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function dj(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(Gt(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bv(t,n,e);else if(t.tag===19)bv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ke(nt,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Pc(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Dd(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Pc(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Dd(e,!0,n,null,i);break;case"together":Dd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=ns(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ns(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function iT(t,e,n){switch(e.tag){case 3:cj(e),$a();break;case 5:Ow(e);break;case 1:sn(e.type)&&kc(e);break;case 4:Jp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;Ke(Ic,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ke(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?uj(t,e,n):(Ke(nt,nt.current&1),t=kr(t,e,n),t!==null?t.sibling:null);Ke(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dj(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ke(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,oj(t,e,n)}return kr(t,e,n)}var hj,Lh,pj,fj;hj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lh=function(){};pj=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,Rs(Zn.current);var i=null;switch(n){case"input":a=sh(t,a),r=sh(t,r),i=[];break;case"select":a=st({},a,{value:void 0}),r=st({},r,{value:void 0}),i=[];break;case"textarea":a=oh(t,a),r=oh(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nc)}ch(n,r);var o;n=null;for(d in a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ho.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=a!=null?a[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ho.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Qe("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};fj=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ai(t,e){if(!et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function oT(t,e,n){var r=e.pendingProps;switch(qp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(e),null;case 1:return sn(e.type)&&bc(),Ot(e),null;case 3:return r=e.stateNode,Wa(),Ye(rn),Ye(qt),Xp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Dl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,An!==null&&(qh(An),An=null))),Lh(t,e),Ot(e),null;case 5:Yp(e);var a=Rs(bo.current);if(n=e.type,t!==null&&e.stateNode!=null)pj(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(re(166));return Ot(e),null}if(t=Rs(Zn.current),Dl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Kn]=e,r[_o]=i,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(a=0;a<$i.length;a++)Qe($i[a],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":Ag(r,i),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Qe("invalid",r);break;case"textarea":zg(r,i),Qe("invalid",r)}ch(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Al(r.textContent,l,t),a=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Al(r.textContent,l,t),a=["children",""+l]):ho.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":kl(r),Dg(r,i,!0);break;case"textarea":kl(r),Lg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Nc)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Bx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Kn]=e,t[_o]=r,hj(t,e,!1,!1),e.stateNode=t;e:{switch(o=uh(n,r),n){case"dialog":Qe("cancel",t),Qe("close",t),a=r;break;case"iframe":case"object":case"embed":Qe("load",t),a=r;break;case"video":case"audio":for(a=0;a<$i.length;a++)Qe($i[a],t);a=r;break;case"source":Qe("error",t),a=r;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),a=r;break;case"details":Qe("toggle",t),a=r;break;case"input":Ag(t,r),a=sh(t,r),Qe("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=st({},r,{value:void 0}),Qe("invalid",t);break;case"textarea":zg(t,r),a=oh(t,r),Qe("invalid",t);break;default:a=r}ch(n,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Wx(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$x(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&po(t,u):typeof u=="number"&&po(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ho.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Qe("scroll",t):u!=null&&Sp(t,i,u,o))}switch(n){case"input":kl(t),Dg(t,r,!1);break;case"textarea":kl(t),Lg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+os(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ea(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ea(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Nc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ot(e),null;case 6:if(t&&e.stateNode!=null)fj(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(re(166));if(n=Rs(bo.current),Rs(Zn.current),Dl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Kn]=e,(i=r.nodeValue!==n)&&(t=fn,t!==null))switch(t.tag){case 3:Al(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Al(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=e,e.stateNode=r}return Ot(e),null;case 13:if(Ye(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&un!==null&&e.mode&1&&!(e.flags&128))Rw(),$a(),e.flags|=98560,i=!1;else if(i=Dl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[Kn]=e}else $a(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ot(e),i=!1}else An!==null&&(qh(An),An=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?jt===0&&(jt=3):hf())),e.updateQueue!==null&&(e.flags|=4),Ot(e),null);case 4:return Wa(),Lh(t,e),t===null&&wo(e.stateNode.containerInfo),Ot(e),null;case 10:return Gp(e.type._context),Ot(e),null;case 17:return sn(e.type)&&bc(),Ot(e),null;case 19:if(Ye(nt),i=e.memoizedState,i===null)return Ot(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ai(i,!1);else{if(jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Pc(t),o!==null){for(e.flags|=128,Ai(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ke(nt,nt.current&1|2),e.child}t=t.sibling}i.tail!==null&&ht()>Ka&&(e.flags|=128,r=!0,Ai(i,!1),e.lanes=4194304)}else{if(!r)if(t=Pc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ai(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!et)return Ot(e),null}else 2*ht()-i.renderingStartTime>Ka&&n!==1073741824&&(e.flags|=128,r=!0,Ai(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ht(),e.sibling=null,n=nt.current,Ke(nt,r?n&1|2:n&1),e):(Ot(e),null);case 22:case 23:return df(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?cn&1073741824&&(Ot(e),e.subtreeFlags&6&&(e.flags|=8192)):Ot(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function lT(t,e){switch(qp(e),e.tag){case 1:return sn(e.type)&&bc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wa(),Ye(rn),Ye(qt),Xp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yp(e),null;case 13:if(Ye(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));$a()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(nt),null;case 4:return Wa(),null;case 10:return Gp(e.type._context),null;case 22:case 23:return df(),null;case 24:return null;default:return null}}var Ol=!1,Ft=!1,cT=typeof WeakSet=="function"?WeakSet:Set,me=null;function ka(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ot(t,e,r)}else n.current=null}function Oh(t,e,n){try{n()}catch(r){ot(t,e,r)}}var kv=!1;function uT(t,e){if(wh=wc,t=xw(),Bp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var _;f!==n||a!==0&&f.nodeType!==3||(l=o+a),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===t)break t;if(m===n&&++d===a&&(l=o),m===i&&++h===r&&(u=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(jh={focusedElem:t,selectionRange:n},wc=!1,me=e;me!==null;)if(e=me,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,me=t;else for(;me!==null;){e=me;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var w=E.memoizedProps,x=E.memoizedState,v=e.stateNode,j=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:Pn(e.type,w),x);v.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(R){ot(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}return E=kv,kv=!1,E}function no(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&Oh(e,n,i)}a=a.next}while(a!==r)}}function fu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Vh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function mj(t){var e=t.alternate;e!==null&&(t.alternate=null,mj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kn],delete e[_o],delete e[bh],delete e[Hk],delete e[Kk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gj(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gj(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Mh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nc));else if(r!==4&&(t=t.child,t!==null))for(Mh(t,e,n),t=t.sibling;t!==null;)Mh(t,e,n),t=t.sibling}function Uh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Uh(t,e,n),t=t.sibling;t!==null;)Uh(t,e,n),t=t.sibling}var Et=null,Rn=!1;function zr(t,e,n){for(n=n.child;n!==null;)vj(t,e,n),n=n.sibling}function vj(t,e,n){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(iu,n)}catch{}switch(n.tag){case 5:Ft||ka(n,e);case 6:var r=Et,a=Rn;Et=null,zr(t,e,n),Et=r,Rn=a,Et!==null&&(Rn?(t=Et,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Et.removeChild(n.stateNode));break;case 18:Et!==null&&(Rn?(t=Et,n=n.stateNode,t.nodeType===8?Ed(t.parentNode,n):t.nodeType===1&&Ed(t,n),vo(t)):Ed(Et,n.stateNode));break;case 4:r=Et,a=Rn,Et=n.stateNode.containerInfo,Rn=!0,zr(t,e,n),Et=r,Rn=a;break;case 0:case 11:case 14:case 15:if(!Ft&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Oh(n,e,o),a=a.next}while(a!==r)}zr(t,e,n);break;case 1:if(!Ft&&(ka(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ot(n,e,l)}zr(t,e,n);break;case 21:zr(t,e,n);break;case 22:n.mode&1?(Ft=(r=Ft)||n.memoizedState!==null,zr(t,e,n),Ft=r):zr(t,e,n);break;default:zr(t,e,n)}}function Ev(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new cT),e.forEach(function(r){var a=xT.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Sn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Et=l.stateNode,Rn=!1;break e;case 3:Et=l.stateNode.containerInfo,Rn=!0;break e;case 4:Et=l.stateNode.containerInfo,Rn=!0;break e}l=l.return}if(Et===null)throw Error(re(160));vj(i,o,a),Et=null,Rn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(d){ot(a,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)yj(e,t),e=e.sibling}function yj(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sn(e,t),Bn(t),r&4){try{no(3,t,t.return),fu(3,t)}catch(w){ot(t,t.return,w)}try{no(5,t,t.return)}catch(w){ot(t,t.return,w)}}break;case 1:Sn(e,t),Bn(t),r&512&&n!==null&&ka(n,n.return);break;case 5:if(Sn(e,t),Bn(t),r&512&&n!==null&&ka(n,n.return),t.flags&32){var a=t.stateNode;try{po(a,"")}catch(w){ot(t,t.return,w)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ux(a,i),uh(l,o);var d=uh(l,i);for(o=0;o<u.length;o+=2){var h=u[o],f=u[o+1];h==="style"?Wx(a,f):h==="dangerouslySetInnerHTML"?$x(a,f):h==="children"?po(a,f):Sp(a,h,f,d)}switch(l){case"input":ah(a,i);break;case"textarea":Fx(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Ea(a,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ea(a,!!i.multiple,i.defaultValue,!0):Ea(a,!!i.multiple,i.multiple?[]:"",!1))}a[_o]=i}catch(w){ot(t,t.return,w)}}break;case 6:if(Sn(e,t),Bn(t),r&4){if(t.stateNode===null)throw Error(re(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(w){ot(t,t.return,w)}}break;case 3:if(Sn(e,t),Bn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vo(e.containerInfo)}catch(w){ot(t,t.return,w)}break;case 4:Sn(e,t),Bn(t);break;case 13:Sn(e,t),Bn(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(cf=ht())),r&4&&Ev(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ft=(d=Ft)||h,Sn(e,t),Ft=d):Sn(e,t),Bn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(me=t,h=t.child;h!==null;){for(f=me=h;me!==null;){switch(m=me,_=m.child,m.tag){case 0:case 11:case 14:case 15:no(4,m,m.return);break;case 1:ka(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(w){ot(r,n,w)}}break;case 5:ka(m,m.return);break;case 22:if(m.memoizedState!==null){Sv(f);continue}}_!==null?(_.return=m,me=_):Sv(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{a=f.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=qx("display",o))}catch(w){ot(t,t.return,w)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(w){ot(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Sn(e,t),Bn(t),r&4&&Ev(t);break;case 21:break;default:Sn(e,t),Bn(t)}}function Bn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(gj(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(po(a,""),r.flags&=-33);var i=Tv(t);Uh(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Tv(t);Mh(t,l,o);break;default:throw Error(re(161))}}catch(u){ot(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dT(t,e,n){me=t,xj(t)}function xj(t,e,n){for(var r=(t.mode&1)!==0;me!==null;){var a=me,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||Ol;if(!o){var l=a.alternate,u=l!==null&&l.memoizedState!==null||Ft;l=Ol;var d=Ft;if(Ol=o,(Ft=u)&&!d)for(me=a;me!==null;)o=me,u=o.child,o.tag===22&&o.memoizedState!==null?Cv(a):u!==null?(u.return=o,me=u):Cv(a);for(;i!==null;)me=i,xj(i),i=i.sibling;me=a,Ol=l,Ft=d}Iv(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,me=i):Iv(t)}}function Iv(t){for(;me!==null;){var e=me;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ft||fu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ft)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Pn(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&hv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hv(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&vo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}Ft||e.flags&512&&Vh(e)}catch(m){ot(e,e.return,m)}}if(e===t){me=null;break}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}}function Sv(t){for(;me!==null;){var e=me;if(e===t){me=null;break}var n=e.sibling;if(n!==null){n.return=e.return,me=n;break}me=e.return}}function Cv(t){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{fu(4,e)}catch(u){ot(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(u){ot(e,a,u)}}var i=e.return;try{Vh(e)}catch(u){ot(e,i,u)}break;case 5:var o=e.return;try{Vh(e)}catch(u){ot(e,o,u)}}}catch(u){ot(e,e.return,u)}if(e===t){me=null;break}var l=e.sibling;if(l!==null){l.return=e.return,me=l;break}me=e.return}}var hT=Math.ceil,Dc=Cr.ReactCurrentDispatcher,of=Cr.ReactCurrentOwner,jn=Cr.ReactCurrentBatchConfig,Ve=0,kt=null,gt=null,Ct=0,cn=0,Ta=ms(0),jt=0,Io=null,Bs=0,mu=0,lf=0,ro=null,en=null,cf=0,Ka=1/0,dr=null,zc=!1,Fh=null,es=null,Vl=!1,Hr=null,Lc=0,so=0,Bh=null,nc=-1,rc=0;function Qt(){return Ve&6?ht():nc!==-1?nc:nc=ht()}function ts(t){return t.mode&1?Ve&2&&Ct!==0?Ct&-Ct:Qk.transition!==null?(rc===0&&(rc=rw()),rc):(t=Be,t!==0||(t=window.event,t=t===void 0?16:uw(t.type)),t):1}function Ln(t,e,n,r){if(50<so)throw so=0,Bh=null,Error(re(185));$o(t,n,r),(!(Ve&2)||t!==kt)&&(t===kt&&(!(Ve&2)&&(mu|=n),jt===4&&Ur(t,Ct)),an(t,r),n===1&&Ve===0&&!(e.mode&1)&&(Ka=ht()+500,du&&gs()))}function an(t,e){var n=t.callbackNode;Qb(t,e);var r=xc(t,t===kt?Ct:0);if(r===0)n!==null&&Mg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mg(n),e===1)t.tag===0?Gk(Pv.bind(null,t)):Sw(Pv.bind(null,t)),qk(function(){!(Ve&6)&&gs()}),n=null;else{switch(sw(r)){case 1:n=Dp;break;case 4:n=tw;break;case 16:n=yc;break;case 536870912:n=nw;break;default:n=yc}n=Ej(n,wj.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wj(t,e){if(nc=-1,rc=0,Ve&6)throw Error(re(327));var n=t.callbackNode;if(Ra()&&t.callbackNode!==n)return null;var r=xc(t,t===kt?Ct:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Oc(t,r);else{e=r;var a=Ve;Ve|=2;var i=_j();(kt!==t||Ct!==e)&&(dr=null,Ka=ht()+500,zs(t,e));do try{mT();break}catch(l){jj(t,l)}while(!0);Kp(),Dc.current=i,Ve=a,gt!==null?e=0:(kt=null,Ct=0,e=jt)}if(e!==0){if(e===2&&(a=mh(t),a!==0&&(r=a,e=$h(t,a))),e===1)throw n=Io,zs(t,0),Ur(t,r),an(t,ht()),n;if(e===6)Ur(t,r);else{if(a=t.current.alternate,!(r&30)&&!pT(a)&&(e=Oc(t,r),e===2&&(i=mh(t),i!==0&&(r=i,e=$h(t,i))),e===1))throw n=Io,zs(t,0),Ur(t,r),an(t,ht()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(re(345));case 2:Is(t,en,dr);break;case 3:if(Ur(t,r),(r&130023424)===r&&(e=cf+500-ht(),10<e)){if(xc(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){Qt(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Nh(Is.bind(null,t,en,dr),e);break}Is(t,en,dr);break;case 4:if(Ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-zn(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*hT(r/1960))-r,10<r){t.timeoutHandle=Nh(Is.bind(null,t,en,dr),r);break}Is(t,en,dr);break;case 5:Is(t,en,dr);break;default:throw Error(re(329))}}}return an(t,ht()),t.callbackNode===n?wj.bind(null,t):null}function $h(t,e){var n=ro;return t.current.memoizedState.isDehydrated&&(zs(t,e).flags|=256),t=Oc(t,e),t!==2&&(e=en,en=n,e!==null&&qh(e)),t}function qh(t){en===null?en=t:en.push.apply(en,t)}function pT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Mn(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ur(t,e){for(e&=~lf,e&=~mu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-zn(e),r=1<<n;t[n]=-1,e&=~r}}function Pv(t){if(Ve&6)throw Error(re(327));Ra();var e=xc(t,0);if(!(e&1))return an(t,ht()),null;var n=Oc(t,e);if(t.tag!==0&&n===2){var r=mh(t);r!==0&&(e=r,n=$h(t,r))}if(n===1)throw n=Io,zs(t,0),Ur(t,e),an(t,ht()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Is(t,en,dr),an(t,ht()),null}function uf(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(Ka=ht()+500,du&&gs())}}function $s(t){Hr!==null&&Hr.tag===0&&!(Ve&6)&&Ra();var e=Ve;Ve|=1;var n=jn.transition,r=Be;try{if(jn.transition=null,Be=1,t)return t()}finally{Be=r,jn.transition=n,Ve=e,!(Ve&6)&&gs()}}function df(){cn=Ta.current,Ye(Ta)}function zs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$k(n)),gt!==null)for(n=gt.return;n!==null;){var r=n;switch(qp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bc();break;case 3:Wa(),Ye(rn),Ye(qt),Xp();break;case 5:Yp(r);break;case 4:Wa();break;case 13:Ye(nt);break;case 19:Ye(nt);break;case 10:Gp(r.type._context);break;case 22:case 23:df()}n=n.return}if(kt=t,gt=t=ns(t.current,null),Ct=cn=e,jt=0,Io=null,lf=mu=Bs=0,en=ro=null,Ps!==null){for(e=0;e<Ps.length;e++)if(n=Ps[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}Ps=null}return t}function jj(t,e){do{var n=gt;try{if(Kp(),Xl.current=Ac,Rc){for(var r=rt.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Rc=!1}if(Fs=0,bt=xt=rt=null,to=!1,ko=0,of.current=null,n===null||n.return===null){jt=1,Io=e,gt=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=Ct,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=yv(o);if(_!==null){_.flags&=-257,xv(_,o,l,i,e),_.mode&1&&vv(i,d,e),e=_,u=d;var E=e.updateQueue;if(E===null){var w=new Set;w.add(u),e.updateQueue=w}else E.add(u);break e}else{if(!(e&1)){vv(i,d,e),hf();break e}u=Error(re(426))}}else if(et&&l.mode&1){var x=yv(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),xv(x,o,l,i,e),Wp(Ha(u,l));break e}}i=u=Ha(u,l),jt!==4&&(jt=2),ro===null?ro=[i]:ro.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=sj(i,u,e);dv(i,v);break e;case 1:l=u;var j=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof j.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(es===null||!es.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=aj(i,l,e);dv(i,R);break e}}i=i.return}while(i!==null)}bj(n)}catch(L){e=L,gt===n&&n!==null&&(gt=n=n.return);continue}break}while(!0)}function _j(){var t=Dc.current;return Dc.current=Ac,t===null?Ac:t}function hf(){(jt===0||jt===3||jt===2)&&(jt=4),kt===null||!(Bs&268435455)&&!(mu&268435455)||Ur(kt,Ct)}function Oc(t,e){var n=Ve;Ve|=2;var r=_j();(kt!==t||Ct!==e)&&(dr=null,zs(t,e));do try{fT();break}catch(a){jj(t,a)}while(!0);if(Kp(),Ve=n,Dc.current=r,gt!==null)throw Error(re(261));return kt=null,Ct=0,jt}function fT(){for(;gt!==null;)Nj(gt)}function mT(){for(;gt!==null&&!Ub();)Nj(gt)}function Nj(t){var e=Tj(t.alternate,t,cn);t.memoizedProps=t.pendingProps,e===null?bj(t):gt=e,of.current=null}function bj(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=lT(n,e),n!==null){n.flags&=32767,gt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jt=6,gt=null;return}}else if(n=oT(n,e,cn),n!==null){gt=n;return}if(e=e.sibling,e!==null){gt=e;return}gt=e=t}while(e!==null);jt===0&&(jt=5)}function Is(t,e,n){var r=Be,a=jn.transition;try{jn.transition=null,Be=1,gT(t,e,n,r)}finally{jn.transition=a,Be=r}return null}function gT(t,e,n,r){do Ra();while(Hr!==null);if(Ve&6)throw Error(re(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Zb(t,i),t===kt&&(gt=kt=null,Ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vl||(Vl=!0,Ej(yc,function(){return Ra(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=jn.transition,jn.transition=null;var o=Be;Be=1;var l=Ve;Ve|=4,of.current=null,uT(t,n),yj(n,t),Lk(jh),wc=!!wh,jh=wh=null,t.current=n,dT(n),Fb(),Ve=l,Be=o,jn.transition=i}else t.current=n;if(Vl&&(Vl=!1,Hr=t,Lc=a),i=t.pendingLanes,i===0&&(es=null),qb(n.stateNode),an(t,ht()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(zc)throw zc=!1,t=Fh,Fh=null,t;return Lc&1&&t.tag!==0&&Ra(),i=t.pendingLanes,i&1?t===Bh?so++:(so=0,Bh=t):so=0,gs(),null}function Ra(){if(Hr!==null){var t=sw(Lc),e=jn.transition,n=Be;try{if(jn.transition=null,Be=16>t?16:t,Hr===null)var r=!1;else{if(t=Hr,Hr=null,Lc=0,Ve&6)throw Error(re(331));var a=Ve;for(Ve|=4,me=t.current;me!==null;){var i=me,o=i.child;if(me.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(me=d;me!==null;){var h=me;switch(h.tag){case 0:case 11:case 15:no(8,h,i)}var f=h.child;if(f!==null)f.return=h,me=f;else for(;me!==null;){h=me;var m=h.sibling,_=h.return;if(mj(h),h===d){me=null;break}if(m!==null){m.return=_,me=m;break}me=_}}}var E=i.alternate;if(E!==null){var w=E.child;if(w!==null){E.child=null;do{var x=w.sibling;w.sibling=null,w=x}while(w!==null)}}me=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,me=o;else e:for(;me!==null;){if(i=me,i.flags&2048)switch(i.tag){case 0:case 11:case 15:no(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,me=v;break e}me=i.return}}var j=t.current;for(me=j;me!==null;){o=me;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,me=S;else e:for(o=j;me!==null;){if(l=me,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:fu(9,l)}}catch(L){ot(l,l.return,L)}if(l===o){me=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,me=R;break e}me=l.return}}if(Ve=a,gs(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(iu,t)}catch{}r=!0}return r}finally{Be=n,jn.transition=e}}return!1}function Rv(t,e,n){e=Ha(n,e),e=sj(t,e,1),t=Xr(t,e,1),e=Qt(),t!==null&&($o(t,1,e),an(t,e))}function ot(t,e,n){if(t.tag===3)Rv(t,t,n);else for(;e!==null;){if(e.tag===3){Rv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(es===null||!es.has(r))){t=Ha(n,t),t=aj(e,t,1),e=Xr(e,t,1),t=Qt(),e!==null&&($o(e,1,t),an(e,t));break}}e=e.return}}function vT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Qt(),t.pingedLanes|=t.suspendedLanes&n,kt===t&&(Ct&n)===n&&(jt===4||jt===3&&(Ct&130023424)===Ct&&500>ht()-cf?zs(t,0):lf|=n),an(t,e)}function kj(t,e){e===0&&(t.mode&1?(e=Il,Il<<=1,!(Il&130023424)&&(Il=4194304)):e=1);var n=Qt();t=br(t,e),t!==null&&($o(t,e,n),an(t,n))}function yT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kj(t,n)}function xT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(e),kj(t,n)}var Tj;Tj=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||rn.current)nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nn=!1,iT(t,e,n);nn=!!(t.flags&131072)}else nn=!1,et&&e.flags&1048576&&Cw(e,Ec,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;tc(t,e),t=e.pendingProps;var a=Ba(e,qt.current);Pa(e,n),a=tf(null,e,r,t,a,n);var i=nf();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,sn(r)?(i=!0,kc(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Zp(e),a.updater=pu,e.stateNode=a,a._reactInternals=e,Ch(e,r,t,n),e=Ah(null,e,r,!0,i,n)):(e.tag=0,et&&i&&$p(e),Gt(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(tc(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=jT(r),t=Pn(r,t),a){case 0:e=Rh(null,e,r,t,n);break e;case 1:e=_v(null,e,r,t,n);break e;case 11:e=wv(null,e,r,t,n);break e;case 14:e=jv(null,e,r,Pn(r.type,t),n);break e}throw Error(re(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Pn(r,a),Rh(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Pn(r,a),_v(t,e,r,a,n);case 3:e:{if(cj(e),t===null)throw Error(re(387));r=e.pendingProps,i=e.memoizedState,a=i.element,Lw(t,e),Cc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=Ha(Error(re(423)),e),e=Nv(t,e,r,n,a);break e}else if(r!==a){a=Ha(Error(re(424)),e),e=Nv(t,e,r,n,a);break e}else for(un=Yr(e.stateNode.containerInfo.firstChild),fn=e,et=!0,An=null,n=Dw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($a(),r===a){e=kr(t,e,n);break e}Gt(t,e,r,n)}e=e.child}return e;case 5:return Ow(e),t===null&&Eh(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,_h(r,a)?o=null:i!==null&&_h(r,i)&&(e.flags|=32),lj(t,e),Gt(t,e,o,n),e.child;case 6:return t===null&&Eh(e),null;case 13:return uj(t,e,n);case 4:return Jp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qa(e,null,r,n):Gt(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Pn(r,a),wv(t,e,r,a,n);case 7:return Gt(t,e,e.pendingProps,n),e.child;case 8:return Gt(t,e,e.pendingProps.children,n),e.child;case 12:return Gt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,Ke(Ic,r._currentValue),r._currentValue=o,i!==null)if(Mn(i.value,o)){if(i.children===a.children&&!rn.current){e=kr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=xr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Ih(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(re(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ih(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Gt(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Pa(e,n),a=bn(a),r=r(a),e.flags|=1,Gt(t,e,r,n),e.child;case 14:return r=e.type,a=Pn(r,e.pendingProps),a=Pn(r.type,a),jv(t,e,r,a,n);case 15:return ij(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Pn(r,a),tc(t,e),e.tag=1,sn(r)?(t=!0,kc(e)):t=!1,Pa(e,n),rj(e,r,a),Ch(e,r,a,n),Ah(null,e,r,!0,t,n);case 19:return dj(t,e,n);case 22:return oj(t,e,n)}throw Error(re(156,e.tag))};function Ej(t,e){return ew(t,e)}function wT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(t,e,n,r){return new wT(t,e,n,r)}function pf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jT(t){if(typeof t=="function")return pf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pp)return 11;if(t===Rp)return 14}return 2}function ns(t,e){var n=t.alternate;return n===null?(n=wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function sc(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")pf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ga:return Ls(n.children,a,i,e);case Cp:o=8,a|=8;break;case eh:return t=wn(12,n,e,a|2),t.elementType=eh,t.lanes=i,t;case th:return t=wn(13,n,e,a),t.elementType=th,t.lanes=i,t;case nh:return t=wn(19,n,e,a),t.elementType=nh,t.lanes=i,t;case Ox:return gu(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zx:o=10;break e;case Lx:o=9;break e;case Pp:o=11;break e;case Rp:o=14;break e;case Or:o=16,r=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=wn(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function Ls(t,e,n,r){return t=wn(7,t,r,e),t.lanes=n,t}function gu(t,e,n,r){return t=wn(22,t,r,e),t.elementType=Ox,t.lanes=n,t.stateNode={isHidden:!1},t}function zd(t,e,n){return t=wn(6,t,null,e),t.lanes=n,t}function Ld(t,e,n){return e=wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _T(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gd(0),this.expirationTimes=gd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gd(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function ff(t,e,n,r,a,i,o,l,u){return t=new _T(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zp(i),t}function NT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ma,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ij(t){if(!t)return ls;t=t._reactInternals;e:{if(Ys(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(sn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(sn(n))return Iw(t,n,e)}return e}function Sj(t,e,n,r,a,i,o,l,u){return t=ff(n,r,!0,t,a,i,o,l,u),t.context=Ij(null),n=t.current,r=Qt(),a=ts(n),i=xr(r,a),i.callback=e??null,Xr(n,i,a),t.current.lanes=a,$o(t,a,r),an(t,r),t}function vu(t,e,n,r){var a=e.current,i=Qt(),o=ts(a);return n=Ij(n),e.context===null?e.context=n:e.pendingContext=n,e=xr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xr(a,e,o),t!==null&&(Ln(t,a,o,i),Yl(t,a,o)),o}function Vc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Av(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function mf(t,e){Av(t,e),(t=t.alternate)&&Av(t,e)}function bT(){return null}var Cj=typeof reportError=="function"?reportError:function(t){console.error(t)};function gf(t){this._internalRoot=t}yu.prototype.render=gf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));vu(t,e,null,null)};yu.prototype.unmount=gf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$s(function(){vu(null,t,null,null)}),e[Nr]=null}};function yu(t){this._internalRoot=t}yu.prototype.unstable_scheduleHydration=function(t){if(t){var e=ow();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Mr.length&&e!==0&&e<Mr[n].priority;n++);Mr.splice(n,0,t),n===0&&cw(t)}};function vf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Dv(){}function kT(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var d=Vc(o);i.call(d)}}var o=Sj(e,r,t,0,null,!1,!1,"",Dv);return t._reactRootContainer=o,t[Nr]=o.current,wo(t.nodeType===8?t.parentNode:t),$s(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var l=r;r=function(){var d=Vc(u);l.call(d)}}var u=ff(t,0,!1,null,null,!1,!1,"",Dv);return t._reactRootContainer=u,t[Nr]=u.current,wo(t.nodeType===8?t.parentNode:t),$s(function(){vu(e,u,n,r)}),u}function wu(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var u=Vc(o);l.call(u)}}vu(e,o,t,a)}else o=kT(n,e,t,a,r);return Vc(o)}aw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Bi(e.pendingLanes);n!==0&&(zp(e,n|1),an(e,ht()),!(Ve&6)&&(Ka=ht()+500,gs()))}break;case 13:$s(function(){var r=br(t,1);if(r!==null){var a=Qt();Ln(r,t,1,a)}}),mf(t,1)}};Lp=function(t){if(t.tag===13){var e=br(t,134217728);if(e!==null){var n=Qt();Ln(e,t,134217728,n)}mf(t,134217728)}};iw=function(t){if(t.tag===13){var e=ts(t),n=br(t,e);if(n!==null){var r=Qt();Ln(n,t,e,r)}mf(t,e)}};ow=function(){return Be};lw=function(t,e){var n=Be;try{return Be=t,e()}finally{Be=n}};hh=function(t,e,n){switch(e){case"input":if(ah(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=uu(r);if(!a)throw Error(re(90));Mx(r),ah(r,a)}}}break;case"textarea":Fx(t,n);break;case"select":e=n.value,e!=null&&Ea(t,!!n.multiple,e,!1)}};Gx=uf;Qx=$s;var TT={usingClientEntryPoint:!1,Events:[Wo,wa,uu,Hx,Kx,uf]},Di={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ET={bundleType:Di.bundleType,version:Di.version,rendererPackageName:Di.rendererPackageName,rendererConfig:Di.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Yx(t),t===null?null:t.stateNode},findFiberByHostInstance:Di.findFiberByHostInstance||bT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{iu=Ml.inject(ET),Qn=Ml}catch{}}gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TT;gn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vf(e))throw Error(re(200));return NT(t,e,null,n)};gn.createRoot=function(t,e){if(!vf(t))throw Error(re(299));var n=!1,r="",a=Cj;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=ff(t,1,!1,null,null,n,!1,r,a),t[Nr]=e.current,wo(t.nodeType===8?t.parentNode:t),new gf(e)};gn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=Yx(e),t=t===null?null:t.stateNode,t};gn.flushSync=function(t){return $s(t)};gn.hydrate=function(t,e,n){if(!xu(e))throw Error(re(200));return wu(null,t,e,!0,n)};gn.hydrateRoot=function(t,e,n){if(!vf(t))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=Cj;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Sj(e,null,t,1,n??null,a,!1,i,o),t[Nr]=e.current,wo(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new yu(e)};gn.render=function(t,e,n){if(!xu(e))throw Error(re(200));return wu(null,t,e,!1,n)};gn.unmountComponentAtNode=function(t){if(!xu(t))throw Error(re(40));return t._reactRootContainer?($s(function(){wu(null,null,t,!1,function(){t._reactRootContainer=null,t[Nr]=null})}),!0):!1};gn.unstable_batchedUpdates=uf;gn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!xu(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return wu(t,e,n,!1,r)};gn.version="18.3.1-next-f1338f8080-20240426";function Pj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pj)}catch(t){console.error(t)}}Pj(),Px.exports=gn;var ju=Px.exports,zv=ju;Yd.createRoot=zv.createRoot,Yd.hydrateRoot=zv.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function So(){return So=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},So.apply(this,arguments)}var Kr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Kr||(Kr={}));const Lv="popstate";function IT(t){t===void 0&&(t={});function e(r,a){let{pathname:i,search:o,hash:l}=r.location;return Wh("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Mc(a)}return CT(e,n,null,t)}function ft(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ST(){return Math.random().toString(36).substr(2,8)}function Ov(t,e){return{usr:t.state,key:t.key,idx:e}}function Wh(t,e,n,r){return n===void 0&&(n=null),So({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ii(e):e,{state:n,key:e&&e.key||r||ST()})}function Mc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ii(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function CT(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,l=Kr.Pop,u=null,d=h();d==null&&(d=0,o.replaceState(So({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=Kr.Pop;let x=h(),v=x==null?null:x-d;d=x,u&&u({action:l,location:w.location,delta:v})}function m(x,v){l=Kr.Push;let j=Wh(w.location,x,v);d=h()+1;let S=Ov(j,d),R=w.createHref(j);try{o.pushState(S,"",R)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(R)}i&&u&&u({action:l,location:w.location,delta:1})}function _(x,v){l=Kr.Replace;let j=Wh(w.location,x,v);d=h();let S=Ov(j,d),R=w.createHref(j);o.replaceState(S,"",R),i&&u&&u({action:l,location:w.location,delta:0})}function E(x){let v=a.location.origin!=="null"?a.location.origin:a.location.href,j=typeof x=="string"?x:Mc(x);return j=j.replace(/ $/,"%20"),ft(v,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,v)}let w={get action(){return l},get location(){return t(a,o)},listen(x){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(Lv,f),u=x,()=>{a.removeEventListener(Lv,f),u=null}},createHref(x){return e(a,x)},createURL:E,encodeLocation(x){let v=E(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:_,go(x){return o.go(x)}};return w}var Vv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Vv||(Vv={}));function PT(t,e,n){return n===void 0&&(n="/"),RT(t,e,n)}function RT(t,e,n,r){let a=typeof e=="string"?ii(e):e,i=xf(a.pathname||"/",n);if(i==null)return null;let o=Rj(t);AT(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=WT(i);l=BT(o[u],d)}return l}function Rj(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(ft(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=rs([r,u.relativePath]),h=n.concat(u);i.children&&i.children.length>0&&(ft(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Rj(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:UT(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let u of Aj(i.path))a(i,o,u)}),e}function Aj(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=Aj(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function AT(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:FT(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const DT=/^:[\w-]+$/,zT=3,LT=2,OT=1,VT=10,MT=-2,Mv=t=>t==="*";function UT(t,e){let n=t.split("/"),r=n.length;return n.some(Mv)&&(r+=MT),e&&(r+=LT),n.filter(a=>!Mv(a)).reduce((a,i)=>a+(DT.test(i)?zT:i===""?OT:VT),r)}function FT(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function BT(t,e,n){let{routesMeta:r}=t,a={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=$T({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:rs([i,f.pathname]),pathnameBase:ZT(rs([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=rs([i,f.pathnameBase]))}return o}function $T(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=qT(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:_}=h;if(m==="*"){let w=l[f]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const E=l[f];return _&&!E?d[m]=void 0:d[m]=(E||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function qT(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),yf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function WT(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const HT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KT=t=>HT.test(t);function GT(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?ii(t):t,i;if(n)if(KT(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),yf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Uv(n.substring(1),"/"):i=Uv(n,e)}else i=e;return{pathname:i,search:JT(r),hash:YT(a)}}function Uv(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Od(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wf(t,e){let n=QT(t);return e?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function jf(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=ii(t):(a=So({},t),ft(!a.pathname||!a.pathname.includes("?"),Od("?","pathname","search",a)),ft(!a.pathname||!a.pathname.includes("#"),Od("#","pathname","hash",a)),ft(!a.search||!a.search.includes("#"),Od("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;a.pathname=m.join("/")}l=f>=0?e[f]:"/"}let u=GT(a,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}const rs=t=>t.join("/").replace(/\/\/+/g,"/"),ZT=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JT=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,YT=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Dj=["post","put","patch","delete"];new Set(Dj);const eE=["get",...Dj];new Set(eE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Co(){return Co=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Co.apply(this,arguments)}const _f=C.createContext(null),tE=C.createContext(null),vs=C.createContext(null),_u=C.createContext(null),sr=C.createContext({outlet:null,matches:[],isDataRoute:!1}),zj=C.createContext(null);function nE(t,e){let{relative:n}=e===void 0?{}:e;oi()||ft(!1);let{basename:r,navigator:a}=C.useContext(vs),{hash:i,pathname:o,search:l}=Oj(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:rs([r,o])),a.createHref({pathname:u,search:l,hash:i})}function oi(){return C.useContext(_u)!=null}function ar(){return oi()||ft(!1),C.useContext(_u).location}function Lj(t){C.useContext(vs).static||C.useLayoutEffect(t)}function _t(){let{isDataRoute:t}=C.useContext(sr);return t?vE():rE()}function rE(){oi()||ft(!1);let t=C.useContext(_f),{basename:e,future:n,navigator:r}=C.useContext(vs),{matches:a}=C.useContext(sr),{pathname:i}=ar(),o=JSON.stringify(wf(a,n.v7_relativeSplatPath)),l=C.useRef(!1);return Lj(()=>{l.current=!0}),C.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let f=jf(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:rs([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,i,t])}const sE=C.createContext(null);function aE(t){let e=C.useContext(sr).outlet;return e&&C.createElement(sE.Provider,{value:t},e)}function ir(){let{matches:t}=C.useContext(sr),e=t[t.length-1];return e?e.params:{}}function Oj(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=C.useContext(vs),{matches:a}=C.useContext(sr),{pathname:i}=ar(),o=JSON.stringify(wf(a,r.v7_relativeSplatPath));return C.useMemo(()=>jf(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function iE(t,e){return oE(t,e)}function oE(t,e,n,r){oi()||ft(!1);let{navigator:a}=C.useContext(vs),{matches:i}=C.useContext(sr),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=ar(),h;if(e){var f;let x=typeof e=="string"?ii(e):e;u==="/"||(f=x.pathname)!=null&&f.startsWith(u)||ft(!1),h=x}else h=d;let m=h.pathname||"/",_=m;if(u!=="/"){let x=u.replace(/^\//,"").split("/");_="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let E=PT(t,{pathname:_}),w=hE(E&&E.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:rs([u,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:rs([u,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,r);return e&&w?C.createElement(_u.Provider,{value:{location:Co({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Kr.Pop}},w):w}function lE(){let t=gE(),e=XT(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:a},n):null,null)}const cE=C.createElement(lE,null);class uE extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(sr.Provider,{value:this.props.routeContext},C.createElement(zj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dE(t){let{routeContext:e,match:n,children:r}=t,a=C.useContext(_f);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(sr.Provider,{value:e},r)}function hE(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(a=n)==null?void 0:a.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||ft(!1),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:_}=n,E=f.route.loader&&m[f.route.id]===void 0&&(!_||_[f.route.id]===void 0);if(f.route.lazy||E){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let _,E=!1,w=null,x=null;n&&(_=l&&f.route.id?l[f.route.id]:void 0,w=f.route.errorElement||cE,u&&(d<0&&m===0?(yE("route-fallback"),E=!0,x=null):d===m&&(E=!0,x=f.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,m+1)),j=()=>{let S;return _?S=w:E?S=x:f.route.Component?S=C.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=h,C.createElement(dE,{match:f,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:S})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?C.createElement(uE,{location:n.location,revalidation:n.revalidation,component:w,error:_,children:j(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):j()},null)}var Vj=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Vj||{}),Mj=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Mj||{});function pE(t){let e=C.useContext(_f);return e||ft(!1),e}function fE(t){let e=C.useContext(tE);return e||ft(!1),e}function mE(t){let e=C.useContext(sr);return e||ft(!1),e}function Uj(t){let e=mE(),n=e.matches[e.matches.length-1];return n.route.id||ft(!1),n.route.id}function gE(){var t;let e=C.useContext(zj),n=fE(),r=Uj();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function vE(){let{router:t}=pE(Vj.UseNavigateStable),e=Uj(Mj.UseNavigateStable),n=C.useRef(!1);return Lj(()=>{n.current=!0}),C.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Co({fromRouteId:e},i)))},[t,e])}const Fv={};function yE(t,e,n){Fv[t]||(Fv[t]=!0)}function xE(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Aa(t){let{to:e,replace:n,state:r,relative:a}=t;oi()||ft(!1);let{future:i,static:o}=C.useContext(vs),{matches:l}=C.useContext(sr),{pathname:u}=ar(),d=_t(),h=jf(e,wf(l,i.v7_relativeSplatPath),u,a==="path"),f=JSON.stringify(h);return C.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:a}),[d,f,a,n,r]),null}function wE(t){return aE(t.context)}function Xe(t){ft(!1)}function jE(t){let{basename:e="/",children:n=null,location:r,navigationType:a=Kr.Pop,navigator:i,static:o=!1,future:l}=t;oi()&&ft(!1);let u=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:u,navigator:i,static:o,future:Co({v7_relativeSplatPath:!1},l)}),[u,l,i,o]);typeof r=="string"&&(r=ii(r));let{pathname:h="/",search:f="",hash:m="",state:_=null,key:E="default"}=r,w=C.useMemo(()=>{let x=xf(h,u);return x==null?null:{location:{pathname:x,search:f,hash:m,state:_,key:E},navigationType:a}},[u,h,f,m,_,E,a]);return w==null?null:C.createElement(vs.Provider,{value:d},C.createElement(_u.Provider,{children:n,value:w}))}function _E(t){let{children:e,location:n}=t;return iE(Hh(e),n)}new Promise(()=>{});function Hh(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,a)=>{if(!C.isValidElement(r))return;let i=[...e,a];if(r.type===C.Fragment){n.push.apply(n,Hh(r.props.children,i));return}r.type!==Xe&&ft(!1),!r.props.index||!r.props.children||ft(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Hh(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kh(){return Kh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kh.apply(this,arguments)}function NE(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function bE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function kE(t,e){return t.button===0&&(!e||e==="_self")&&!bE(t)}function Gh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function TE(t,e){let n=Gh(t);return e&&e.forEach((r,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const EE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],IE="6";try{window.__reactRouterVersion=IE}catch{}const SE="startTransition",Bv=vb[SE];function CE(t){let{basename:e,children:n,future:r,window:a}=t,i=C.useRef();i.current==null&&(i.current=IT({window:a,v5Compat:!0}));let o=i.current,[l,u]=C.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=C.useCallback(f=>{d&&Bv?Bv(()=>u(f)):u(f)},[u,d]);return C.useLayoutEffect(()=>o.listen(h),[o,h]),C.useEffect(()=>xE(r),[r]),C.createElement(jE,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const PE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",RE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ie=C.forwardRef(function(e,n){let{onClick:r,relative:a,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:f}=e,m=NE(e,EE),{basename:_}=C.useContext(vs),E,w=!1;if(typeof d=="string"&&RE.test(d)&&(E=d,PE))try{let S=new URL(window.location.href),R=d.startsWith("//")?new URL(S.protocol+d):new URL(d),L=xf(R.pathname,_);R.origin===S.origin&&L!=null?d=L+R.search+R.hash:w=!0}catch{}let x=nE(d,{relative:a}),v=AE(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:a,viewTransition:f});function j(S){r&&r(S),S.defaultPrevented||v(S)}return C.createElement("a",Kh({},m,{href:E||x,onClick:w||i?r:j,ref:n,target:u}))});var $v;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})($v||($v={}));var qv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(qv||(qv={}));function AE(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,u=_t(),d=ar(),h=Oj(t,{relative:o});return C.useCallback(f=>{if(kE(f,n)){f.preventDefault();let m=r!==void 0?r:Mc(d)===Mc(h);u(t,{replace:m,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[d,u,h,r,a,n,t,i,o,l])}function Fj(t){let e=C.useRef(Gh(t)),n=C.useRef(!1),r=ar(),a=C.useMemo(()=>TE(r.search,n.current?null:e.current),[r.search]),i=_t(),o=C.useCallback((l,u)=>{const d=Gh(typeof l=="function"?l(a):l);n.current=!0,i("?"+d,u)},[i,a]);return[a,o]}var Wv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},DE=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[n++];e[r++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[n++],o=t[n++],l=t[n++],u=((a&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return e.join("")},$j={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const i=t[a],o=a+1<t.length,l=o?t[a+1]:0,u=a+2<t.length,d=u?t[a+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,_=d&63;u||(_=64,o||(m=64)),r.push(n[h],n[f],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Bj(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):DE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const i=n[t.charAt(a++)],l=a<t.length?n[t.charAt(a)]:0;++a;const d=a<t.length?n[t.charAt(a)]:64;++a;const f=a<t.length?n[t.charAt(a)]:64;if(++a,i==null||l==null||d==null||f==null)throw new zE;const m=i<<2|l>>4;if(r.push(m),d!==64){const _=l<<4&240|d>>2;if(r.push(_),f!==64){const E=d<<6&192|f;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LE=function(t){const e=Bj(t);return $j.encodeByteArray(e,!0)},Uc=function(t){return LE(t).replace(/\./g,"")},qj=function(t){try{return $j.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=()=>OE().__FIREBASE_DEFAULTS__,ME=()=>{if(typeof process>"u"||typeof Wv>"u")return;const t=Wv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},UE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qj(t[1]);return e&&JSON.parse(e)},Nu=()=>{try{return VE()||ME()||UE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Wj=t=>{var e,n;return(n=(e=Nu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Hj=t=>{const e=Wj(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Kj=()=>{var t;return(t=Nu())===null||t===void 0?void 0:t.config},Gj=t=>{var e;return(e=Nu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Uc(JSON.stringify(n)),Uc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function $E(){var t;const e=(t=Nu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WE(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function HE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KE(){const t=Wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function GE(){return!$E()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function QE(){try{return typeof indexedDB=="object"}catch{return!1}}function ZE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var i;e(((i=a.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="FirebaseError";class or extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=JE,Object.setPrototypeOf(this,or.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ko.prototype.create)}}class Ko{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},a=`${this.service}/${e}`,i=this.errors[e],o=i?YE(i,r):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new or(a,l,r)}}function YE(t,e){return t.replace(XE,(n,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const XE=/\{\$([^}]+)}/g;function eI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const i=t[a],o=e[a];if(Hv(i)&&Hv(o)){if(!Fc(i,o))return!1}else if(i!==o)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function Hv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Go(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function qi(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,i]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(i)}}),e}function Wi(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function tI(t,e){const n=new nI(t,e);return n.subscribe.bind(n)}class nI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let a;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");rI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:r},a.next===void 0&&(a.next=Vd),a.error===void 0&&(a.error=Vd),a.complete===void 0&&(a.complete=Vd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Vd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class cs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new FE;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(a)return null;throw i}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iI(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:a});r.resolve(i)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(a)}return a}onInit(e,n){var r;const a=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(a,i);const o=this.instances.get(a);return o&&e(o,a),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aI(t){return t===Ss?void 0:t}function iI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new sI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ae||(Ae={}));const lI={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},cI=Ae.INFO,uI={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},dI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),a=uI[e];if(a)console[a](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nf{constructor(e){this.name=e,this._logLevel=cI,this._logHandler=dI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...e),this._logHandler(this,Ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...e),this._logHandler(this,Ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...e),this._logHandler(this,Ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...e),this._logHandler(this,Ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...e),this._logHandler(this,Ae.ERROR,...e)}}const hI=(t,e)=>e.some(n=>t instanceof n);let Kv,Gv;function pI(){return Kv||(Kv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fI(){return Gv||(Gv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Zj=new WeakMap,Qh=new WeakMap,Jj=new WeakMap,Md=new WeakMap,bf=new WeakMap;function mI(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ss(t.result)),a()},o=()=>{r(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Zj.set(n,t)}).catch(()=>{}),bf.set(e,t),e}function gI(t){if(Qh.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),a()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Qh.set(t,e)}let Zh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Qh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Jj.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ss(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vI(t){Zh=t(Zh)}function yI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ud(this),e,...n);return Jj.set(r,e.sort?e.sort():[e]),ss(r)}:fI().includes(t)?function(...e){return t.apply(Ud(this),e),ss(Zj.get(this))}:function(...e){return ss(t.apply(Ud(this),e))}}function xI(t){return typeof t=="function"?yI(t):(t instanceof IDBTransaction&&gI(t),hI(t,pI())?new Proxy(t,Zh):t)}function ss(t){if(t instanceof IDBRequest)return mI(t);if(Md.has(t))return Md.get(t);const e=xI(t);return e!==t&&(Md.set(t,e),bf.set(e,t)),e}const Ud=t=>bf.get(t);function wI(t,e,{blocked:n,upgrade:r,blocking:a,terminated:i}={}){const o=indexedDB.open(t,e),l=ss(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ss(o.result),u.oldVersion,u.newVersion,ss(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),a&&u.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const jI=["get","getKey","getAll","getAllKeys","count"],_I=["put","add","delete","clear"],Fd=new Map;function Qv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fd.get(e))return Fd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=_I.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||jI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,a?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),a&&u.done]))[0]};return Fd.set(e,i),i}vI(t=>({...t,get:(e,n,r)=>Qv(e,n)||t.get(e,n,r),has:(e,n)=>!!Qv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(bI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function bI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Jh="@firebase/app",Zv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=new Nf("@firebase/app"),kI="@firebase/app-compat",TI="@firebase/analytics-compat",EI="@firebase/analytics",II="@firebase/app-check-compat",SI="@firebase/app-check",CI="@firebase/auth",PI="@firebase/auth-compat",RI="@firebase/database",AI="@firebase/data-connect",DI="@firebase/database-compat",zI="@firebase/functions",LI="@firebase/functions-compat",OI="@firebase/installations",VI="@firebase/installations-compat",MI="@firebase/messaging",UI="@firebase/messaging-compat",FI="@firebase/performance",BI="@firebase/performance-compat",$I="@firebase/remote-config",qI="@firebase/remote-config-compat",WI="@firebase/storage",HI="@firebase/storage-compat",KI="@firebase/firestore",GI="@firebase/vertexai-preview",QI="@firebase/firestore-compat",ZI="firebase",JI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="[DEFAULT]",YI={[Jh]:"fire-core",[kI]:"fire-core-compat",[EI]:"fire-analytics",[TI]:"fire-analytics-compat",[SI]:"fire-app-check",[II]:"fire-app-check-compat",[CI]:"fire-auth",[PI]:"fire-auth-compat",[RI]:"fire-rtdb",[AI]:"fire-data-connect",[DI]:"fire-rtdb-compat",[zI]:"fire-fn",[LI]:"fire-fn-compat",[OI]:"fire-iid",[VI]:"fire-iid-compat",[MI]:"fire-fcm",[UI]:"fire-fcm-compat",[FI]:"fire-perf",[BI]:"fire-perf-compat",[$I]:"fire-rc",[qI]:"fire-rc-compat",[WI]:"fire-gcs",[HI]:"fire-gcs-compat",[KI]:"fire-fst",[QI]:"fire-fst-compat",[GI]:"fire-vertex","fire-js":"fire-js",[ZI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc=new Map,XI=new Map,Xh=new Map;function Jv(t,e){try{t.container.addComponent(e)}catch(n){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function qs(t){const e=t.name;if(Xh.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;Xh.set(e,t);for(const n of Bc.values())Jv(n,t);for(const n of XI.values())Jv(n,t);return!0}function bu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Dn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},as=new Ko("app","Firebase",eS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw as.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=JI;function Yj(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Yh,automaticDataCollectionEnabled:!1},e),a=r.name;if(typeof a!="string"||!a)throw as.create("bad-app-name",{appName:String(a)});if(n||(n=Kj()),!n)throw as.create("no-options");const i=Bc.get(a);if(i){if(Fc(n,i.options)&&Fc(r,i.config))return i;throw as.create("duplicate-app",{appName:a})}const o=new oI(a);for(const u of Xh.values())o.addComponent(u);const l=new tS(n,r,o);return Bc.set(a,l),l}function kf(t=Yh){const e=Bc.get(t);if(!e&&t===Yh&&Kj())return Yj();if(!e)throw as.create("no-app",{appName:t});return e}function Jn(t,e,n){var r;let a=(r=YI[t])!==null&&r!==void 0?r:t;n&&(a+=`-${n}`);const i=a.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${a}" with version "${e}":`];i&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(l.join(" "));return}qs(new cs(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="firebase-heartbeat-database",rS=1,Po="firebase-heartbeat-store";let Bd=null;function Xj(){return Bd||(Bd=wI(nS,rS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Po)}catch(n){console.warn(n)}}}}).catch(t=>{throw as.create("idb-open",{originalErrorMessage:t.message})})),Bd}async function sS(t){try{const n=(await Xj()).transaction(Po),r=await n.objectStore(Po).get(e0(t));return await n.done,r}catch(e){if(e instanceof or)Tr.warn(e.message);else{const n=as.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Tr.warn(n.message)}}}async function Yv(t,e){try{const r=(await Xj()).transaction(Po,"readwrite");await r.objectStore(Po).put(e,e0(t)),await r.done}catch(n){if(n instanceof or)Tr.warn(n.message);else{const r=as.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Tr.warn(r.message)}}}function e0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=1024,iS=30*24*60*60*1e3;class oS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new cS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Xv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=iS}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Tr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Xv(),{heartbeatsToSend:r,unsentEntries:a}=lS(this._heartbeatsCache.heartbeats),i=Uc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Tr.warn(n),""}}}function Xv(){return new Date().toISOString().substring(0,10)}function lS(t,e=aS){const n=[];let r=t.slice();for(const a of t){const i=n.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),ey(n)>e){i.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),ey(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class cS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QE()?ZE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await sS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return Yv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return Yv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function ey(t){return Uc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t){qs(new cs("platform-logger",e=>new NI(e),"PRIVATE")),qs(new cs("heartbeat",e=>new oS(e),"PRIVATE")),Jn(Jh,Zv,t),Jn(Jh,Zv,"esm2017"),Jn("fire-js","")}uS("");function Tf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function t0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dS=t0,n0=new Ko("auth","Firebase",t0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=new Nf("@firebase/auth");function hS(t,...e){$c.logLevel<=Ae.WARN&&$c.warn(`Auth (${Xs}): ${t}`,...e)}function ac(t,...e){$c.logLevel<=Ae.ERROR&&$c.error(`Auth (${Xs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(t,...e){throw If(t,...e)}function On(t,...e){return If(t,...e)}function Ef(t,e,n){const r=Object.assign(Object.assign({},dS()),{[e]:n});return new Ko("auth","Firebase",r).create(e,{appName:t.name})}function wr(t){return Ef(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pS(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Tn(t,"argument-error"),Ef(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function If(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return n0.create(t,...e)}function we(t,e,...n){if(!t)throw If(e,...n)}function gr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ac(e),new Error(e)}function Er(t,e){t||gr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function fS(){return ty()==="http:"||ty()==="https:"}function ty(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fS()||WE()||"connection"in navigator)?navigator.onLine:!0}function gS(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,n){this.shortDelay=e,this.longDelay=n,Er(n>e,"Short delay should be less than long delay!"),this.isMobile=BE()||HE()}get(){return mS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t,e){Er(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=new Qo(3e4,6e4);function ys(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Pr(t,e,n,r,a={}){return s0(t,a,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Go(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return qE()||(d.referrerPolicy="no-referrer"),r0.fetch()(a0(t,t.config.apiHost,n,l),d)})}async function s0(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},vS),e);try{const a=new wS(t),i=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ul(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ul(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ul(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ul(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Ef(t,h,d);Tn(t,h)}}catch(a){if(a instanceof or)throw a;Tn(t,"network-request-failed",{message:String(a)})}}async function Zo(t,e,n,r,a={}){const i=await Pr(t,e,n,r,a);return"mfaPendingCredential"in i&&Tn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function a0(t,e,n,r){const a=`${e}${n}?${r}`;return t.config.emulator?Sf(t.config,a):`${t.config.apiScheme}://${a}`}function xS(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wS{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(On(this.auth,"network-request-failed")),yS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ul(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=On(t,e,r);return a.customData._tokenResponse=n,a}function ny(t){return t!==void 0&&t.enterprise!==void 0}class jS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return xS(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function _S(t,e){return Pr(t,"GET","/v2/recaptchaConfig",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(t,e){return Pr(t,"POST","/v1/accounts:delete",e)}async function i0(t,e){return Pr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bS(t,e=!1){const n=tt(t),r=await n.getIdToken(e),a=Cf(r);we(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:ao($d(a.auth_time)),issuedAtTime:ao($d(a.iat)),expirationTime:ao($d(a.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function $d(t){return Number(t)*1e3}function Cf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ac("JWT malformed, contained fewer than 3 sections"),null;try{const a=qj(n);return a?JSON.parse(a):(ac("Failed to decode base64 JWT payload"),null)}catch(a){return ac("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function ry(t){const e=Cf(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ga(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof or&&kS(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function kS({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const a=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ao(this.lastLoginAt),this.creationTime=ao(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qc(t){var e;const n=t.auth,r=await t.getIdToken(),a=await Ga(t,i0(n,{idToken:r}));we(a==null?void 0:a.users.length,n,"internal-error");const i=a.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?o0(i.providerUserInfo):[],l=IS(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?d:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new tp(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function ES(t){const e=tt(t);await qc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IS(t,e){return[...t.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function o0(t){return t.map(e=>{var{providerId:n}=e,r=Tf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SS(t,e){const n=await s0(t,{},async()=>{const r=Go({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,o=a0(t,a,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",r0.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function CS(t,e){return Pr(t,"POST","/v2/accounts:revokeToken",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ry(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){we(e.length!==0,"internal-error");const n=ry(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:a,expiresIn:i}=await SS(e,n);this.updateTokensAndExpiration(r,a,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:a,expirationTime:i}=n,o=new Da;return r&&(we(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),a&&(we(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),i&&(we(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Da,this.toJSON())}_performRefresh(){return gr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vr{constructor(e){var{uid:n,auth:r,stsTokenManager:a}=e,i=Tf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new TS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new tp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ga(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bS(this,e)}reload(){return ES(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await qc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dn(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await Ga(this,NS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,a,i,o,l,u,d,h;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(a=n.email)!==null&&a!==void 0?a:void 0,_=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,x=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,v=(d=n.createdAt)!==null&&d!==void 0?d:void 0,j=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:R,isAnonymous:L,providerData:U,stsTokenManager:N}=n;we(S&&N,e,"internal-error");const y=Da.fromJSON(this.name,N);we(typeof S=="string",e,"internal-error"),Lr(f,e.name),Lr(m,e.name),we(typeof R=="boolean",e,"internal-error"),we(typeof L=="boolean",e,"internal-error"),Lr(_,e.name),Lr(E,e.name),Lr(w,e.name),Lr(x,e.name),Lr(v,e.name),Lr(j,e.name);const k=new vr({uid:S,auth:e,email:m,emailVerified:R,displayName:f,isAnonymous:L,photoURL:E,phoneNumber:_,tenantId:w,stsTokenManager:y,createdAt:v,lastLoginAt:j});return U&&Array.isArray(U)&&(k.providerData=U.map(b=>Object.assign({},b))),x&&(k._redirectEventId=x),k}static async _fromIdTokenResponse(e,n,r=!1){const a=new Da;a.updateFromServerResponse(n);const i=new vr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await qc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const a=n.users[0];we(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?o0(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(i!=null&&i.length),l=new Da;l.updateFromIdToken(r);const u=new vr({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new tp(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy=new Map;function yr(t){Er(t instanceof Function,"Expected a class definition");let e=sy.get(t);return e?(Er(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}l0.type="NONE";const ay=l0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(t,e,n){return`firebase:${t}:${e}:${n}`}class za{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:a,name:i}=this.auth;this.fullUserKey=ic(this.userKey,a.apiKey,i),this.fullPersistenceKey=ic("persistence",a.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?vr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new za(yr(ay),e,r);const a=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=a[0]||yr(ay);const o=ic(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const f=vr._fromJSON(e,h);d!==i&&(l=f),i=d;break}}catch{}const u=a.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new za(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new za(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(h0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(f0(e))return"Blackberry";if(m0(e))return"Webos";if(u0(e))return"Safari";if((e.includes("chrome/")||d0(e))&&!e.includes("edge/"))return"Chrome";if(p0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function c0(t=Wt()){return/firefox\//i.test(t)}function u0(t=Wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function d0(t=Wt()){return/crios\//i.test(t)}function h0(t=Wt()){return/iemobile/i.test(t)}function p0(t=Wt()){return/android/i.test(t)}function f0(t=Wt()){return/blackberry/i.test(t)}function m0(t=Wt()){return/webos/i.test(t)}function Pf(t=Wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function PS(t=Wt()){var e;return Pf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function RS(){return KE()&&document.documentMode===10}function g0(t=Wt()){return Pf(t)||p0(t)||m0(t)||f0(t)||/windows phone/i.test(t)||h0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e=[]){let n;switch(t){case"Browser":n=iy(Wt());break;case"Worker":n=`${iy(Wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Xs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DS(t,e={}){return Pr(t,"GET","/v2/passwordPolicy",ys(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=6;class LS{constructor(e){var n,r,a,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:zS,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,a,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(a=u.containsLowercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n,r,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oy(this),this.idTokenSubscription=new oy(this),this.beforeStateQueue=new AS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=yr(n)),this._initializationPromise=this.queue(async()=>{var r,a;if(!this._deleted&&(this.persistenceManager=await za.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await i0(this,{idToken:e}),r=await vr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Dn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=a==null?void 0:a._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(a=u.user,i=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await qc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dn(this.app))return Promise.reject(wr(this));const n=e?tt(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dn(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dn(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(yr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DS(this),n=new LS(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ko("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await CS(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&yr(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await za.create(this,[yr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,a){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,a);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=v0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(n["X-Firebase-AppCheck"]=a),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&hS(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function xs(t){return tt(t)}class oy{constructor(e){this.auth=e,this.observer=null,this.addObserver=tI(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ku={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VS(t){ku=t}function y0(t){return ku.loadJS(t)}function MS(){return ku.recaptchaEnterpriseScript}function US(){return ku.gapiScript}function FS(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const BS="recaptcha-enterprise",$S="NO_RECAPTCHA";class qS{constructor(e){this.type=BS,this.auth=xs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{_S(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new jS(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function a(i,o,l){const u=window.grecaptcha;ny(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o($S)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&ny(window.grecaptcha))a(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=MS();u.length!==0&&(u+=l),y0(u).then(()=>{a(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function ly(t,e,n,r=!1){const a=new qS(t);let i;try{i=await a.verify(n)}catch{i=await a.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function np(t,e,n,r){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await ly(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ly(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(t,e){const n=bu(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),i=n.getOptions();if(Fc(i,e??{}))return a;Tn(a,"already-initialized")}return n.initialize({options:e})}function HS(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(yr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function KS(t,e,n){const r=xs(t);we(r._canInitEmulator,r,"emulator-config-failed"),we(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,i=x0(e),{host:o,port:l}=GS(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})}),QS()}function x0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function GS(t){const e=x0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const i=a[1];return{host:i,port:cy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:cy(o)}}}function cy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function QS(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return gr("not implemented")}_getIdTokenResponse(e){return gr("not implemented")}_linkToIdToken(e,n){return gr("not implemented")}_getReauthenticationResolver(e){return gr("not implemented")}}async function ZS(t,e){return Pr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JS(t,e){return Zo(t,"POST","/v1/accounts:signInWithPassword",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YS(t,e){return Zo(t,"POST","/v1/accounts:signInWithEmailLink",ys(t,e))}async function XS(t,e){return Zo(t,"POST","/v1/accounts:signInWithEmailLink",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends Rf{constructor(e,n,r,a=null){super("password",r),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Ro(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ro(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return np(e,n,"signInWithPassword",JS);case"emailLink":return YS(e,{email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return np(e,r,"signUpPassword",ZS);case"emailLink":return XS(e,{idToken:n,email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function La(t,e){return Zo(t,"POST","/v1/accounts:signInWithIdp",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="http://localhost";class Ws extends Rf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ws(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Tn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=n,i=Tf(n,["providerId","signInMethod"]);if(!r||!a)return null;const o=new Ws(r,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return La(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,La(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,La(e,n)}buildRequest(){const e={requestUri:eC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Go(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nC(t){const e=qi(Wi(t)).link,n=e?qi(Wi(e)).deep_link_id:null,r=qi(Wi(t)).deep_link_id;return(r?qi(Wi(r)).link:null)||r||n||e||t}class Af{constructor(e){var n,r,a,i,o,l;const u=qi(Wi(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,h=(r=u.oobCode)!==null&&r!==void 0?r:null,f=tC((a=u.mode)!==null&&a!==void 0?a:null);we(d&&h&&f,"argument-error"),this.apiKey=d,this.operation=f,this.code=h,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=nC(e);try{return new Af(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(){this.providerId=li.PROVIDER_ID}static credential(e,n){return Ro._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Af.parseLink(n);return we(r,"argument-error"),Ro._fromEmailAndCode(e,r.code,r.tenantId)}}li.PROVIDER_ID="password";li.EMAIL_PASSWORD_SIGN_IN_METHOD="password";li.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends Df{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends Jo{constructor(){super("facebook.com")}static credential(e){return Ws._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fr.credential(e.oauthAccessToken)}catch{return null}}}Fr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends Jo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ws._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return pr.credential(n,r)}catch{return null}}}pr.GOOGLE_SIGN_IN_METHOD="google.com";pr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends Jo{constructor(){super("github.com")}static credential(e){return Ws._fromParams({providerId:Br.PROVIDER_ID,signInMethod:Br.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Br.credentialFromTaggedObject(e)}static credentialFromError(e){return Br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Br.credential(e.oauthAccessToken)}catch{return null}}}Br.GITHUB_SIGN_IN_METHOD="github.com";Br.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r extends Jo{constructor(){super("twitter.com")}static credential(e,n){return Ws._fromParams({providerId:$r.PROVIDER_ID,signInMethod:$r.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return $r.credentialFromTaggedObject(e)}static credentialFromError(e){return $r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return $r.credential(n,r)}catch{return null}}}$r.TWITTER_SIGN_IN_METHOD="twitter.com";$r.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rC(t,e){return Zo(t,"POST","/v1/accounts:signUp",ys(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,a=!1){const i=await vr._fromIdTokenResponse(e,r,a),o=uy(r);return new Hs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const a=uy(r);return new Hs({user:e,providerId:a,_tokenResponse:r,operationType:n})}}function uy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc extends or{constructor(e,n,r,a){var i;super(n.code,n.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Wc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,a){return new Wc(e,n,r,a)}}function w0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wc._fromErrorAndOperation(t,i,e,r):i})}async function sC(t,e,n=!1){const r=await Ga(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Hs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aC(t,e,n=!1){const{auth:r}=t;if(Dn(r.app))return Promise.reject(wr(r));const a="reauthenticate";try{const i=await Ga(t,w0(r,a,e,t),n);we(i.idToken,r,"internal-error");const o=Cf(i.idToken);we(o,r,"internal-error");const{sub:l}=o;return we(t.uid===l,r,"user-mismatch"),Hs._forOperation(t,a,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Tn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j0(t,e,n=!1){if(Dn(t.app))return Promise.reject(wr(t));const r="signIn",a=await w0(t,r,e),i=await Hs._fromIdTokenResponse(t,r,a);return n||await t._updateCurrentUser(i.user),i}async function iC(t,e){return j0(xs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _0(t){const e=xs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function oC(t,e,n){if(Dn(t.app))return Promise.reject(wr(t));const r=xs(t),o=await np(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&_0(t),u}),l=await Hs._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function lC(t,e,n){return Dn(t.app)?Promise.reject(wr(t)):iC(tt(t),li.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&_0(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cC(t,e){return Pr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uC(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=tt(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ga(r,cC(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function dC(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function hC(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function pC(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function zf(t){return tt(t).signOut()}const Hc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Hc,"1"),this.storage.removeItem(Hc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=1e3,mC=10;class b0 extends N0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),a=this.localCache[n];r!==a&&e(n,a,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);RS()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,mC):a()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},fC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}b0.type="LOCAL";const gC=b0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0 extends N0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}k0.type="SESSION";const T0=k0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const r=new Tu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:a,data:i}=n.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await vC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=Lf("",20);a.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:a,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(){return window}function xC(t){Yn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(){return typeof Yn().WorkerGlobalScope<"u"&&typeof Yn().importScripts=="function"}async function wC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _C(){return E0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="firebaseLocalStorageDb",NC=1,Kc="firebaseLocalStorage",S0="fbase_key";class Yo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Eu(t,e){return t.transaction([Kc],e?"readwrite":"readonly").objectStore(Kc)}function bC(){const t=indexedDB.deleteDatabase(I0);return new Yo(t).toPromise()}function rp(){const t=indexedDB.open(I0,NC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Kc,{keyPath:S0})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Kc)?e(r):(r.close(),await bC(),e(await rp()))})})}async function dy(t,e,n){const r=Eu(t,!0).put({[S0]:e,value:n});return new Yo(r).toPromise()}async function kC(t,e){const n=Eu(t,!1).get(e),r=await new Yo(n).toPromise();return r===void 0?null:r.value}function hy(t,e){const n=Eu(t,!0).delete(e);return new Yo(n).toPromise()}const TC=800,EC=3;class C0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>EC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return E0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tu._getInstance(_C()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await wC(),!this.activeServiceWorker)return;this.sender=new yC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rp();return await dy(e,Hc,"1"),await hy(e,Hc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>kC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>hy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=Eu(a,!1).getAll();return new Yo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}C0.type="LOCAL";const IC=C0;new Qo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t,e){return e?yr(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of extends Rf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return La(e,this._buildIdpRequest())}_linkToIdToken(e,n){return La(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return La(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function SC(t){return j0(t.auth,new Of(t),t.bypassAuthState)}function CC(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),aC(n,new Of(t),t.bypassAuthState)}async function PC(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),sC(n,new Of(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,n,r,a,i=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:a,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SC;case"linkViaPopup":case"linkViaRedirect":return PC;case"reauthViaPopup":case"reauthViaRedirect":return CC;default:Tn(this.auth,"internal-error")}}resolve(e){Er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=new Qo(2e3,1e4);async function AC(t,e,n){if(Dn(t.app))return Promise.reject(On(t,"operation-not-supported-in-this-environment"));const r=xs(t);pS(t,e,Df);const a=P0(r,n);return new As(r,"signInViaPopup",e,a).executeNotNull()}class As extends R0{constructor(e,n,r,a,i){super(e,n,a,i),this.provider=r,this.authWindow=null,this.pollId=null,As.currentPopupAction&&As.currentPopupAction.cancel(),As.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Er(this.filter.length===1,"Popup operations only handle one event");const e=Lf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(On(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(On(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,As.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(On(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,RC.get())};e()}}As.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC="pendingRedirect",oc=new Map;class zC extends R0{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=oc.get(this.auth._key());if(!e){try{const r=await LC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}oc.set(this.auth._key(),e)}return this.bypassAuthState||oc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LC(t,e){const n=MC(e),r=VC(t);if(!await r._isAvailable())return!1;const a=await r._get(n)==="true";return await r._remove(n),a}function OC(t,e){oc.set(t._key(),e)}function VC(t){return yr(t._redirectPersistence)}function MC(t){return ic(DC,t.config.apiKey,t.name)}async function UC(t,e,n=!1){if(Dn(t.app))return Promise.reject(wr(t));const r=xs(t),a=P0(r,e),o=await new zC(r,a,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=10*60*1e3;class BC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$C(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!A0(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(On(this.auth,a))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FC&&this.cachedEventUids.clear(),this.cachedEventUids.has(py(e))}saveEventToCache(e){this.cachedEventUids.add(py(e)),this.lastProcessedEventTime=Date.now()}}function py(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function A0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $C(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return A0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qC(t,e={}){return Pr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HC=/^https?/;async function KC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await qC(t);for(const n of e)try{if(GC(n))return}catch{}Tn(t,"unauthorized-domain")}function GC(t){const e=ep(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!HC.test(n))return!1;if(WC.test(t))return r===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=new Qo(3e4,6e4);function fy(){const t=Yn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ZC(t){return new Promise((e,n)=>{var r,a,i;function o(){fy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fy(),n(On(t,"network-request-failed"))},timeout:QC.get()})}if(!((a=(r=Yn().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((i=Yn().gapi)===null||i===void 0)&&i.load)o();else{const l=FS("iframefcb");return Yn()[l]=()=>{gapi.load?o():n(On(t,"network-request-failed"))},y0(`${US()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw lc=null,e})}let lc=null;function JC(t){return lc=lc||ZC(t),lc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new Qo(5e3,15e3),XC="__/auth/iframe",e1="emulator/auth/iframe",t1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function r1(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Sf(e,e1):`https://${t.config.authDomain}/${XC}`,r={apiKey:e.apiKey,appName:t.name,v:Xs},a=n1.get(t.config.apiHost);a&&(r.eid=a);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Go(r).slice(1)}`}async function s1(t){const e=await JC(t),n=Yn().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:r1(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t1,dontclear:!0},r=>new Promise(async(a,i)=>{await r.restyle({setHideOnLeave:!1});const o=On(t,"network-request-failed"),l=Yn().setTimeout(()=>{i(o)},YC.get());function u(){Yn().clearTimeout(l),a(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},i1=500,o1=600,l1="_blank",c1="http://localhost";class my{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u1(t,e,n,r=i1,a=o1){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},a1),{width:r.toString(),height:a.toString(),top:i,left:o}),d=Wt().toLowerCase();n&&(l=d0(d)?l1:n),c0(d)&&(e=e||c1,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[_,E])=>`${m}${_}=${E},`,"");if(PS(d)&&l!=="_self")return d1(e||"",l),new my(null);const f=window.open(e||"",l,h);we(f,t,"popup-blocked");try{f.focus()}catch{}return new my(f)}function d1(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="__/auth/handler",p1="emulator/auth/handler",f1=encodeURIComponent("fac");async function gy(t,e,n,r,a,i){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Xs,eventId:a};if(e instanceof Df){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",eI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Jo){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${f1}=${encodeURIComponent(u)}`:"";return`${m1(t)}?${Go(l).slice(1)}${d}`}function m1({config:t}){return t.emulator?Sf(t,p1):`https://${t.authDomain}/${h1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="webStorageSupport";class g1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=T0,this._completeRedirectFn=UC,this._overrideRedirectResult=OC}async _openPopup(e,n,r,a){var i;Er((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await gy(e,n,r,ep(),a);return u1(e,o,Lf())}async _openRedirect(e,n,r,a){await this._originValidation(e);const i=await gy(e,n,r,ep(),a);return xC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:i}=this.eventManagers[n];return a?Promise.resolve(a):(Er(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await s1(e),r=new BC(e);return n.register("authEvent",a=>(we(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(qd,{type:qd},a=>{var i;const o=(i=a==null?void 0:a[0])===null||i===void 0?void 0:i[qd];o!==void 0&&n(!!o),Tn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=KC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return g0()||u0()||Pf()}}const v1=g1;var vy="@firebase/auth",yy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function w1(t){qs(new cs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:v0(t)},d=new OS(r,a,i,u);return HS(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),qs(new cs("auth-internal",e=>{const n=xs(e.getProvider("auth").getImmediate());return(r=>new y1(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jn(vy,yy,x1(t)),Jn(vy,yy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=5*60,_1=Gj("authIdTokenMaxAge")||j1;let xy=null;const N1=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_1)return;const a=n==null?void 0:n.token;xy!==a&&(xy=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function b1(t=kf()){const e=bu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=WS(t,{popupRedirectResolver:v1,persistence:[IC,gC,T0]}),r=Gj("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=N1(i.toString());hC(n,o,()=>o(n.currentUser)),dC(n,l=>o(l))}}const a=Wj("auth");return a&&KS(n,`http://${a}`),n}function k1(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}VS({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=a=>{const i=On("internal-error");i.customData=a,n(i)},r.type="text/javascript",r.charset="UTF-8",k1().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});w1("Browser");var T1="firebase",E1="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jn(T1,E1,"app");var wy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Os,D0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,y){function k(){}k.prototype=y.prototype,N.D=y.prototype,N.prototype=new k,N.prototype.constructor=N,N.C=function(b,A,z){for(var T=Array(arguments.length-2),$=2;$<arguments.length;$++)T[$-2]=arguments[$];return y.prototype[A].apply(b,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,y,k){k||(k=0);var b=Array(16);if(typeof y=="string")for(var A=0;16>A;++A)b[A]=y.charCodeAt(k++)|y.charCodeAt(k++)<<8|y.charCodeAt(k++)<<16|y.charCodeAt(k++)<<24;else for(A=0;16>A;++A)b[A]=y[k++]|y[k++]<<8|y[k++]<<16|y[k++]<<24;y=N.g[0],k=N.g[1],A=N.g[2];var z=N.g[3],T=y+(z^k&(A^z))+b[0]+3614090360&4294967295;y=k+(T<<7&4294967295|T>>>25),T=z+(A^y&(k^A))+b[1]+3905402710&4294967295,z=y+(T<<12&4294967295|T>>>20),T=A+(k^z&(y^k))+b[2]+606105819&4294967295,A=z+(T<<17&4294967295|T>>>15),T=k+(y^A&(z^y))+b[3]+3250441966&4294967295,k=A+(T<<22&4294967295|T>>>10),T=y+(z^k&(A^z))+b[4]+4118548399&4294967295,y=k+(T<<7&4294967295|T>>>25),T=z+(A^y&(k^A))+b[5]+1200080426&4294967295,z=y+(T<<12&4294967295|T>>>20),T=A+(k^z&(y^k))+b[6]+2821735955&4294967295,A=z+(T<<17&4294967295|T>>>15),T=k+(y^A&(z^y))+b[7]+4249261313&4294967295,k=A+(T<<22&4294967295|T>>>10),T=y+(z^k&(A^z))+b[8]+1770035416&4294967295,y=k+(T<<7&4294967295|T>>>25),T=z+(A^y&(k^A))+b[9]+2336552879&4294967295,z=y+(T<<12&4294967295|T>>>20),T=A+(k^z&(y^k))+b[10]+4294925233&4294967295,A=z+(T<<17&4294967295|T>>>15),T=k+(y^A&(z^y))+b[11]+2304563134&4294967295,k=A+(T<<22&4294967295|T>>>10),T=y+(z^k&(A^z))+b[12]+1804603682&4294967295,y=k+(T<<7&4294967295|T>>>25),T=z+(A^y&(k^A))+b[13]+4254626195&4294967295,z=y+(T<<12&4294967295|T>>>20),T=A+(k^z&(y^k))+b[14]+2792965006&4294967295,A=z+(T<<17&4294967295|T>>>15),T=k+(y^A&(z^y))+b[15]+1236535329&4294967295,k=A+(T<<22&4294967295|T>>>10),T=y+(A^z&(k^A))+b[1]+4129170786&4294967295,y=k+(T<<5&4294967295|T>>>27),T=z+(k^A&(y^k))+b[6]+3225465664&4294967295,z=y+(T<<9&4294967295|T>>>23),T=A+(y^k&(z^y))+b[11]+643717713&4294967295,A=z+(T<<14&4294967295|T>>>18),T=k+(z^y&(A^z))+b[0]+3921069994&4294967295,k=A+(T<<20&4294967295|T>>>12),T=y+(A^z&(k^A))+b[5]+3593408605&4294967295,y=k+(T<<5&4294967295|T>>>27),T=z+(k^A&(y^k))+b[10]+38016083&4294967295,z=y+(T<<9&4294967295|T>>>23),T=A+(y^k&(z^y))+b[15]+3634488961&4294967295,A=z+(T<<14&4294967295|T>>>18),T=k+(z^y&(A^z))+b[4]+3889429448&4294967295,k=A+(T<<20&4294967295|T>>>12),T=y+(A^z&(k^A))+b[9]+568446438&4294967295,y=k+(T<<5&4294967295|T>>>27),T=z+(k^A&(y^k))+b[14]+3275163606&4294967295,z=y+(T<<9&4294967295|T>>>23),T=A+(y^k&(z^y))+b[3]+4107603335&4294967295,A=z+(T<<14&4294967295|T>>>18),T=k+(z^y&(A^z))+b[8]+1163531501&4294967295,k=A+(T<<20&4294967295|T>>>12),T=y+(A^z&(k^A))+b[13]+2850285829&4294967295,y=k+(T<<5&4294967295|T>>>27),T=z+(k^A&(y^k))+b[2]+4243563512&4294967295,z=y+(T<<9&4294967295|T>>>23),T=A+(y^k&(z^y))+b[7]+1735328473&4294967295,A=z+(T<<14&4294967295|T>>>18),T=k+(z^y&(A^z))+b[12]+2368359562&4294967295,k=A+(T<<20&4294967295|T>>>12),T=y+(k^A^z)+b[5]+4294588738&4294967295,y=k+(T<<4&4294967295|T>>>28),T=z+(y^k^A)+b[8]+2272392833&4294967295,z=y+(T<<11&4294967295|T>>>21),T=A+(z^y^k)+b[11]+1839030562&4294967295,A=z+(T<<16&4294967295|T>>>16),T=k+(A^z^y)+b[14]+4259657740&4294967295,k=A+(T<<23&4294967295|T>>>9),T=y+(k^A^z)+b[1]+2763975236&4294967295,y=k+(T<<4&4294967295|T>>>28),T=z+(y^k^A)+b[4]+1272893353&4294967295,z=y+(T<<11&4294967295|T>>>21),T=A+(z^y^k)+b[7]+4139469664&4294967295,A=z+(T<<16&4294967295|T>>>16),T=k+(A^z^y)+b[10]+3200236656&4294967295,k=A+(T<<23&4294967295|T>>>9),T=y+(k^A^z)+b[13]+681279174&4294967295,y=k+(T<<4&4294967295|T>>>28),T=z+(y^k^A)+b[0]+3936430074&4294967295,z=y+(T<<11&4294967295|T>>>21),T=A+(z^y^k)+b[3]+3572445317&4294967295,A=z+(T<<16&4294967295|T>>>16),T=k+(A^z^y)+b[6]+76029189&4294967295,k=A+(T<<23&4294967295|T>>>9),T=y+(k^A^z)+b[9]+3654602809&4294967295,y=k+(T<<4&4294967295|T>>>28),T=z+(y^k^A)+b[12]+3873151461&4294967295,z=y+(T<<11&4294967295|T>>>21),T=A+(z^y^k)+b[15]+530742520&4294967295,A=z+(T<<16&4294967295|T>>>16),T=k+(A^z^y)+b[2]+3299628645&4294967295,k=A+(T<<23&4294967295|T>>>9),T=y+(A^(k|~z))+b[0]+4096336452&4294967295,y=k+(T<<6&4294967295|T>>>26),T=z+(k^(y|~A))+b[7]+1126891415&4294967295,z=y+(T<<10&4294967295|T>>>22),T=A+(y^(z|~k))+b[14]+2878612391&4294967295,A=z+(T<<15&4294967295|T>>>17),T=k+(z^(A|~y))+b[5]+4237533241&4294967295,k=A+(T<<21&4294967295|T>>>11),T=y+(A^(k|~z))+b[12]+1700485571&4294967295,y=k+(T<<6&4294967295|T>>>26),T=z+(k^(y|~A))+b[3]+2399980690&4294967295,z=y+(T<<10&4294967295|T>>>22),T=A+(y^(z|~k))+b[10]+4293915773&4294967295,A=z+(T<<15&4294967295|T>>>17),T=k+(z^(A|~y))+b[1]+2240044497&4294967295,k=A+(T<<21&4294967295|T>>>11),T=y+(A^(k|~z))+b[8]+1873313359&4294967295,y=k+(T<<6&4294967295|T>>>26),T=z+(k^(y|~A))+b[15]+4264355552&4294967295,z=y+(T<<10&4294967295|T>>>22),T=A+(y^(z|~k))+b[6]+2734768916&4294967295,A=z+(T<<15&4294967295|T>>>17),T=k+(z^(A|~y))+b[13]+1309151649&4294967295,k=A+(T<<21&4294967295|T>>>11),T=y+(A^(k|~z))+b[4]+4149444226&4294967295,y=k+(T<<6&4294967295|T>>>26),T=z+(k^(y|~A))+b[11]+3174756917&4294967295,z=y+(T<<10&4294967295|T>>>22),T=A+(y^(z|~k))+b[2]+718787259&4294967295,A=z+(T<<15&4294967295|T>>>17),T=k+(z^(A|~y))+b[9]+3951481745&4294967295,N.g[0]=N.g[0]+y&4294967295,N.g[1]=N.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,N.g[2]=N.g[2]+A&4294967295,N.g[3]=N.g[3]+z&4294967295}r.prototype.u=function(N,y){y===void 0&&(y=N.length);for(var k=y-this.blockSize,b=this.B,A=this.h,z=0;z<y;){if(A==0)for(;z<=k;)a(this,N,z),z+=this.blockSize;if(typeof N=="string"){for(;z<y;)if(b[A++]=N.charCodeAt(z++),A==this.blockSize){a(this,b),A=0;break}}else for(;z<y;)if(b[A++]=N[z++],A==this.blockSize){a(this,b),A=0;break}}this.h=A,this.o+=y},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var y=1;y<N.length-8;++y)N[y]=0;var k=8*this.o;for(y=N.length-8;y<N.length;++y)N[y]=k&255,k/=256;for(this.u(N),N=Array(16),y=k=0;4>y;++y)for(var b=0;32>b;b+=8)N[k++]=this.g[y]>>>b&255;return N};function i(N,y){var k=l;return Object.prototype.hasOwnProperty.call(k,N)?k[N]:k[N]=y(N)}function o(N,y){this.h=y;for(var k=[],b=!0,A=N.length-1;0<=A;A--){var z=N[A]|0;b&&z==y||(k[A]=z,b=!1)}this.g=k}var l={};function u(N){return-128<=N&&128>N?i(N,function(y){return new o([y|0],0>y?-1:0)}):new o([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return f;if(0>N)return x(d(-N));for(var y=[],k=1,b=0;N>=k;b++)y[b]=N/k|0,k*=4294967296;return new o(y,0)}function h(N,y){if(N.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(N.charAt(0)=="-")return x(h(N.substring(1),y));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=d(Math.pow(y,8)),b=f,A=0;A<N.length;A+=8){var z=Math.min(8,N.length-A),T=parseInt(N.substring(A,A+z),y);8>z?(z=d(Math.pow(y,z)),b=b.j(z).add(d(T))):(b=b.j(k),b=b.add(d(T)))}return b}var f=u(0),m=u(1),_=u(16777216);t=o.prototype,t.m=function(){if(w(this))return-x(this).m();for(var N=0,y=1,k=0;k<this.g.length;k++){var b=this.i(k);N+=(0<=b?b:4294967296+b)*y,y*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(E(this))return"0";if(w(this))return"-"+x(this).toString(N);for(var y=d(Math.pow(N,6)),k=this,b="";;){var A=R(k,y).g;k=v(k,A.j(y));var z=((0<k.g.length?k.g[0]:k.h)>>>0).toString(N);if(k=A,E(k))return z+b;for(;6>z.length;)z="0"+z;b=z+b}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function E(N){if(N.h!=0)return!1;for(var y=0;y<N.g.length;y++)if(N.g[y]!=0)return!1;return!0}function w(N){return N.h==-1}t.l=function(N){return N=v(this,N),w(N)?-1:E(N)?0:1};function x(N){for(var y=N.g.length,k=[],b=0;b<y;b++)k[b]=~N.g[b];return new o(k,~N.h).add(m)}t.abs=function(){return w(this)?x(this):this},t.add=function(N){for(var y=Math.max(this.g.length,N.g.length),k=[],b=0,A=0;A<=y;A++){var z=b+(this.i(A)&65535)+(N.i(A)&65535),T=(z>>>16)+(this.i(A)>>>16)+(N.i(A)>>>16);b=T>>>16,z&=65535,T&=65535,k[A]=T<<16|z}return new o(k,k[k.length-1]&-2147483648?-1:0)};function v(N,y){return N.add(x(y))}t.j=function(N){if(E(this)||E(N))return f;if(w(this))return w(N)?x(this).j(x(N)):x(x(this).j(N));if(w(N))return x(this.j(x(N)));if(0>this.l(_)&&0>N.l(_))return d(this.m()*N.m());for(var y=this.g.length+N.g.length,k=[],b=0;b<2*y;b++)k[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<N.g.length;A++){var z=this.i(b)>>>16,T=this.i(b)&65535,$=N.i(A)>>>16,Q=N.i(A)&65535;k[2*b+2*A]+=T*Q,j(k,2*b+2*A),k[2*b+2*A+1]+=z*Q,j(k,2*b+2*A+1),k[2*b+2*A+1]+=T*$,j(k,2*b+2*A+1),k[2*b+2*A+2]+=z*$,j(k,2*b+2*A+2)}for(b=0;b<y;b++)k[b]=k[2*b+1]<<16|k[2*b];for(b=y;b<2*y;b++)k[b]=0;return new o(k,0)};function j(N,y){for(;(N[y]&65535)!=N[y];)N[y+1]+=N[y]>>>16,N[y]&=65535,y++}function S(N,y){this.g=N,this.h=y}function R(N,y){if(E(y))throw Error("division by zero");if(E(N))return new S(f,f);if(w(N))return y=R(x(N),y),new S(x(y.g),x(y.h));if(w(y))return y=R(N,x(y)),new S(x(y.g),y.h);if(30<N.g.length){if(w(N)||w(y))throw Error("slowDivide_ only works with positive integers.");for(var k=m,b=y;0>=b.l(N);)k=L(k),b=L(b);var A=U(k,1),z=U(b,1);for(b=U(b,2),k=U(k,2);!E(b);){var T=z.add(b);0>=T.l(N)&&(A=A.add(k),z=T),b=U(b,1),k=U(k,1)}return y=v(N,A.j(y)),new S(A,y)}for(A=f;0<=N.l(y);){for(k=Math.max(1,Math.floor(N.m()/y.m())),b=Math.ceil(Math.log(k)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),z=d(k),T=z.j(y);w(T)||0<T.l(N);)k-=b,z=d(k),T=z.j(y);E(z)&&(z=m),A=A.add(z),N=v(N,T)}return new S(A,N)}t.A=function(N){return R(this,N).h},t.and=function(N){for(var y=Math.max(this.g.length,N.g.length),k=[],b=0;b<y;b++)k[b]=this.i(b)&N.i(b);return new o(k,this.h&N.h)},t.or=function(N){for(var y=Math.max(this.g.length,N.g.length),k=[],b=0;b<y;b++)k[b]=this.i(b)|N.i(b);return new o(k,this.h|N.h)},t.xor=function(N){for(var y=Math.max(this.g.length,N.g.length),k=[],b=0;b<y;b++)k[b]=this.i(b)^N.i(b);return new o(k,this.h^N.h)};function L(N){for(var y=N.g.length+1,k=[],b=0;b<y;b++)k[b]=N.i(b)<<1|N.i(b-1)>>>31;return new o(k,N.h)}function U(N,y){var k=y>>5;y%=32;for(var b=N.g.length-k,A=[],z=0;z<b;z++)A[z]=0<y?N.i(z+k)>>>y|N.i(z+k+1)<<32-y:N.i(z+k);return new o(A,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,D0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Os=o}).apply(typeof wy<"u"?wy:typeof self<"u"?self:typeof window<"u"?window:{});var Fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var z0,Hi,L0,cc,sp,O0,V0,M0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,p,g){return c==Array.prototype||c==Object.prototype||(c[p]=g.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fl=="object"&&Fl];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function a(c,p){if(p)e:{var g=r;c=c.split(".");for(var P=0;P<c.length-1;P++){var M=c[P];if(!(M in g))break e;g=g[M]}c=c[c.length-1],P=g[c],p=p(P),p!=P&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}function i(c,p){c instanceof String&&(c+="");var g=0,P=!1,M={next:function(){if(!P&&g<c.length){var K=g++;return{value:p(K,c[K]),done:!1}}return P=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}a("Array.prototype.values",function(c){return c||function(){return i(this,function(p,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(c){var p=typeof c;return p=p!="object"?p:c?Array.isArray(c)?"array":p:"null",p=="array"||p=="object"&&typeof c.length=="number"}function d(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function h(c,p,g){return c.call.apply(c.bind,arguments)}function f(c,p,g){if(!c)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,P),c.apply(p,M)}}return function(){return c.apply(p,arguments)}}function m(c,p,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function _(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var P=g.slice();return P.push.apply(P,arguments),c.apply(this,P)}}function E(c,p){function g(){}g.prototype=p.prototype,c.aa=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Qb=function(P,M,K){for(var ce=Array(arguments.length-2),He=2;He<arguments.length;He++)ce[He-2]=arguments[He];return p.prototype[M].apply(P,ce)}}function w(c){const p=c.length;if(0<p){const g=Array(p);for(let P=0;P<p;P++)g[P]=c[P];return g}return[]}function x(c,p){for(let g=1;g<arguments.length;g++){const P=arguments[g];if(u(P)){const M=c.length||0,K=P.length||0;c.length=M+K;for(let ce=0;ce<K;ce++)c[M+ce]=P[ce]}else c.push(P)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function j(c){return/^[\s\xa0]*$/.test(c)}function S(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function R(c){return R[" "](c),c}R[" "]=function(){};var L=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function U(c,p,g){for(const P in c)p.call(g,c[P],P,c)}function N(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function y(c){const p={};for(const g in c)p[g]=c[g];return p}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(c,p){let g,P;for(let M=1;M<arguments.length;M++){P=arguments[M];for(g in P)c[g]=P[g];for(let K=0;K<k.length;K++)g=k[K],Object.prototype.hasOwnProperty.call(P,g)&&(c[g]=P[g])}}function A(c){var p=1;c=c.split(":");const g=[];for(;0<p&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function z(c){l.setTimeout(()=>{throw c},0)}function T(){var c=D;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class ${constructor(){this.h=this.g=null}add(p,g){const P=Q.get();P.set(p,g),this.h?this.h.next=P:this.g=P,this.h=P}}var Q=new v(()=>new B,c=>c.reset());class B{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,W=!1,D=new $,q=()=>{const c=l.Promise.resolve(void 0);ee=()=>{c.then(G)}};var G=()=>{for(var c;c=T();){try{c.h.call(c.g)}catch(g){z(g)}var p=Q;p.j(c),100>p.h&&(p.h++,c.next=p.g,p.g=c)}W=!1};function I(){this.s=this.s,this.C=this.C}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};l.addEventListener("test",g,p),l.removeEventListener("test",g,p)}catch{}return c}();function H(c,p){if(O.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var g=this.type=c.type,P=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget){if(L){e:{try{R(p.nodeName);var M=!0;break e}catch{}M=!1}M||(p=null)}}else g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement);this.relatedTarget=p,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:X[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&H.aa.h.call(this)}}E(H,O);var X={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var te="closure_listenable_"+(1e6*Math.random()|0),ae=0;function pe(c,p,g,P,M){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!P,this.ha=M,this.key=++ae,this.da=this.fa=!1}function oe(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function De(c){this.src=c,this.g={},this.h=0}De.prototype.add=function(c,p,g,P,M){var K=c.toString();c=this.g[K],c||(c=this.g[K]=[],this.h++);var ce=V(c,p,P,M);return-1<ce?(p=c[ce],g||(p.fa=!1)):(p=new pe(p,this.src,K,!!P,M),p.fa=g,c.push(p)),p};function Te(c,p){var g=p.type;if(g in c.g){var P=c.g[g],M=Array.prototype.indexOf.call(P,p,void 0),K;(K=0<=M)&&Array.prototype.splice.call(P,M,1),K&&(oe(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function V(c,p,g,P){for(var M=0;M<c.length;++M){var K=c[M];if(!K.da&&K.listener==p&&K.capture==!!g&&K.ha==P)return M}return-1}var J="closure_lm_"+(1e6*Math.random()|0),Z={};function le(c,p,g,P,M){if(Array.isArray(p)){for(var K=0;K<p.length;K++)le(c,p[K],g,P,M);return null}return g=En(g),c&&c[te]?c.K(p,g,d(P)?!!P.capture:!1,M):de(c,p,g,!1,P,M)}function de(c,p,g,P,M,K){if(!p)throw Error("Invalid event type");var ce=d(M)?!!M.capture:!!M,He=_e(c);if(He||(c[J]=He=new De(c)),g=He.add(p,g,P,ce,K),g.proxy)return g;if(P=qe(),g.proxy=P,P.src=c,P.listener=g,c.addEventListener)F||(M=ce),M===void 0&&(M=!1),c.addEventListener(p.toString(),P,M);else if(c.attachEvent)c.attachEvent(fe(p.toString()),P);else if(c.addListener&&c.removeListener)c.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return g}function qe(){function c(g){return p.call(c.src,c.listener,g)}const p=ze;return c}function Oe(c,p,g,P,M){if(Array.isArray(p))for(var K=0;K<p.length;K++)Oe(c,p[K],g,P,M);else P=d(P)?!!P.capture:!!P,g=En(g),c&&c[te]?(c=c.i,p=String(p).toString(),p in c.g&&(K=c.g[p],g=V(K,g,P,M),-1<g&&(oe(K[g]),Array.prototype.splice.call(K,g,1),K.length==0&&(delete c.g[p],c.h--)))):c&&(c=_e(c))&&(p=c.g[p.toString()],c=-1,p&&(c=V(p,g,P,M)),(g=-1<c?p[c]:null)&&Re(g))}function Re(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[te])Te(p.i,c);else{var g=c.type,P=c.proxy;p.removeEventListener?p.removeEventListener(g,P,c.capture):p.detachEvent?p.detachEvent(fe(g),P):p.addListener&&p.removeListener&&p.removeListener(P),(g=_e(p))?(Te(g,c),g.h==0&&(g.src=null,p[J]=null)):oe(c)}}}function fe(c){return c in Z?Z[c]:Z[c]="on"+c}function ze(c,p){if(c.da)c=!0;else{p=new H(p,this);var g=c.listener,P=c.ha||c.src;c.fa&&Re(c),c=g.call(P,p)}return c}function _e(c){return c=c[J],c instanceof De?c:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function En(c){return typeof c=="function"?c:(c[Ee]||(c[Ee]=function(p){return c.handleEvent(p)}),c[Ee])}function We(){I.call(this),this.i=new De(this),this.M=this,this.F=null}E(We,I),We.prototype[te]=!0,We.prototype.removeEventListener=function(c,p,g,P){Oe(this,c,p,g,P)};function ut(c,p){var g,P=c.F;if(P)for(g=[];P;P=P.F)g.push(P);if(c=c.M,P=p.type||p,typeof p=="string")p=new O(p,c);else if(p instanceof O)p.target=p.target||c;else{var M=p;p=new O(P,c),b(p,M)}if(M=!0,g)for(var K=g.length-1;0<=K;K--){var ce=p.g=g[K];M=ol(ce,P,!0,p)&&M}if(ce=p.g=c,M=ol(ce,P,!0,p)&&M,M=ol(ce,P,!1,p)&&M,g)for(K=0;K<g.length;K++)ce=p.g=g[K],M=ol(ce,P,!1,p)&&M}We.prototype.N=function(){if(We.aa.N.call(this),this.i){var c=this.i,p;for(p in c.g){for(var g=c.g[p],P=0;P<g.length;P++)oe(g[P]);delete c.g[p],c.h--}}this.F=null},We.prototype.K=function(c,p,g,P){return this.i.add(String(c),p,!1,g,P)},We.prototype.L=function(c,p,g,P){return this.i.add(String(c),p,!0,g,P)};function ol(c,p,g,P){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();for(var M=!0,K=0;K<p.length;++K){var ce=p[K];if(ce&&!ce.da&&ce.capture==g){var He=ce.listener,Tt=ce.ha||ce.src;ce.fa&&Te(c.i,ce),M=He.call(Tt,P)!==!1&&M}}return M&&!P.defaultPrevented}function Rm(c,p,g){if(typeof c=="function")g&&(c=m(c,g));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:l.setTimeout(c,p||0)}function Am(c){c.g=Rm(()=>{c.g=null,c.i&&(c.i=!1,Am(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class IN extends I{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Am(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fi(c){I.call(this),this.h=c,this.g={}}E(fi,I);var Dm=[];function zm(c){U(c.g,function(p,g){this.g.hasOwnProperty(g)&&Re(p)},c),c.g={}}fi.prototype.N=function(){fi.aa.N.call(this),zm(this)},fi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qu=l.JSON.stringify,SN=l.JSON.parse,CN=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function Zu(){}Zu.prototype.h=null;function Lm(c){return c.h||(c.h=c.i())}function Om(){}var mi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ju(){O.call(this,"d")}E(Ju,O);function Yu(){O.call(this,"c")}E(Yu,O);var js={},Vm=null;function ll(){return Vm=Vm||new We}js.La="serverreachability";function Mm(c){O.call(this,js.La,c)}E(Mm,O);function gi(c){const p=ll();ut(p,new Mm(p))}js.STAT_EVENT="statevent";function Um(c,p){O.call(this,js.STAT_EVENT,c),this.stat=p}E(Um,O);function Ht(c){const p=ll();ut(p,new Um(p,c))}js.Ma="timingevent";function Fm(c,p){O.call(this,js.Ma,c),this.size=p}E(Fm,O);function vi(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},p)}function yi(){this.g=!0}yi.prototype.xa=function(){this.g=!1};function PN(c,p,g,P,M,K){c.info(function(){if(c.g)if(K)for(var ce="",He=K.split("&"),Tt=0;Tt<He.length;Tt++){var Me=He[Tt].split("=");if(1<Me.length){var Dt=Me[0];Me=Me[1];var zt=Dt.split("_");ce=2<=zt.length&&zt[1]=="type"?ce+(Dt+"="+Me+"&"):ce+(Dt+"=redacted&")}}else ce=null;else ce=K;return"XMLHTTP REQ ("+P+") [attempt "+M+"]: "+p+`
`+g+`
`+ce})}function RN(c,p,g,P,M,K,ce){c.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+M+"]: "+p+`
`+g+`
`+K+" "+ce})}function sa(c,p,g,P){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+DN(c,g)+(P?" "+P:"")})}function AN(c,p){c.info(function(){return"TIMEOUT: "+p})}yi.prototype.info=function(){};function DN(c,p){if(!c.g)return p;if(!p)return null;try{var g=JSON.parse(p);if(g){for(c=0;c<g.length;c++)if(Array.isArray(g[c])){var P=g[c];if(!(2>P.length)){var M=P[1];if(Array.isArray(M)&&!(1>M.length)){var K=M[0];if(K!="noop"&&K!="stop"&&K!="close")for(var ce=1;ce<M.length;ce++)M[ce]=""}}}}return Qu(g)}catch{return p}}var cl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Bm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Xu;function ul(){}E(ul,Zu),ul.prototype.g=function(){return new XMLHttpRequest},ul.prototype.i=function(){return{}},Xu=new ul;function Rr(c,p,g,P){this.j=c,this.i=p,this.l=g,this.R=P||1,this.U=new fi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $m}function $m(){this.i=null,this.g="",this.h=!1}var qm={},ed={};function td(c,p,g){c.L=1,c.v=fl(cr(p)),c.m=g,c.P=!0,Wm(c,null)}function Wm(c,p){c.F=Date.now(),dl(c),c.A=cr(c.v);var g=c.A,P=c.R;Array.isArray(P)||(P=[String(P)]),ag(g.i,"t",P),c.C=0,g=c.j.J,c.h=new $m,c.g=Ng(c.j,g?p:null,!c.m),0<c.O&&(c.M=new IN(m(c.Y,c,c.g),c.O)),p=c.U,g=c.g,P=c.ca;var M="readystatechange";Array.isArray(M)||(M&&(Dm[0]=M.toString()),M=Dm);for(var K=0;K<M.length;K++){var ce=le(g,M[K],P||p.handleEvent,!1,p.h||p);if(!ce)break;p.g[ce.key]=ce}p=c.H?y(c.H):{},c.m?(c.u||(c.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,p)):(c.u="GET",c.g.ea(c.A,c.u,null,p)),gi(),PN(c.i,c.u,c.A,c.l,c.R,c.m)}Rr.prototype.ca=function(c){c=c.target;const p=this.M;p&&ur(c)==3?p.j():this.Y(c)},Rr.prototype.Y=function(c){try{if(c==this.g)e:{const zt=ur(this.g);var p=this.g.Ba();const oa=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||hg(this.g)))){this.J||zt!=4||p==7||(p==8||0>=oa?gi(3):gi(2)),nd(this);var g=this.g.Z();this.X=g;t:if(Hm(this)){var P=hg(this.g);c="";var M=P.length,K=ur(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_s(this),xi(this);var ce="";break t}this.h.i=new l.TextDecoder}for(p=0;p<M;p++)this.h.h=!0,c+=this.h.i.decode(P[p],{stream:!(K&&p==M-1)});P.length=0,this.h.g+=c,this.C=0,ce=this.h.g}else ce=this.g.oa();if(this.o=g==200,RN(this.i,this.u,this.A,this.l,this.R,zt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Tt=this.g;if((He=Tt.g?Tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(He)){var Me=He;break t}}Me=null}if(g=Me)sa(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rd(this,g);else{this.o=!1,this.s=3,Ht(12),_s(this),xi(this);break e}}if(this.P){g=!0;let In;for(;!this.J&&this.C<ce.length;)if(In=zN(this,ce),In==ed){zt==4&&(this.s=4,Ht(14),g=!1),sa(this.i,this.l,null,"[Incomplete Response]");break}else if(In==qm){this.s=4,Ht(15),sa(this.i,this.l,ce,"[Invalid Chunk]"),g=!1;break}else sa(this.i,this.l,In,null),rd(this,In);if(Hm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||ce.length!=0||this.h.h||(this.s=1,Ht(16),g=!1),this.o=this.o&&g,!g)sa(this.i,this.l,ce,"[Invalid Chunked Response]"),_s(this),xi(this);else if(0<ce.length&&!this.W){this.W=!0;var Dt=this.j;Dt.g==this&&Dt.ba&&!Dt.M&&(Dt.j.info("Great, no buffering proxy detected. Bytes received: "+ce.length),cd(Dt),Dt.M=!0,Ht(11))}}else sa(this.i,this.l,ce,null),rd(this,ce);zt==4&&_s(this),this.o&&!this.J&&(zt==4?xg(this.j,this):(this.o=!1,dl(this)))}else YN(this.g),g==400&&0<ce.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),_s(this),xi(this)}}}catch{}finally{}};function Hm(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function zN(c,p){var g=c.C,P=p.indexOf(`
`,g);return P==-1?ed:(g=Number(p.substring(g,P)),isNaN(g)?qm:(P+=1,P+g>p.length?ed:(p=p.slice(P,P+g),c.C=P+g,p)))}Rr.prototype.cancel=function(){this.J=!0,_s(this)};function dl(c){c.S=Date.now()+c.I,Km(c,c.I)}function Km(c,p){if(c.B!=null)throw Error("WatchDog timer not null");c.B=vi(m(c.ba,c),p)}function nd(c){c.B&&(l.clearTimeout(c.B),c.B=null)}Rr.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(AN(this.i,this.A),this.L!=2&&(gi(),Ht(17)),_s(this),this.s=2,xi(this)):Km(this,this.S-c)};function xi(c){c.j.G==0||c.J||xg(c.j,c)}function _s(c){nd(c);var p=c.M;p&&typeof p.ma=="function"&&p.ma(),c.M=null,zm(c.U),c.g&&(p=c.g,c.g=null,p.abort(),p.ma())}function rd(c,p){try{var g=c.j;if(g.G!=0&&(g.g==c||sd(g.h,c))){if(!c.K&&sd(g.h,c)&&g.G==3){try{var P=g.Da.g.parse(p)}catch{P=null}if(Array.isArray(P)&&P.length==3){var M=P;if(M[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<c.F)wl(g),yl(g);else break e;ld(g),Ht(18)}}else g.za=M[1],0<g.za-g.T&&37500>M[2]&&g.F&&g.v==0&&!g.C&&(g.C=vi(m(g.Za,g),6e3));if(1>=Zm(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else bs(g,11)}else if((c.K||g.g==c)&&wl(g),!j(p))for(M=g.Da.g.parse(p),p=0;p<M.length;p++){let Me=M[p];if(g.T=Me[0],Me=Me[1],g.G==2)if(Me[0]=="c"){g.K=Me[1],g.ia=Me[2];const Dt=Me[3];Dt!=null&&(g.la=Dt,g.j.info("VER="+g.la));const zt=Me[4];zt!=null&&(g.Aa=zt,g.j.info("SVER="+g.Aa));const oa=Me[5];oa!=null&&typeof oa=="number"&&0<oa&&(P=1.5*oa,g.L=P,g.j.info("backChannelRequestTimeoutMs_="+P)),P=g;const In=c.g;if(In){const _l=In.g?In.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_l){var K=P.h;K.g||_l.indexOf("spdy")==-1&&_l.indexOf("quic")==-1&&_l.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(ad(K,K.h),K.h=null))}if(P.D){const ud=In.g?In.g.getResponseHeader("X-HTTP-Session-Id"):null;ud&&(P.ya=ud,Ge(P.I,P.D,ud))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-c.F,g.j.info("Handshake RTT: "+g.R+"ms")),P=g;var ce=c;if(P.qa=_g(P,P.J?P.ia:null,P.W),ce.K){Jm(P.h,ce);var He=ce,Tt=P.L;Tt&&(He.I=Tt),He.B&&(nd(He),dl(He)),P.g=ce}else vg(P);0<g.i.length&&xl(g)}else Me[0]!="stop"&&Me[0]!="close"||bs(g,7);else g.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?bs(g,7):od(g):Me[0]!="noop"&&g.l&&g.l.ta(Me),g.v=0)}}gi(4)}catch{}}var LN=class{constructor(c,p){this.g=c,this.map=p}};function Gm(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qm(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Zm(c){return c.h?1:c.g?c.g.size:0}function sd(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function ad(c,p){c.g?c.g.add(p):c.h=p}function Jm(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Gm.prototype.cancel=function(){if(this.i=Ym(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ym(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.D);return p}return w(c.i)}function ON(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var p=[],g=c.length,P=0;P<g;P++)p.push(c[P]);return p}p=[],g=0;for(P in c)p[g++]=c[P];return p}function VN(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var p=[];c=c.length;for(var g=0;g<c;g++)p.push(g);return p}p=[],g=0;for(const P in c)p[g++]=P;return p}}}function Xm(c,p){if(c.forEach&&typeof c.forEach=="function")c.forEach(p,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,p,void 0);else for(var g=VN(c),P=ON(c),M=P.length,K=0;K<M;K++)p.call(void 0,P[K],g&&g[K],c)}var eg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MN(c,p){if(c){c=c.split("&");for(var g=0;g<c.length;g++){var P=c[g].indexOf("="),M=null;if(0<=P){var K=c[g].substring(0,P);M=c[g].substring(P+1)}else K=c[g];p(K,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Ns(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ns){this.h=c.h,hl(this,c.j),this.o=c.o,this.g=c.g,pl(this,c.s),this.l=c.l;var p=c.i,g=new _i;g.i=p.i,p.g&&(g.g=new Map(p.g),g.h=p.h),tg(this,g),this.m=c.m}else c&&(p=String(c).match(eg))?(this.h=!1,hl(this,p[1]||"",!0),this.o=wi(p[2]||""),this.g=wi(p[3]||"",!0),pl(this,p[4]),this.l=wi(p[5]||"",!0),tg(this,p[6]||"",!0),this.m=wi(p[7]||"")):(this.h=!1,this.i=new _i(null,this.h))}Ns.prototype.toString=function(){var c=[],p=this.j;p&&c.push(ji(p,ng,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(ji(p,ng,!0),"@"),c.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&c.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(ji(g,g.charAt(0)=="/"?BN:FN,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",ji(g,qN)),c.join("")};function cr(c){return new Ns(c)}function hl(c,p,g){c.j=g?wi(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function pl(c,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);c.s=p}else c.s=null}function tg(c,p,g){p instanceof _i?(c.i=p,WN(c.i,c.h)):(g||(p=ji(p,$N)),c.i=new _i(p,c.h))}function Ge(c,p,g){c.i.set(p,g)}function fl(c){return Ge(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function wi(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ji(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,UN),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function UN(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ng=/[#\/\?@]/g,FN=/[#\?:]/g,BN=/[#\?]/g,$N=/[#\?@]/g,qN=/#/g;function _i(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function Ar(c){c.g||(c.g=new Map,c.h=0,c.i&&MN(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=_i.prototype,t.add=function(c,p){Ar(this),this.i=null,c=aa(this,c);var g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function rg(c,p){Ar(c),p=aa(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function sg(c,p){return Ar(c),p=aa(c,p),c.g.has(p)}t.forEach=function(c,p){Ar(this),this.g.forEach(function(g,P){g.forEach(function(M){c.call(p,M,P,this)},this)},this)},t.na=function(){Ar(this);const c=Array.from(this.g.values()),p=Array.from(this.g.keys()),g=[];for(let P=0;P<p.length;P++){const M=c[P];for(let K=0;K<M.length;K++)g.push(p[P])}return g},t.V=function(c){Ar(this);let p=[];if(typeof c=="string")sg(this,c)&&(p=p.concat(this.g.get(aa(this,c))));else{c=Array.from(this.g.values());for(let g=0;g<c.length;g++)p=p.concat(c[g])}return p},t.set=function(c,p){return Ar(this),this.i=null,c=aa(this,c),sg(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=this.V(c),0<c.length?String(c[0]):p):p};function ag(c,p,g){rg(c,p),0<g.length&&(c.i=null,c.g.set(aa(c,p),w(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(var g=0;g<p.length;g++){var P=p[g];const K=encodeURIComponent(String(P)),ce=this.V(P);for(P=0;P<ce.length;P++){var M=K;ce[P]!==""&&(M+="="+encodeURIComponent(String(ce[P]))),c.push(M)}}return this.i=c.join("&")};function aa(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function WN(c,p){p&&!c.j&&(Ar(c),c.i=null,c.g.forEach(function(g,P){var M=P.toLowerCase();P!=M&&(rg(this,P),ag(this,M,g))},c)),c.j=p}function HN(c,p){const g=new yi;if(l.Image){const P=new Image;P.onload=_(Dr,g,"TestLoadImage: loaded",!0,p,P),P.onerror=_(Dr,g,"TestLoadImage: error",!1,p,P),P.onabort=_(Dr,g,"TestLoadImage: abort",!1,p,P),P.ontimeout=_(Dr,g,"TestLoadImage: timeout",!1,p,P),l.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=c}else p(!1)}function KN(c,p){const g=new yi,P=new AbortController,M=setTimeout(()=>{P.abort(),Dr(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:P.signal}).then(K=>{clearTimeout(M),K.ok?Dr(g,"TestPingServer: ok",!0,p):Dr(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(M),Dr(g,"TestPingServer: error",!1,p)})}function Dr(c,p,g,P,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),P(g)}catch{}}function GN(){this.g=new CN}function QN(c,p,g){const P=g||"";try{Xm(c,function(M,K){let ce=M;d(M)&&(ce=Qu(M)),p.push(P+K+"="+encodeURIComponent(ce))})}catch(M){throw p.push(P+"type="+encodeURIComponent("_badmap")),M}}function ml(c){this.l=c.Ub||null,this.j=c.eb||!1}E(ml,Zu),ml.prototype.g=function(){return new gl(this.l,this.j)},ml.prototype.i=function(c){return function(){return c}}({});function gl(c,p){We.call(this),this.D=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(gl,We),t=gl.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=p,this.readyState=1,bi(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(p.body=c),(this.D||l).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ni(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,bi(this)),this.g&&(this.readyState=3,bi(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ig(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ig(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Ni(this):bi(this),this.readyState==3&&ig(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Ni(this))},t.Qa=function(c){this.g&&(this.response=c,Ni(this))},t.ga=function(){this.g&&Ni(this)};function Ni(c){c.readyState=4,c.l=null,c.j=null,c.v=null,bi(c)}t.setRequestHeader=function(c,p){this.u.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function bi(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(gl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function og(c){let p="";return U(c,function(g,P){p+=P,p+=":",p+=g,p+=`\r
`}),p}function id(c,p,g){e:{for(P in g){var P=!1;break e}P=!0}P||(g=og(g),typeof c=="string"?g!=null&&encodeURIComponent(String(g)):Ge(c,p,g))}function it(c){We.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(it,We);var ZN=/^https?$/i,JN=["POST","PUT"];t=it.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,p,g,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Xu.g(),this.v=this.o?Lm(this.o):Lm(Xu),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(K){lg(this,K);return}if(c=g||"",g=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var M in P)g.set(M,P[M]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const K of P.keys())g.set(K,P.get(K));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(g.keys()).find(K=>K.toLowerCase()=="content-type"),M=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(JN,p,void 0))||P||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,ce]of g)this.g.setRequestHeader(K,ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dg(this),this.u=!0,this.g.send(c),this.u=!1}catch(K){lg(this,K)}};function lg(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.m=5,cg(c),vl(c)}function cg(c){c.A||(c.A=!0,ut(c,"complete"),ut(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,ut(this,"complete"),ut(this,"abort"),vl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vl(this,!0)),it.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ug(this):this.bb())},t.bb=function(){ug(this)};function ug(c){if(c.h&&typeof o<"u"&&(!c.v[1]||ur(c)!=4||c.Z()!=2)){if(c.u&&ur(c)==4)Rm(c.Ea,0,c);else if(ut(c,"readystatechange"),ur(c)==4){c.h=!1;try{const ce=c.Z();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var P;if(P=ce===0){var M=String(c.D).match(eg)[1]||null;!M&&l.self&&l.self.location&&(M=l.self.location.protocol.slice(0,-1)),P=!ZN.test(M?M.toLowerCase():"")}g=P}if(g)ut(c,"complete"),ut(c,"success");else{c.m=6;try{var K=2<ur(c)?c.g.statusText:""}catch{K=""}c.l=K+" ["+c.Z()+"]",cg(c)}}finally{vl(c)}}}}function vl(c,p){if(c.g){dg(c);const g=c.g,P=c.v[0]?()=>{}:null;c.g=null,c.v=null,p||ut(c,"ready");try{g.onreadystatechange=P}catch{}}}function dg(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function ur(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<ur(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),SN(p)}};function hg(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function YN(c){const p={};c=(c.g&&2<=ur(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<c.length;P++){if(j(c[P]))continue;var g=A(c[P]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const K=p[M]||[];p[M]=K,K.push(g)}N(p,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function pg(c){this.Aa=0,this.i=[],this.j=new yi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ki("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ki("baseRetryDelayMs",5e3,c),this.cb=ki("retryDelaySeedMs",1e4,c),this.Wa=ki("forwardChannelMaxRetries",2,c),this.wa=ki("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Gm(c&&c.concurrentRequestLimit),this.Da=new GN,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=pg.prototype,t.la=8,t.G=1,t.connect=function(c,p,g,P){Ht(0),this.W=c,this.H=p||{},g&&P!==void 0&&(this.H.OSID=g,this.H.OAID=P),this.F=this.X,this.I=_g(this,null,this.W),xl(this)};function od(c){if(fg(c),c.G==3){var p=c.U++,g=cr(c.I);if(Ge(g,"SID",c.K),Ge(g,"RID",p),Ge(g,"TYPE","terminate"),Ti(c,g),p=new Rr(c,c.j,p),p.L=2,p.v=fl(cr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(p.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=p.v,g=!0),g||(p.g=Ng(p.j,null),p.g.ea(p.v)),p.F=Date.now(),dl(p)}jg(c)}function yl(c){c.g&&(cd(c),c.g.cancel(),c.g=null)}function fg(c){yl(c),c.u&&(l.clearTimeout(c.u),c.u=null),wl(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function xl(c){if(!Qm(c.h)&&!c.s){c.s=!0;var p=c.Ga;ee||q(),W||(ee(),W=!0),D.add(p,c),c.B=0}}function XN(c,p){return Zm(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=p.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=vi(m(c.Ga,c,p),wg(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const M=new Rr(this,this.j,c);let K=this.o;if(this.S&&(K?(K=y(K),b(K,this.S)):K=this.S),this.m!==null||this.O||(M.H=K,K=null),this.P)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var P=this.i[g];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(p+=P,4096<p){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=gg(this,M,p),g=cr(this.I),Ge(g,"RID",c),Ge(g,"CVER",22),this.D&&Ge(g,"X-HTTP-Session-Id",this.D),Ti(this,g),K&&(this.O?p="headers="+encodeURIComponent(String(og(K)))+"&"+p:this.m&&id(g,this.m,K)),ad(this.h,M),this.Ua&&Ge(g,"TYPE","init"),this.P?(Ge(g,"$req",p),Ge(g,"SID","null"),M.T=!0,td(M,g,null)):td(M,g,p),this.G=2}}else this.G==3&&(c?mg(this,c):this.i.length==0||Qm(this.h)||mg(this))};function mg(c,p){var g;p?g=p.l:g=c.U++;const P=cr(c.I);Ge(P,"SID",c.K),Ge(P,"RID",g),Ge(P,"AID",c.T),Ti(c,P),c.m&&c.o&&id(P,c.m,c.o),g=new Rr(c,c.j,g,c.B+1),c.m===null&&(g.H=c.o),p&&(c.i=p.D.concat(c.i)),p=gg(c,g,1e3),g.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),ad(c.h,g),td(g,P,p)}function Ti(c,p){c.H&&U(c.H,function(g,P){Ge(p,P,g)}),c.l&&Xm({},function(g,P){Ge(p,P,g)})}function gg(c,p,g){g=Math.min(c.i.length,g);var P=c.l?m(c.l.Na,c.l,c):null;e:{var M=c.i;let K=-1;for(;;){const ce=["count="+g];K==-1?0<g?(K=M[0].g,ce.push("ofs="+K)):K=0:ce.push("ofs="+K);let He=!0;for(let Tt=0;Tt<g;Tt++){let Me=M[Tt].g;const Dt=M[Tt].map;if(Me-=K,0>Me)K=Math.max(0,M[Tt].g-100),He=!1;else try{QN(Dt,ce,"req"+Me+"_")}catch{P&&P(Dt)}}if(He){P=ce.join("&");break e}}}return c=c.i.splice(0,g),p.D=c,P}function vg(c){if(!c.g&&!c.u){c.Y=1;var p=c.Fa;ee||q(),W||(ee(),W=!0),D.add(p,c),c.v=0}}function ld(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=vi(m(c.Fa,c),wg(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,yg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=vi(m(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),yl(this),yg(this))};function cd(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function yg(c){c.g=new Rr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var p=cr(c.qa);Ge(p,"RID","rpc"),Ge(p,"SID",c.K),Ge(p,"AID",c.T),Ge(p,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ge(p,"TO",c.ja),Ge(p,"TYPE","xmlhttp"),Ti(c,p),c.m&&c.o&&id(p,c.m,c.o),c.L&&(c.g.I=c.L);var g=c.g;c=c.ia,g.L=1,g.v=fl(cr(p)),g.m=null,g.P=!0,Wm(g,c)}t.Za=function(){this.C!=null&&(this.C=null,yl(this),ld(this),Ht(19))};function wl(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function xg(c,p){var g=null;if(c.g==p){wl(c),cd(c),c.g=null;var P=2}else if(sd(c.h,p))g=p.D,Jm(c.h,p),P=1;else return;if(c.G!=0){if(p.o)if(P==1){g=p.m?p.m.length:0,p=Date.now()-p.F;var M=c.B;P=ll(),ut(P,new Fm(P,g)),xl(c)}else vg(c);else if(M=p.s,M==3||M==0&&0<p.X||!(P==1&&XN(c,p)||P==2&&ld(c)))switch(g&&0<g.length&&(p=c.h,p.i=p.i.concat(g)),M){case 1:bs(c,5);break;case 4:bs(c,10);break;case 3:bs(c,6);break;default:bs(c,2)}}}function wg(c,p){let g=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(g*=2),g*p}function bs(c,p){if(c.j.info("Error code "+p),p==2){var g=m(c.fb,c),P=c.Xa;const M=!P;P=new Ns(P||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||hl(P,"https"),fl(P),M?HN(P.toString(),g):KN(P.toString(),g)}else Ht(2);c.G=0,c.l&&c.l.sa(p),jg(c),fg(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function jg(c){if(c.G=0,c.ka=[],c.l){const p=Ym(c.h);(p.length!=0||c.i.length!=0)&&(x(c.ka,p),x(c.ka,c.i),c.h.i.length=0,w(c.i),c.i.length=0),c.l.ra()}}function _g(c,p,g){var P=g instanceof Ns?cr(g):new Ns(g);if(P.g!="")p&&(P.g=p+"."+P.g),pl(P,P.s);else{var M=l.location;P=M.protocol,p=p?p+"."+M.hostname:M.hostname,M=+M.port;var K=new Ns(null);P&&hl(K,P),p&&(K.g=p),M&&pl(K,M),g&&(K.l=g),P=K}return g=c.D,p=c.ya,g&&p&&Ge(P,g,p),Ge(P,"VER",c.la),Ti(c,P),P}function Ng(c,p,g){if(p&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Ca&&!c.pa?new it(new ml({eb:g})):new it(c.pa),p.Ha(c.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bg(){}t=bg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function jl(){}jl.prototype.g=function(c,p){return new ln(c,p)};function ln(c,p){We.call(this),this.g=new pg(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(c?c["X-WebChannel-Client-Profile"]=p.va:c={"X-WebChannel-Client-Profile":p.va}),this.g.S=c,(c=p&&p.Sb)&&!j(c)&&(this.g.m=c),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!j(p)&&(this.g.D=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new ia(this)}E(ln,We),ln.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){od(this.g)},ln.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.u&&(g={},g.__data__=Qu(c),c=g);p.i.push(new LN(p.Ya++,c)),p.G==3&&xl(p)},ln.prototype.N=function(){this.g.l=null,delete this.j,od(this.g),delete this.g,ln.aa.N.call(this)};function kg(c){Ju.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}E(kg,Ju);function Tg(){Yu.call(this),this.status=1}E(Tg,Yu);function ia(c){this.g=c}E(ia,bg),ia.prototype.ua=function(){ut(this.g,"a")},ia.prototype.ta=function(c){ut(this.g,new kg(c))},ia.prototype.sa=function(c){ut(this.g,new Tg)},ia.prototype.ra=function(){ut(this.g,"b")},jl.prototype.createWebChannel=jl.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,M0=function(){return new jl},V0=function(){return ll()},O0=js,sp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cl.NO_ERROR=0,cl.TIMEOUT=8,cl.HTTP_ERROR=6,cc=cl,Bm.COMPLETE="complete",L0=Bm,Om.EventType=mi,mi.OPEN="a",mi.CLOSE="b",mi.ERROR="c",mi.MESSAGE="d",We.prototype.listen=We.prototype.K,Hi=Om,it.prototype.listenOnce=it.prototype.L,it.prototype.getLastError=it.prototype.Ka,it.prototype.getLastErrorCode=it.prototype.Ba,it.prototype.getStatus=it.prototype.Z,it.prototype.getResponseJson=it.prototype.Oa,it.prototype.getResponseText=it.prototype.oa,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Ha,z0=it}).apply(typeof Fl<"u"?Fl:typeof self<"u"?self:typeof window<"u"?window:{});const jy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ci="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=new Nf("@firebase/firestore");function zi(){return Ks.logLevel}function ge(t,...e){if(Ks.logLevel<=Ae.DEBUG){const n=e.map(Vf);Ks.debug(`Firestore (${ci}): ${t}`,...n)}}function Ir(t,...e){if(Ks.logLevel<=Ae.ERROR){const n=e.map(Vf);Ks.error(`Firestore (${ci}): ${t}`,...n)}}function Qa(t,...e){if(Ks.logLevel<=Ae.WARN){const n=e.map(Vf);Ks.warn(`Firestore (${ci}): ${t}`,...n)}}function Vf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function je(t="Unexpected state"){const e=`FIRESTORE (${ci}) INTERNAL ASSERTION FAILED: `+t;throw Ir(e),new Error(e)}function $e(t,e){t||je()}function be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends or{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class S1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class C1{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){$e(this.o===void 0);let r=this.i;const a=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new jr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jr,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await a(this.currentUser)})},l=u=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string"),new U0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string"),new Ut(e)}}class P1{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class R1{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new P1(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class A1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D1{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){$e(this.o===void 0);const r=i=>{i.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const a=i=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>a(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?a(i):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e(typeof n.token=="string"),this.R=n.token,new A1(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const a=z1(40);for(let i=0;i<a.length;++i)r.length<20&&a[i]<n&&(r+=e.charAt(a[i]%e.length))}return r}}function Ue(t,e){return t<e?-1:t>e?1:0}function Za(t,e,n){return t.length===e.length&&t.every((r,a)=>n(r,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new he(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new he(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new he(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ue.fromMillis(Date.now())}static fromDate(e){return ue.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ue(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ue(this.nanoseconds,e.nanoseconds):Ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new ue(0,0))}static max(){return new Ne(new ue(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,n,r){n===void 0?n=0:n>e.length&&je(),r===void 0?r=e.length-n:r>e.length-n&&je(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ao.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ao?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let a=0;a<r;a++){const i=e.get(a),o=n.get(a);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ze extends Ao{construct(e,n,r){return new Ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new he(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(a=>a.length>0))}return new Ze(n)}static emptyPath(){return new Ze([])}}const L1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends Ao{construct(e,n,r){return new St(e,n,r)}static isValidIdentifier(e){return L1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new St(["__name__"])}static fromServerFormat(e){const n=[];let r="",a=0;const i=()=>{if(r.length===0)throw new he(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new he(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[a+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new he(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(r+=l,a++):(i(),a++)}if(i(),o)throw new he(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(n)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.path=e}static fromPath(e){return new ye(Ze.fromString(e))}static fromName(e){return new ye(Ze.fromString(e).popFirst(5))}static empty(){return new ye(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new Ze(e.slice()))}}function O1(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=Ne.fromTimestamp(r===1e9?new ue(n+1,0):new ue(n,r));return new us(a,ye.empty(),e)}function V1(t){return new us(t.readTime,t.key,-1)}class us{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new us(Ne.min(),ye.empty(),-1)}static max(){return new us(Ne.max(),ye.empty(),-1)}}function M1(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ye.comparator(t.documentKey,e.documentKey),n!==0?n:Ue(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class F1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==U1)throw t;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&je(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ne((r,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,a)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ne?n:ne.resolve(n)}catch(n){return ne.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ne.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ne.reject(n)}static resolve(e){return new ne((n,r)=>{n(e)})}static reject(e){return new ne((n,r)=>{r(e)})}static waitFor(e){return new ne((n,r)=>{let a=0,i=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++i,o&&i===a&&n()},u=>r(u))}),o=!0,i===a&&n()})}static or(e){let n=ne.resolve(!1);for(const r of e)n=n.next(a=>a?ne.resolve(a):r());return n}static forEach(e,n){const r=[];return e.forEach((a,i)=>{r.push(n.call(this,a,i))}),this.waitFor(r)}static mapArray(e,n){return new ne((r,a)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>a(h))}})}static doWhile(e,n){return new ne((r,a)=>{const i=()=>{e()===!0?n().next(()=>{i()},a):r()};i()})}}function B1(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function el(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Mf.oe=-1;function Iu(t){return t==null}function Gc(t){return t===0&&1/t==-1/0}function $1(t){return typeof t=="number"&&Number.isInteger(t)&&!Gc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ea(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function B0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){this.comparator=e,this.root=n||It.EMPTY}insert(e,n){return new at(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,It.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,It.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bl(this.root,e,this.comparator,!0)}}class Bl{constructor(e,n,r,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class It{constructor(e,n,r,a,i){this.key=e,this.value=n,this.color=r??It.RED,this.left=a??It.EMPTY,this.right=i??It.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,a,i){return new It(e??this.key,n??this.value,r??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let a=this;const i=r(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,n,r),null):i===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return It.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return It.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw je();const e=this.left.check();if(e!==this.right.check())throw je();return e+(this.isRed()?0:1)}}It.EMPTY=null,It.RED=!0,It.BLACK=!1;It.EMPTY=new class{constructor(){this.size=0}get key(){throw je()}get value(){throw je()}get color(){throw je()}get left(){throw je()}get right(){throw je()}copy(e,n,r,a,i){return this}insert(e,n,r){return new It(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ny(this.data.getIterator())}getIteratorFrom(e){return new Ny(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Pt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,i=r.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Pt(this.comparator);return n.data=e,n}}class Ny{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new dn([])}unionWith(e){let n=new Pt(St.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Za(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new $0("Invalid base64 string: "+i):i}}(e);return new At(n)}static fromUint8Array(e){const n=function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i}(e);return new At(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}At.EMPTY_BYTE_STRING=new At("");const q1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ds(t){if($e(!!t),typeof t=="string"){let e=0;const n=q1.exec(t);if($e(!!n),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Gs(t){return typeof t=="string"?At.fromBase64String(t):At.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ff(t){const e=t.mapValue.fields.__previous_value__;return Uf(e)?Ff(e):e}function Do(t){const e=ds(t.mapValue.fields.__local_write_time__.timestampValue);return new ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,n,r,a,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class zo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new zo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof zo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l={mapValue:{}};function Qs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Uf(t)?4:K1(t)?9007199254740991:H1(t)?10:11:je()}function tr(t,e){if(t===e)return!0;const n=Qs(t);if(n!==Qs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Do(t).isEqual(Do(e));case 3:return function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=ds(a.timestampValue),l=ds(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,i){return Gs(a.bytesValue).isEqual(Gs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,i){return dt(a.geoPointValue.latitude)===dt(i.geoPointValue.latitude)&&dt(a.geoPointValue.longitude)===dt(i.geoPointValue.longitude)}(t,e);case 2:return function(a,i){if("integerValue"in a&&"integerValue"in i)return dt(a.integerValue)===dt(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=dt(a.doubleValue),l=dt(i.doubleValue);return o===l?Gc(o)===Gc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Za(t.arrayValue.values||[],e.arrayValue.values||[],tr);case 10:case 11:return function(a,i){const o=a.mapValue.fields||{},l=i.mapValue.fields||{};if(_y(o)!==_y(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!tr(o[u],l[u])))return!1;return!0}(t,e);default:return je()}}function Lo(t,e){return(t.values||[]).find(n=>tr(n,e))!==void 0}function Ja(t,e){if(t===e)return 0;const n=Qs(t),r=Qs(e);if(n!==r)return Ue(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ue(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=dt(i.integerValue||i.doubleValue),u=dt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return by(t.timestampValue,e.timestampValue);case 4:return by(Do(t),Do(e));case 5:return Ue(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Gs(i),u=Gs(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=Ue(l[d],u[d]);if(h!==0)return h}return Ue(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ue(dt(i.latitude),dt(o.latitude));return l!==0?l:Ue(dt(i.longitude),dt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ky(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,h;const f=i.fields||{},m=o.fields||{},_=(l=f.value)===null||l===void 0?void 0:l.arrayValue,E=(u=m.value)===null||u===void 0?void 0:u.arrayValue,w=Ue(((d=_==null?void 0:_.values)===null||d===void 0?void 0:d.length)||0,((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0);return w!==0?w:ky(_,E)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===$l.mapValue&&o===$l.mapValue)return 0;if(i===$l.mapValue)return 1;if(o===$l.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let f=0;f<u.length&&f<h.length;++f){const m=Ue(u[f],h[f]);if(m!==0)return m;const _=Ja(l[u[f]],d[h[f]]);if(_!==0)return _}return Ue(u.length,h.length)}(t.mapValue,e.mapValue);default:throw je()}}function by(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ue(t,e);const n=ds(t),r=ds(e),a=Ue(n.seconds,r.seconds);return a!==0?a:Ue(n.nanos,r.nanos)}function ky(t,e){const n=t.values||[],r=e.values||[];for(let a=0;a<n.length&&a<r.length;++a){const i=Ja(n[a],r[a]);if(i)return i}return Ue(n.length,r.length)}function Ya(t){return ap(t)}function ap(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ds(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Gs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ye.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",a=!0;for(const i of n.values||[])a?a=!1:r+=",",r+=ap(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let a="{",i=!0;for(const o of r)i?i=!1:a+=",",a+=`${o}:${ap(n.fields[o])}`;return a+"}"}(t.mapValue):je()}function Ty(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ip(t){return!!t&&"integerValue"in t}function Bf(t){return!!t&&"arrayValue"in t}function Ey(t){return!!t&&"nullValue"in t}function Iy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function uc(t){return!!t&&"mapValue"in t}function H1(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function io(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ea(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=io(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=io(t.arrayValue.values[n]);return e}return Object.assign({},t)}function K1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.value=e}static empty(){return new tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!uc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=io(n)}setAll(e){let n=St.emptyPath(),r={},a=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,a),r={},a=[],n=l.popLast()}o?r[l.lastSegment()]=io(o):a.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,a)}delete(e){const n=this.field(e.popLast());uc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=n.mapValue.fields[e.get(r)];uc(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,r){ea(n,(a,i)=>e[a]=i);for(const a of r)delete e[a]}clone(){return new tn(io(this.value))}}function q0(t){const e=[];return ea(t.fields,(n,r)=>{const a=new St([n]);if(uc(r)){const i=q0(r.mapValue).fields;if(i.length===0)e.push(a);else for(const o of i)e.push(a.child(o))}else e.push(a)}),new dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,r,a,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=a,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Bt(e,0,Ne.min(),Ne.min(),Ne.min(),tn.empty(),0)}static newFoundDocument(e,n,r,a){return new Bt(e,1,n,Ne.min(),r,a,0)}static newNoDocument(e,n){return new Bt(e,2,n,Ne.min(),Ne.min(),tn.empty(),0)}static newUnknownDocument(e,n){return new Bt(e,3,n,Ne.min(),Ne.min(),tn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n){this.position=e,this.inclusive=n}}function Sy(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(i.field.isKeyField()?r=ye.comparator(ye.fromName(o.referenceValue),n.key):r=Ja(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,n="asc"){this.field=e,this.dir=n}}function G1(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{}class vt extends W0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Z1(e,n,r):n==="array-contains"?new X1(e,r):n==="in"?new eP(e,r):n==="not-in"?new tP(e,r):n==="array-contains-any"?new nP(e,r):new vt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new J1(e,r):new Y1(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ja(n,this.value)):n!==null&&Qs(this.value)===Qs(n)&&this.matchesComparison(Ja(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return je()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Un extends W0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Un(e,n)}matches(e){return H0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function H0(t){return t.op==="and"}function K0(t){return Q1(t)&&H0(t)}function Q1(t){for(const e of t.filters)if(e instanceof Un)return!1;return!0}function op(t){if(t instanceof vt)return t.field.canonicalString()+t.op.toString()+Ya(t.value);if(K0(t))return t.filters.map(e=>op(e)).join(",");{const e=t.filters.map(n=>op(n)).join(",");return`${t.op}(${e})`}}function G0(t,e){return t instanceof vt?function(r,a){return a instanceof vt&&r.op===a.op&&r.field.isEqual(a.field)&&tr(r.value,a.value)}(t,e):t instanceof Un?function(r,a){return a instanceof Un&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce((i,o,l)=>i&&G0(o,a.filters[l]),!0):!1}(t,e):void je()}function Q0(t){return t instanceof vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ya(n.value)}`}(t):t instanceof Un?function(n){return n.op.toString()+" {"+n.getFilters().map(Q0).join(" ,")+"}"}(t):"Filter"}class Z1 extends vt{constructor(e,n,r){super(e,n,r),this.key=ye.fromName(r.referenceValue)}matches(e){const n=ye.comparator(e.key,this.key);return this.matchesComparison(n)}}class J1 extends vt{constructor(e,n){super(e,"in",n),this.keys=Z0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Y1 extends vt{constructor(e,n){super(e,"not-in",n),this.keys=Z0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Z0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ye.fromName(r.referenceValue))}class X1 extends vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bf(n)&&Lo(n.arrayValue,this.value)}}class eP extends vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lo(this.value.arrayValue,n)}}class tP extends vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Lo(this.value.arrayValue,n)}}class nP extends vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n=null,r=[],a=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Py(t,e=null,n=[],r=[],a=null,i=null,o=null){return new rP(t,e,n,r,a,i,o)}function $f(t){const e=be(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>op(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Iu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ya(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ya(r)).join(",")),e.ue=n}return e.ue}function qf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!G1(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!G0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cy(t.startAt,e.startAt)&&Cy(t.endAt,e.endAt)}function lp(t){return ye.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n=null,r=[],a=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function sP(t,e,n,r,a,i,o,l){return new ui(t,e,n,r,a,i,o,l)}function Wf(t){return new ui(t)}function Ry(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function J0(t){return t.collectionGroup!==null}function oo(t){const e=be(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Pt(St.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Oo(i,r))}),n.has(St.keyField().canonicalString())||e.ce.push(new Oo(St.keyField(),r))}return e.ce}function Xn(t){const e=be(t);return e.le||(e.le=aP(e,oo(t))),e.le}function aP(t,e){if(t.limitType==="F")return Py(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const i=a.dir==="desc"?"asc":"desc";return new Oo(a.field,i)});const n=t.endAt?new Qc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qc(t.startAt.position,t.startAt.inclusive):null;return Py(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function cp(t,e){const n=t.filters.concat([e]);return new ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function up(t,e,n){return new ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Su(t,e){return qf(Xn(t),Xn(e))&&t.limitType===e.limitType}function Y0(t){return`${$f(Xn(t))}|lt:${t.limitType}`}function ha(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(a=>Q0(a)).join(", ")}]`),Iu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(a=>Ya(a)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(a=>Ya(a)).join(",")),`Target(${r})`}(Xn(t))}; limitType=${t.limitType})`}function Cu(t,e){return e.isFoundDocument()&&function(r,a){const i=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ye.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,a){for(const i of oo(r))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,a){for(const i of r.filters)if(!i.matches(a))return!1;return!0}(t,e)&&function(r,a){return!(r.startAt&&!function(o,l,u){const d=Sy(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,oo(r),a)||r.endAt&&!function(o,l,u){const d=Sy(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,oo(r),a))}(t,e)}function iP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function X0(t){return(e,n)=>{let r=!1;for(const a of oo(t)){const i=oP(a,e,n);if(i!==0)return i;r=r||a.field.isKeyField()}return 0}}function oP(t,e,n){const r=t.field.isKeyField()?ye.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?Ja(u,d):je()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return je()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[a,i]of r)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ea(this.inner,(n,r)=>{for(const[a,i]of r)e(a,i)})}isEmpty(){return B0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=new at(ye.comparator);function Sr(){return lP}const e_=new at(ye.comparator);function Ki(...t){let e=e_;for(const n of t)e=e.insert(n.key,n);return e}function t_(t){let e=e_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ds(){return lo()}function n_(){return lo()}function lo(){return new di(t=>t.toString(),(t,e)=>t.isEqual(e))}const cP=new at(ye.comparator),uP=new Pt(ye.comparator);function Pe(...t){let e=uP;for(const n of t)e=e.add(n);return e}const dP=new Pt(Ue);function hP(){return dP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gc(e)?"-0":e}}function r_(t){return{integerValue:""+t}}function pP(t,e){return $1(e)?r_(e):Hf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(){this._=void 0}}function fP(t,e,n){return t instanceof Zc?function(a,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&Uf(i)&&(i=Ff(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Vo?a_(t,e):t instanceof Mo?i_(t,e):function(a,i){const o=s_(a,i),l=Ay(o)+Ay(a.Pe);return ip(o)&&ip(a.Pe)?r_(l):Hf(a.serializer,l)}(t,e)}function mP(t,e,n){return t instanceof Vo?a_(t,e):t instanceof Mo?i_(t,e):n}function s_(t,e){return t instanceof Jc?function(r){return ip(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Zc extends Pu{}class Vo extends Pu{constructor(e){super(),this.elements=e}}function a_(t,e){const n=o_(e);for(const r of t.elements)n.some(a=>tr(a,r))||n.push(r);return{arrayValue:{values:n}}}class Mo extends Pu{constructor(e){super(),this.elements=e}}function i_(t,e){let n=o_(e);for(const r of t.elements)n=n.filter(a=>!tr(a,r));return{arrayValue:{values:n}}}class Jc extends Pu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ay(t){return dt(t.integerValue||t.doubleValue)}function o_(t){return Bf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function gP(t,e){return t.field.isEqual(e.field)&&function(r,a){return r instanceof Vo&&a instanceof Vo||r instanceof Mo&&a instanceof Mo?Za(r.elements,a.elements,tr):r instanceof Jc&&a instanceof Jc?tr(r.Pe,a.Pe):r instanceof Zc&&a instanceof Zc}(t.transform,e.transform)}class vP{constructor(e,n){this.version=e,this.transformResults=n}}class _n{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new _n}static exists(e){return new _n(void 0,e)}static updateTime(e){return new _n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ru{}function l_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Kf(t.key,_n.none()):new tl(t.key,t.data,_n.none());{const n=t.data,r=tn.empty();let a=new Pt(St.comparator);for(let i of e.fields)if(!a.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),a=a.add(i)}return new ws(t.key,r,new dn(a.toArray()),_n.none())}}function yP(t,e,n){t instanceof tl?function(a,i,o){const l=a.value.clone(),u=zy(a.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ws?function(a,i,o){if(!dc(a.precondition,i))return void i.convertToUnknownDocument(o.version);const l=zy(a.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(c_(a)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function co(t,e,n,r){return t instanceof tl?function(i,o,l,u){if(!dc(i.precondition,o))return l;const d=i.value.clone(),h=Ly(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ws?function(i,o,l,u){if(!dc(i.precondition,o))return l;const d=Ly(i.fieldTransforms,u,o),h=o.data;return h.setAll(c_(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,l){return dc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function xP(t,e){let n=null;for(const r of t.fieldTransforms){const a=e.data.field(r.field),i=s_(r.transform,a||null);i!=null&&(n===null&&(n=tn.empty()),n.set(r.field,i))}return n||null}function Dy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Za(r,a,(i,o)=>gP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class tl extends Ru{constructor(e,n,r,a=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ws extends Ru{constructor(e,n,r,a,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function c_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function zy(t,e,n){const r=new Map;$e(t.length===n.length);for(let a=0;a<n.length;a++){const i=t[a],o=i.transform,l=e.data.field(i.field);r.set(i.field,mP(o,l,n[a]))}return r}function Ly(t,e,n){const r=new Map;for(const a of t){const i=a.transform,o=n.data.field(a.field);r.set(a.field,fP(i,o,e))}return r}class Kf extends Ru{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wP extends Ru{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,n,r,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&yP(i,e,r[a])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=co(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=co(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=n_();return this.mutations.forEach(a=>{const i=e.get(a.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(a.key)?null:l;const u=l_(o,l);u!==null&&r.set(a.key,u),o.isValidDocument()||o.convertToNoDocument(Ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Pe())}isEqual(e){return this.batchId===e.batchId&&Za(this.mutations,e.mutations,(n,r)=>Dy(n,r))&&Za(this.baseMutations,e.baseMutations,(n,r)=>Dy(n,r))}}class Gf{constructor(e,n,r,a){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(e,n,r){$e(e.mutations.length===r.length);let a=function(){return cP}();const i=e.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new Gf(e,n,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Le;function bP(t){switch(t){default:return je();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function u_(t){if(t===void 0)return Ir("GRPC error has no .code"),Y.UNKNOWN;switch(t){case mt.OK:return Y.OK;case mt.CANCELLED:return Y.CANCELLED;case mt.UNKNOWN:return Y.UNKNOWN;case mt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case mt.INTERNAL:return Y.INTERNAL;case mt.UNAVAILABLE:return Y.UNAVAILABLE;case mt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case mt.NOT_FOUND:return Y.NOT_FOUND;case mt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case mt.ABORTED:return Y.ABORTED;case mt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case mt.DATA_LOSS:return Y.DATA_LOSS;default:return je()}}(Le=mt||(mt={}))[Le.OK=0]="OK",Le[Le.CANCELLED=1]="CANCELLED",Le[Le.UNKNOWN=2]="UNKNOWN",Le[Le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Le[Le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Le[Le.NOT_FOUND=5]="NOT_FOUND",Le[Le.ALREADY_EXISTS=6]="ALREADY_EXISTS",Le[Le.PERMISSION_DENIED=7]="PERMISSION_DENIED",Le[Le.UNAUTHENTICATED=16]="UNAUTHENTICATED",Le[Le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Le[Le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Le[Le.ABORTED=10]="ABORTED",Le[Le.OUT_OF_RANGE=11]="OUT_OF_RANGE",Le[Le.UNIMPLEMENTED=12]="UNIMPLEMENTED",Le[Le.INTERNAL=13]="INTERNAL",Le[Le.UNAVAILABLE=14]="UNAVAILABLE",Le[Le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=new Os([4294967295,4294967295],0);function Oy(t){const e=kP().encode(t),n=new D0;return n.update(e),new Uint8Array(n.digest())}function Vy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Os([n,r],0),new Os([a,i],0)]}class Qf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gi(`Invalid padding: ${n}`);if(r<0)throw new Gi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Gi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Gi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Os.fromNumber(this.Ie)}Ee(e,n,r){let a=e.add(n.multiply(Os.fromNumber(r)));return a.compare(TP)===1&&(a=new Os([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Oy(e),[r,a]=Vy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,a,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Qf(i,a,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Oy(e),[r,a]=Vy(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,a,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Gi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n,r,a,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const a=new Map;return a.set(e,nl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Au(Ne.min(),a,new at(Ue),Sr(),Pe())}}class nl{constructor(e,n,r,a,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new nl(r,n,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,n,r,a){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=a}}class d_{constructor(e,n){this.targetId=e,this.me=n}}class h_{constructor(e,n,r=At.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=a}}class My{constructor(){this.fe=0,this.ge=Fy(),this.pe=At.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Pe(),n=Pe(),r=Pe();return this.ge.forEach((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:je()}}),new nl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Fy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,$e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class EP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Sr(),this.qe=Uy(),this.Qe=new at(Ue)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:je()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,a)=>{this.ze(a)&&n(a)})}He(e){const n=e.targetId,r=e.me.count,a=this.Je(n);if(a){const i=a.target;if(lp(i))if(r===0){const o=new ye(i.path);this.Ue(n,o,Bt.newNoDocument(o,Ne.min()))}else $e(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:i=0}=n;let o,l;try{o=Gs(r).toUint8Array()}catch(u){if(u instanceof $0)return Qa("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Qf(o,a,i)}catch(u){return Qa(u instanceof Gi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let a=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),a++)}),a}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&lp(l.target)){const u=new ye(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Bt.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Pe();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const a=new Au(e,n,this.Qe,this.ke,r);return this.ke=Sr(),this.qe=Uy(),this.Qe=new at(Ue),a}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,n)?a.Fe(n,1):a.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new My,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Pt(Ue),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ge("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new My),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Uy(){return new at(ye.comparator)}function Fy(){return new at(ye.comparator)}const IP={asc:"ASCENDING",desc:"DESCENDING"},SP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CP={and:"AND",or:"OR"};class PP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function dp(t,e){return t.useProto3Json||Iu(e)?e:{value:e}}function Yc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function p_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function RP(t,e){return Yc(t,e.toTimestamp())}function er(t){return $e(!!t),Ne.fromTimestamp(function(n){const r=ds(n);return new ue(r.seconds,r.nanos)}(t))}function Zf(t,e){return hp(t,e).canonicalString()}function hp(t,e){const n=function(a){return new Ze(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?n:n.child(e)}function f_(t){const e=Ze.fromString(t);return $e(x_(e)),e}function pp(t,e){return Zf(t.databaseId,e.path)}function Wd(t,e){const n=f_(e);if(n.get(1)!==t.databaseId.projectId)throw new he(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new he(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ye(g_(n))}function m_(t,e){return Zf(t.databaseId,e)}function AP(t){const e=f_(t);return e.length===4?Ze.emptyPath():g_(e)}function fp(t){return new Ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function g_(t){return $e(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function By(t,e,n){return{name:pp(t,e),fields:n.value.mapValue.fields}}function DP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:je()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?($e(h===void 0||typeof h=="string"),At.fromBase64String(h||"")):($e(h===void 0||h instanceof Buffer||h instanceof Uint8Array),At.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?Y.UNKNOWN:u_(d.code);return new he(h,d.message||"")}(o);n=new h_(r,a,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Wd(t,r.document.name),i=er(r.document.updateTime),o=r.document.createTime?er(r.document.createTime):Ne.min(),l=new tn({mapValue:{fields:r.document.fields}}),u=Bt.newFoundDocument(a,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new hc(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Wd(t,r.document),i=r.readTime?er(r.readTime):Ne.min(),o=Bt.newNoDocument(a,i),l=r.removedTargetIds||[];n=new hc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Wd(t,r.document),i=r.removedTargetIds||[];n=new hc([],i,a,null)}else{if(!("filter"in e))return je();{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:i}=r,o=new NP(a,i),l=r.targetId;n=new d_(l,o)}}return n}function zP(t,e){let n;if(e instanceof tl)n={update:By(t,e.key,e.value)};else if(e instanceof Kf)n={delete:pp(t,e.key)};else if(e instanceof ws)n={update:By(t,e.key,e.data),updateMask:qP(e.fieldMask)};else{if(!(e instanceof wP))return je();n={verify:pp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Zc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Vo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Mo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Jc)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw je()}(0,r))),e.precondition.isNone||(n.currentDocument=function(a,i){return i.updateTime!==void 0?{updateTime:RP(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:je()}(t,e.precondition)),n}function LP(t,e){return t&&t.length>0?($e(e!==void 0),t.map(n=>function(a,i){let o=a.updateTime?er(a.updateTime):er(i);return o.isEqual(Ne.min())&&(o=er(i)),new vP(o,a.transformResults||[])}(n,e))):[]}function OP(t,e){return{documents:[m_(t,e.path)]}}function VP(t,e){const n={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=m_(t,a);const i=function(d){if(d.length!==0)return y_(Un.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:pa(m.field),direction:FP(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=dp(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:a}}function MP(t){let e=AP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){$e(r===1);const h=n.from[0];h.allDescendants?a=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=v_(f);return m instanceof Un&&K0(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(E){return new Oo(fa(E.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,Iu(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(f){const m=!!f.before,_=f.values||[];return new Qc(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,_=f.values||[];return new Qc(_,m)}(n.endAt)),sP(e,a,o,i,l,"F",u,d)}function UP(t,e){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return je()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function v_(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=fa(n.unaryFilter.field);return vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=fa(n.unaryFilter.field);return vt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fa(n.unaryFilter.field);return vt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=fa(n.unaryFilter.field);return vt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return je()}}(t):t.fieldFilter!==void 0?function(n){return vt.create(fa(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return je()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Un.create(n.compositeFilter.filters.map(r=>v_(r)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return je()}}(n.compositeFilter.op))}(t):je()}function FP(t){return IP[t]}function BP(t){return SP[t]}function $P(t){return CP[t]}function pa(t){return{fieldPath:t.canonicalString()}}function fa(t){return St.fromServerFormat(t.fieldPath)}function y_(t){return t instanceof vt?function(n){if(n.op==="=="){if(Iy(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NAN"}};if(Ey(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Iy(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NAN"}};if(Ey(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(n.field),op:BP(n.op),value:n.value}}}(t):t instanceof Un?function(n){const r=n.getFilters().map(a=>y_(a));return r.length===1?r[0]:{compositeFilter:{op:$P(n.op),filters:r}}}(t):je()}function qP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function x_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n,r,a,i=Ne.min(),o=Ne.min(),l=At.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e){this.ct=e}}function HP(t){const e=MP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?up(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.un=new GP}addToCollectionParentIndex(e,n){return this.un.add(n),ne.resolve()}getCollectionParents(e,n){return ne.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return ne.resolve()}deleteFieldIndex(e,n){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,n){return ne.resolve()}getDocumentsMatchingTarget(e,n){return ne.resolve(null)}getIndexType(e,n){return ne.resolve(0)}getFieldIndexes(e,n){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,n){return ne.resolve(us.min())}getMinOffsetFromCollectionGroup(e,n){return ne.resolve(us.min())}updateCollectionGroup(e,n,r){return ne.resolve()}updateIndexEntries(e,n){return ne.resolve()}}class GP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n]||new Pt(Ze.comparator),i=!a.has(r);return this.index[n]=a.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(e){return(this.index[e]||new Pt(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Xa(0)}static kn(){return new Xa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(){this.changes=new di(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ne.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n,r,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(r!==null&&co(r.mutation,a,dn.empty(),ue.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Pe()){const a=Ds();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,r).next(i=>{let o=Ki();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ds();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Pe()))}populateOverlays(e,n,r){const a=[];return r.forEach(i=>{n.has(i)||a.push(i)}),this.documentOverlayCache.getOverlays(e,a).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,a){let i=Sr();const o=lo(),l=function(){return lo()}();return n.forEach((u,d)=>{const h=r.get(d.key);a.has(d.key)&&(h===void 0||h.mutation instanceof ws)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),co(h.mutation,d,h.mutation.getFieldMask(),ue.now())):o.set(d.key,dn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var f;return l.set(d,new ZP(h,(f=o.get(d))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=lo();let a=new at((o,l)=>o-l),i=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||dn.empty();h=l.applyToLocalView(d,h),r.set(u,h);const f=(a.get(l.batchId)||Pe()).add(u);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,f=n_();h.forEach(m=>{if(!i.has(m)){const _=l_(n.get(m),r.get(m));_!==null&&f.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return ne.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,a){return function(o){return ye.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):J0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,a):this.getDocumentsMatchingCollectionQuery(e,n,r,a)}getNextDocuments(e,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,a).next(i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,a-i.size):ne.resolve(Ds());let l=-1,u=i;return o.next(d=>ne.forEach(d,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?ne.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Pe())).next(h=>({batchId:l,changes:t_(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ye(n)).next(r=>{let a=Ki();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,r,a){const i=n.collectionGroup;let o=Ki();return this.indexManager.getCollectionParents(e,i).next(l=>ne.forEach(l,u=>{const d=function(f,m){return new ui(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,a).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,a))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Bt.newInvalidDocument(h)))});let l=Ki();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&co(h.mutation,d,dn.empty(),ue.now()),Cu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return ne.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(a){return{id:a.id,version:a.version,createTime:er(a.createTime)}}(n)),ne.resolve()}getNamedQuery(e,n){return ne.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(a){return{name:a.name,query:HP(a.bundledQuery),readTime:er(a.readTime)}}(n)),ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.overlays=new at(ye.comparator),this.Ir=new Map}getOverlay(e,n){return ne.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ds();return ne.forEach(n,a=>this.getOverlay(e,a).next(i=>{i!==null&&r.set(a,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((a,i)=>{this.ht(e,n,i)}),ne.resolve()}removeOverlaysForBatchId(e,n,r){const a=this.Ir.get(r);return a!==void 0&&(a.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),ne.resolve()}getOverlaysForCollection(e,n,r){const a=Ds(),i=n.length+1,o=new ye(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&a.set(u.getKey(),u)}return ne.resolve(a)}getOverlaysForCollectionGroup(e,n,r,a){let i=new at((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Ds(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Ds(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=a)););return ne.resolve(l)}ht(e,n,r){const a=this.overlays.get(r.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(r.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _P(n,r));let i=this.Ir.get(n);i===void 0&&(i=Pe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.sessionToken=At.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(){this.Tr=new Pt(Nt.Er),this.dr=new Pt(Nt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Nt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Nt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ye(new Ze([])),r=new Nt(n,e),a=new Nt(n,e+1),i=[];return this.dr.forEachInRange([r,a],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ye(new Ze([])),r=new Nt(n,e),a=new Nt(n,e+1);let i=Pe();return this.dr.forEachInRange([r,a],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Nt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Nt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ye.comparator(e.key,n.key)||Ue(e.wr,n.wr)}static Ar(e,n){return Ue(e.wr,n.wr)||ye.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Pt(Nt.Er)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,a){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new jP(i,n,r,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new Nt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ne.resolve(o)}lookupMutationBatch(e,n){return ne.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,a=this.vr(r),i=a<0?0:a;return ne.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Nt(n,0),a=new Nt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,a],o=>{const l=this.Dr(o.wr);i.push(l)}),ne.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pt(Ue);return n.forEach(a=>{const i=new Nt(a,0),o=new Nt(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),ne.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,a=r.length+1;let i=r;ye.isDocumentKey(i)||(i=i.child(""));const o=new Nt(new ye(i),0);let l=new Pt(Ue);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===a&&(l=l.add(u.wr)),!0)},o),ne.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const a=this.Dr(r);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){$e(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ne.forEach(n.mutations,a=>{const i=new Nt(a.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Nt(n,0),a=this.br.firstAfterOrEqual(r);return ne.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e){this.Mr=e,this.docs=function(){return new at(ye.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,a=this.docs.get(r),i=a?a.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ne.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(e,n){let r=Sr();return n.forEach(a=>{const i=this.docs.get(a);r=r.insert(a,i?i.document.mutableCopy():Bt.newInvalidDocument(a))}),ne.resolve(r)}getDocumentsMatchingQuery(e,n,r,a){let i=Sr();const o=n.path,l=new ye(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||M1(V1(h),r)<=0||(a.has(h.key)||Cu(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return ne.resolve(i)}getAllFromCollectionGroup(e,n,r,a){je()}Or(e,n){return ne.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rR(this)}getSize(e){return ne.resolve(this.size)}}class rR extends QP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?n.push(this.cr.addEntry(e,a)):this.cr.removeEntry(r)}),ne.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e){this.persistence=e,this.Nr=new di(n=>$f(n),qf),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Jf,this.targetCount=0,this.kr=Xa.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,a)=>n(a)),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),ne.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Xa(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,ne.resolve()}updateTargetData(e,n){return this.Kn(n),ne.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,n,r){let a=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),ne.waitFor(i).next(()=>a)}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return ne.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),ne.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const a=this.persistence.referenceDelegate,i=[];return a&&n.forEach(o=>{i.push(a.markPotentiallyOrphaned(e,o))}),ne.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),ne.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return ne.resolve(r)}containsKey(e,n){return ne.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Mf(0),this.Kr=!1,this.Kr=!0,this.$r=new eR,this.referenceDelegate=e(this),this.Ur=new sR(this),this.indexManager=new KP,this.remoteDocumentCache=function(a){return new nR(a)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new WP(n),this.Gr=new YP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new XP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new tR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ge("MemoryPersistence","Starting transaction:",e);const a=new iR(this.Qr.next());return this.referenceDelegate.zr(),r(a).next(i=>this.referenceDelegate.jr(a).next(()=>i)).toPromise().then(i=>(a.raiseOnCommittedEvent(),i))}Hr(e,n){return ne.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class iR extends F1{constructor(e){super(),this.currentSequenceNumber=e}}class Yf{constructor(e){this.persistence=e,this.Jr=new Jf,this.Yr=null}static Zr(e){return new Yf(e)}get Xr(){if(this.Yr)return this.Yr;throw je()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),ne.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),ne.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),ne.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(a=>this.Xr.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.Xr,r=>{const a=ye.fromPath(r);return this.ei(e,a).next(i=>{i||n.removeEntry(a,Ne.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return ne.or([()=>ne.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,n,r,a){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=a}static Wi(e,n){let r=Pe(),a=Pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new Xf(e,n.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return GE()?8:B1(Wt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,a){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,a,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new oR;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,a){return r.documentReadCount<this.ji?(zi()<=Ae.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",ha(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ne.resolve()):(zi()<=Ae.DEBUG&&ge("QueryEngine","Query:",ha(n),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.Hi*a?(zi()<=Ae.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",ha(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xn(n))):ne.resolve())}Yi(e,n){if(Ry(n))return ne.resolve(null);let r=Xn(n);return this.indexManager.getIndexType(e,r).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=up(n,null,"F"),r=Xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Pe(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,o,u.readTime)?this.Yi(e,up(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,a){return Ry(n)||a.isEqual(Ne.min())?ne.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,a)?ne.resolve(null):(zi()<=Ae.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ha(n)),this.rs(e,o,n,O1(a,-1)).next(l=>l))})}ts(e,n){let r=new Pt(X0(e));return n.forEach((a,i)=>{Cu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,a){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Xi(e,n,r){return zi()<=Ae.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",ha(n)),this.Ji.getDocumentsMatchingQuery(e,n,us.min(),r)}rs(e,n,r,a){return this.Ji.getDocumentsMatchingQuery(e,r,a).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,n,r,a){this.persistence=e,this.ss=n,this.serializer=a,this.os=new at(Ue),this._s=new di(i=>$f(i),qf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function uR(t,e,n,r){return new cR(t,e,n,r)}async function w_(t,e){const n=be(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next(i=>(a=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=Pe();for(const d of a){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function dR(t,e){const n=be(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const f=d.batch,m=f.keys();let _=ne.resolve();return m.forEach(E=>{_=_.next(()=>h.getEntry(u,E)).next(w=>{const x=d.docVersions.get(E);$e(x!==null),w.version.compareTo(x)<0&&(f.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))})}),_.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=Pe();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,a))})}function j_(t){const e=be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function hR(t,e){const n=be(t),r=e.snapshotVersion;let a=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});a=n.os;const l=[];e.targetChanges.forEach((h,f)=>{const m=a.get(f);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,f)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(At.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),a=a.insert(f,_),function(w,x,v){return w.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,_,h)&&l.push(n.Ur.updateTargetData(i,_))});let u=Sr(),d=Pe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(pR(i,o,e.documentUpdates).next(h=>{u=h.Ps,d=h.Is})),!r.isEqual(Ne.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return ne.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=a,i))}function pR(t,e,n){let r=Pe(),a=Pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Sr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(l)),u.isNoDocument()&&u.version.isEqual(Ne.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):ge("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:a}})}function fR(t,e){const n=be(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mR(t,e){const n=be(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return n.Ur.getTargetData(r,e).next(i=>i?(a=i,ne.resolve(a)):n.Ur.allocateTargetId(r).next(o=>(a=new Gr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=n.os.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function mp(t,e,n){const r=be(t),a=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!el(o))throw o;ge("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(a.target)}function $y(t,e,n){const r=be(t);let a=Ne.min(),i=Pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const f=be(u),m=f._s.get(h);return m!==void 0?ne.resolve(f.os.get(m)):f.Ur.getTargetData(d,h)}(r,o,Xn(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?a:Ne.min(),n?i:Pe())).next(l=>(gR(r,iP(e),l),{documents:l,Ts:i})))}function gR(t,e,n){let r=t.us.get(e)||Ne.min();n.forEach((a,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class qy{constructor(){this.activeTargetIds=hP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vR{constructor(){this.so=new qy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new qy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ge("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ge("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ql=null;function Hd(){return ql===null?ql=function(){return 268435456+Math.round(2147483648*Math.random())}():ql++,"0x"+ql.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vt="WebChannelConnection";class jR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${a}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${i}`}get Fo(){return!1}Mo(n,r,a,i,o){const l=Hd(),u=this.xo(n,r.toUriEncodedString());ge("RestConnection",`Sending RPC '${n}' ${l}:`,u,a);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,u,d,a).then(h=>(ge("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw Qa("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",u,"request:",a),h})}Lo(n,r,a,i,o,l){return this.Mo(n,r,a,i,o)}Oo(n,r,a){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ci}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),a&&a.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const a=xR[n];return`${this.Do}/v1/${r}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,a){const i=Hd();return new Promise((o,l)=>{const u=new z0;u.setWithCredentials(!0),u.listenOnce(L0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case cc.NO_ERROR:const h=u.getResponseJson();ge(Vt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case cc.TIMEOUT:ge(Vt,`RPC '${e}' ${i} timed out`),l(new he(Y.DEADLINE_EXCEEDED,"Request time out"));break;case cc.HTTP_ERROR:const f=u.getStatus();if(ge(Vt,`RPC '${e}' ${i} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const E=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(v)>=0?v:Y.UNKNOWN}(_.status);l(new he(E,_.message))}else l(new he(Y.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new he(Y.UNAVAILABLE,"Connection failed."));break;default:je()}}finally{ge(Vt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(a);ge(Vt,`RPC '${e}' ${i} sending request:`,a),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const a=Hd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=M0(),l=V0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");ge(Vt,`Creating RPC '${e}' stream ${a}: ${h}`,u);const f=o.createWebChannel(h,u);let m=!1,_=!1;const E=new wR({Io:x=>{_?ge(Vt,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(m||(ge(Vt,`Opening RPC '${e}' stream ${a} transport.`),f.open(),m=!0),ge(Vt,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),w=(x,v,j)=>{x.listen(v,S=>{try{j(S)}catch(R){setTimeout(()=>{throw R},0)}})};return w(f,Hi.EventType.OPEN,()=>{_||(ge(Vt,`RPC '${e}' stream ${a} transport opened.`),E.yo())}),w(f,Hi.EventType.CLOSE,()=>{_||(_=!0,ge(Vt,`RPC '${e}' stream ${a} transport closed`),E.So())}),w(f,Hi.EventType.ERROR,x=>{_||(_=!0,Qa(Vt,`RPC '${e}' stream ${a} transport errored:`,x),E.So(new he(Y.UNAVAILABLE,"The operation could not be completed")))}),w(f,Hi.EventType.MESSAGE,x=>{var v;if(!_){const j=x.data[0];$e(!!j);const S=j,R=S.error||((v=S[0])===null||v===void 0?void 0:v.error);if(R){ge(Vt,`RPC '${e}' stream ${a} received error:`,R);const L=R.status;let U=function(k){const b=mt[k];if(b!==void 0)return u_(b)}(L),N=R.message;U===void 0&&(U=Y.INTERNAL,N="Unknown error status: "+L+" with message "+R.message),_=!0,E.So(new he(U,N)),f.close()}else ge(Vt,`RPC '${e}' stream ${a} received:`,j),E.bo(j)}}),w(l,O0.STAT_EVENT,x=>{x.stat===sp.PROXY?ge(Vt,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===sp.NOPROXY&&ge(Vt,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function Kd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){return new PP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,n,r=1e3,a=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=a,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),a=Math.max(0,n-r);a>0&&ge("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,n,r,a,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new __(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.Yo===n&&this.P_(r,a)},r=>{e(()=>{const a=new he(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(a)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{r(()=>this.I_(a))}),this.stream.onMessage(a=>{r(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ge("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ge("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _R extends N_{constructor(e,n,r,a,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=DP(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ne.min():o.readTime?er(o.readTime):Ne.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=fp(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=lp(u)?{documents:OP(i,u)}:{query:VP(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=p_(i,o.resumeToken);const d=dp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ne.min())>0){l.readTime=Yc(i,o.snapshotVersion.toTimestamp());const d=dp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=UP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=fp(this.serializer),n.removeTarget=e,this.a_(n)}}class NR extends N_{constructor(e,n,r,a,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=LP(e.writeResults,e.commitTime),r=er(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=fp(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>zP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR extends class{}{constructor(e,n,r,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new he(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,hp(n,r),a,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new he(Y.UNKNOWN,i.toString())})}Lo(e,n,r,a,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,hp(n,r),a,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new he(Y.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class kR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ir(n),this.D_=!1):ge("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,n,r,a,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{ta(this)&&(ge("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=be(u);d.L_.add(4),await rl(d),d.q_.set("Unknown"),d.L_.delete(4),await zu(d)}(this))})}),this.q_=new kR(r,a)}}async function zu(t){if(ta(t))for(const e of t.B_)await e(!0)}async function rl(t){for(const e of t.B_)await e(!1)}function b_(t,e){const n=be(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),rm(n)?nm(n):hi(n).r_()&&tm(n,e))}function em(t,e){const n=be(t),r=hi(n);n.N_.delete(e),r.r_()&&k_(n,e),n.N_.size===0&&(r.r_()?r.o_():ta(n)&&n.q_.set("Unknown"))}function tm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hi(t).A_(e)}function k_(t,e){t.Q_.xe(e),hi(t).R_(e)}function nm(t){t.Q_=new EP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),hi(t).start(),t.q_.v_()}function rm(t){return ta(t)&&!hi(t).n_()&&t.N_.size>0}function ta(t){return be(t).L_.size===0}function T_(t){t.Q_=void 0}async function ER(t){t.q_.set("Online")}async function IR(t){t.N_.forEach((e,n)=>{tm(t,e)})}async function SR(t,e){T_(t),rm(t)?(t.q_.M_(e),nm(t)):t.q_.set("Unknown")}async function CR(t,e,n){if(t.q_.set("Online"),e instanceof h_&&e.state===2&&e.cause)try{await async function(a,i){const o=i.cause;for(const l of i.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(r){ge("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Xc(t,r)}else if(e instanceof hc?t.Q_.Ke(e):e instanceof d_?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ne.min()))try{const r=await j_(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.N_.get(u);if(!h)return;i.N_.set(u,h.withResumeToken(At.EMPTY_BYTE_STRING,h.snapshotVersion)),k_(i,u);const f=new Gr(h.target,u,d,h.sequenceNumber);tm(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ge("RemoteStore","Failed to raise snapshot:",r),await Xc(t,r)}}async function Xc(t,e,n){if(!el(e))throw e;t.L_.add(1),await rl(t),t.q_.set("Offline"),n||(n=()=>j_(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ge("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await zu(t)})}function E_(t,e){return e().catch(n=>Xc(t,n,e))}async function Lu(t){const e=be(t),n=hs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;PR(e);)try{const a=await fR(e.localStore,r);if(a===null){e.O_.length===0&&n.o_();break}r=a.batchId,RR(e,a)}catch(a){await Xc(e,a)}I_(e)&&S_(e)}function PR(t){return ta(t)&&t.O_.length<10}function RR(t,e){t.O_.push(e);const n=hs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function I_(t){return ta(t)&&!hs(t).n_()&&t.O_.length>0}function S_(t){hs(t).start()}async function AR(t){hs(t).p_()}async function DR(t){const e=hs(t);for(const n of t.O_)e.m_(n.mutations)}async function zR(t,e,n){const r=t.O_.shift(),a=Gf.from(r,e,n);await E_(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Lu(t)}async function LR(t,e){e&&hs(t).V_&&await async function(r,a){if(function(o){return bP(o)&&o!==Y.ABORTED}(a.code)){const i=r.O_.shift();hs(r).s_(),await E_(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,a)),await Lu(r)}}(t,e),I_(t)&&S_(t)}async function Hy(t,e){const n=be(t);n.asyncQueue.verifyOperationInProgress(),ge("RemoteStore","RemoteStore received new credentials");const r=ta(n);n.L_.add(3),await rl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await zu(n)}async function OR(t,e){const n=be(t);e?(n.L_.delete(2),await zu(n)):e||(n.L_.add(2),await rl(n),n.q_.set("Unknown"))}function hi(t){return t.K_||(t.K_=function(n,r,a){const i=be(n);return i.w_(),new _R(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)}(t.datastore,t.asyncQueue,{Eo:ER.bind(null,t),Ro:IR.bind(null,t),mo:SR.bind(null,t),d_:CR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),rm(t)?nm(t):t.q_.set("Unknown")):(await t.K_.stop(),T_(t))})),t.K_}function hs(t){return t.U_||(t.U_=function(n,r,a){const i=be(n);return i.w_(),new NR(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:AR.bind(null,t),mo:LR.bind(null,t),f_:DR.bind(null,t),g_:zR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Lu(t)):(await t.U_.stop(),t.O_.length>0&&(ge("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,n,r,a,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new jr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,a,i){const o=Date.now()+r,l=new sm(e,n,o,a,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function am(t,e){if(Ir("AsyncQueue",`${e}: ${t}`),el(t))return new he(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ye.comparator(n.key,r.key):(n,r)=>ye.comparator(n.key,r.key),this.keyedMap=Ki(),this.sortedSet=new at(this.comparator)}static emptySet(e){return new Oa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Oa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Oa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(){this.W_=new at(ye.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):je():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ei{constructor(e,n,r,a,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,a,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ei(e,n,Oa.emptySet(n),o,r,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Su(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class MR{constructor(){this.queries=Gy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const a=be(n),i=a.queries;a.queries=Gy(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new he(Y.ABORTED,"Firestore shutting down"))}}function Gy(){return new di(t=>Y0(t),Su)}async function C_(t,e){const n=be(t);let r=3;const a=e.query;let i=n.queries.get(a);i?!i.H_()&&e.J_()&&(r=2):(i=new VR,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(a,!0);break;case 1:i.z_=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(o){const l=am(o,`Initialization of query '${ha(e.query)}' failed`);return void e.onError(l)}n.queries.set(a,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&im(n)}async function P_(t,e){const n=be(t),r=e.query;let a=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?a=e.J_()?0:1:!i.H_()&&e.J_()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function UR(t,e){const n=be(t);let r=!1;for(const a of e){const i=a.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(a)&&(r=!0);o.z_=a}}r&&im(n)}function FR(t,e,n){const r=be(t),a=r.queries.get(e);if(a)for(const i of a.j_)i.onError(n);r.queries.delete(e)}function im(t){t.Y_.forEach(e=>{e.next()})}var gp,Qy;(Qy=gp||(gp={})).ea="default",Qy.Cache="cache";class R_{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new ei(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ei.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==gp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e){this.key=e}}class D_{constructor(e){this.key=e}}class BR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Pe(),this.mutatedKeys=Pe(),this.Aa=X0(e),this.Ra=new Oa(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ky,a=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=a,l=!1;const u=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((h,f)=>{const m=a.get(h),_=Cu(this.query,f)?f:null,E=!!m&&this.mutatedKeys.has(m.key),w=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let x=!1;m&&_?m.data.isEqual(_.data)?E!==w&&(r.track({type:3,doc:_}),x=!0):this.ga(m,_)||(r.track({type:2,doc:_}),x=!0,(u&&this.Aa(_,u)>0||d&&this.Aa(_,d)<0)&&(l=!0)):!m&&_?(r.track({type:0,doc:_}),x=!0):m&&!_&&(r.track({type:1,doc:m}),x=!0,(u||d)&&(l=!0)),x&&(_?(o=o.add(_),i=w?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,a){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(_,E){const w=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return je()}};return w(_)-w(E)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),a=a!=null&&a;const l=n&&!a?this.ya():[],u=this.da.size===0&&this.current&&!a?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new ei(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ky,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new D_(r))}),this.da.forEach(r=>{e.has(r)||n.push(new A_(r))}),n}ba(e){this.Ta=e.Ts,this.da=Pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ei.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class $R{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class qR{constructor(e){this.key=e,this.va=!1}}class WR{constructor(e,n,r,a,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new di(l=>Y0(l),Su),this.Ma=new Map,this.xa=new Set,this.Oa=new at(ye.comparator),this.Na=new Map,this.La=new Jf,this.Ba={},this.ka=new Map,this.qa=Xa.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function HR(t,e,n=!0){const r=U_(t);let a;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.Da()):a=await z_(r,e,n,!0),a}async function KR(t,e){const n=U_(t);await z_(n,e,!0,!1)}async function z_(t,e,n,r){const a=await mR(t.localStore,Xn(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await GR(t,e,i,o==="current",a.resumeToken)),t.isPrimaryClient&&n&&b_(t.remoteStore,a),l}async function GR(t,e,n,r,a){t.Ka=(f,m,_)=>async function(w,x,v,j){let S=x.view.ma(v);S.ns&&(S=await $y(w.localStore,x.query,!1).then(({documents:N})=>x.view.ma(N,S)));const R=j&&j.targetChanges.get(x.targetId),L=j&&j.targetMismatches.get(x.targetId)!=null,U=x.view.applyChanges(S,w.isPrimaryClient,R,L);return Jy(w,x.targetId,U.wa),U.snapshot}(t,f,m,_);const i=await $y(t.localStore,e,!0),o=new BR(e,i.Ts),l=o.ma(i.documents),u=nl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",a),d=o.applyChanges(l,t.isPrimaryClient,u);Jy(t,n,d.wa);const h=new $R(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function QR(t,e,n){const r=be(t),a=r.Fa.get(e),i=r.Ma.get(a.targetId);if(i.length>1)return r.Ma.set(a.targetId,i.filter(o=>!Su(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await mp(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&em(r.remoteStore,a.targetId),vp(r,a.targetId)}).catch(Xo)):(vp(r,a.targetId),await mp(r.localStore,a.targetId,!0))}async function ZR(t,e){const n=be(t),r=n.Fa.get(e),a=n.Ma.get(r.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),em(n.remoteStore,r.targetId))}async function JR(t,e,n){const r=sA(t);try{const a=await function(o,l){const u=be(o),d=ue.now(),h=l.reduce((_,E)=>_.add(E.key),Pe());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=Sr(),w=Pe();return u.cs.getEntries(_,h).next(x=>{E=x,E.forEach((v,j)=>{j.isValidDocument()||(w=w.add(v))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,E)).next(x=>{f=x;const v=[];for(const j of l){const S=xP(j,f.get(j.key).overlayedDocument);S!=null&&v.push(new ws(j.key,S,q0(S.value.mapValue),_n.exists(!0)))}return u.mutationQueue.addMutationBatch(_,d,v,l)}).next(x=>{m=x;const v=x.applyToLocalDocumentSet(f,w);return u.documentOverlayCache.saveOverlays(_,x.batchId,v)})}).then(()=>({batchId:m.batchId,changes:t_(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new at(Ue)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(r,a.batchId,n),await sl(r,a.changes),await Lu(r.remoteStore)}catch(a){const i=am(a,"Failed to persist write");n.reject(i)}}async function L_(t,e){const n=be(t);try{const r=await hR(n.localStore,e);e.targetChanges.forEach((a,i)=>{const o=n.Na.get(i);o&&($e(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?$e(o.va):a.removedDocuments.size>0&&($e(o.va),o.va=!1))}),await sl(n,r,e)}catch(r){await Xo(r)}}function Zy(t,e,n){const r=be(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const u=be(o);u.onlineState=l;let d=!1;u.queries.forEach((h,f)=>{for(const m of f.j_)m.Z_(l)&&(d=!0)}),d&&im(u)}(r.eventManager,e),a.length&&r.Ca.d_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function YR(t,e,n){const r=be(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.Na.get(e),i=a&&a.key;if(i){let o=new at(ye.comparator);o=o.insert(i,Bt.newNoDocument(i,Ne.min()));const l=Pe().add(i),u=new Au(Ne.min(),new Map,new at(Ue),o,l);await L_(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),om(r)}else await mp(r.localStore,e,!1).then(()=>vp(r,e,n)).catch(Xo)}async function XR(t,e){const n=be(t),r=e.batch.batchId;try{const a=await dR(n.localStore,e);V_(n,r,null),O_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await sl(n,a)}catch(a){await Xo(a)}}async function eA(t,e,n){const r=be(t);try{const a=await function(o,l){const u=be(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(f=>($e(f!==null),h=f.keys(),u.mutationQueue.removeMutationBatch(d,f))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);V_(r,e,n),O_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await sl(r,a)}catch(a){await Xo(a)}}function O_(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function V_(t,e,n){const r=be(t);let a=r.Ba[r.currentUser.toKey()];if(a){const i=a.get(e);i&&(n?i.reject(n):i.resolve(),a=a.remove(e)),r.Ba[r.currentUser.toKey()]=a}}function vp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||M_(t,r)})}function M_(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(em(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),om(t))}function Jy(t,e,n){for(const r of n)r instanceof A_?(t.La.addReference(r.key,e),tA(t,r)):r instanceof D_?(ge("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||M_(t,r.key)):je()}function tA(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ge("SyncEngine","New document in limbo: "+n),t.xa.add(r),om(t))}function om(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ye(Ze.fromString(e)),r=t.qa.next();t.Na.set(r,new qR(n)),t.Oa=t.Oa.insert(n,r),b_(t.remoteStore,new Gr(Xn(Wf(n.path)),r,"TargetPurposeLimboResolution",Mf.oe))}}async function sl(t,e,n){const r=be(t),a=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(d){a.push(d);const f=Xf.Wi(u.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(a),await async function(u,d){const h=be(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ne.forEach(d,m=>ne.forEach(m.$i,_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>ne.forEach(m.Ui,_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!el(f))throw f;ge("LocalStore","Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const _=h.os.get(m),E=_.snapshotVersion,w=_.withLastLimboFreeSnapshotVersion(E);h.os=h.os.insert(m,w)}}}(r.localStore,i))}async function nA(t,e){const n=be(t);if(!n.currentUser.isEqual(e)){ge("SyncEngine","User change. New user:",e.toKey());const r=await w_(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new he(Y.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await sl(n,r.hs)}}function rA(t,e){const n=be(t),r=n.Na.get(e);if(r&&r.va)return Pe().add(r.key);{let a=Pe();const i=n.Ma.get(e);if(!i)return a;for(const o of i){const l=n.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function U_(t){const e=be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=L_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YR.bind(null,e),e.Ca.d_=UR.bind(null,e.eventManager),e.Ca.$a=FR.bind(null,e.eventManager),e}function sA(t){const e=be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eA.bind(null,e),e}class eu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Du(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return uR(this.persistence,new lR,e.initialUser,this.serializer)}Ga(e){return new aR(Yf.Zr,this.serializer)}Wa(e){return new vR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eu.provider={build:()=>new eu};class yp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Zy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nA.bind(null,this.syncEngine),await OR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new MR}()}createDatastore(e){const n=Du(e.databaseInfo.databaseId),r=function(i){return new jR(i)}(e.databaseInfo);return function(i,o,l,u){return new bR(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,a,i,o,l){return new TR(r,a,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Zy(this.syncEngine,n,0),function(){return Wy.D()?new Wy:new yR}())}createSyncEngine(e,n){return function(a,i,o,l,u,d,h){const f=new WR(a,i,o,l,u,d);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(a){const i=be(a);ge("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await rl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}yp.provider={build:()=>new yp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ir("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,n,r,a,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=Ut.UNAUTHENTICATED,this.clientId=F0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ge("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ge("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=am(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Gd(t,e){t.asyncQueue.verifyOperationInProgress(),ge("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async a=>{r.isEqual(a)||(await w_(e.localStore,a),r=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Yy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await iA(t);ge("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Hy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,a)=>Hy(e.remoteStore,a)),t._onlineComponents=e}async function iA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ge("FirestoreClient","Using user provided OfflineComponentProvider");try{await Gd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(a){return a.name==="FirebaseError"?a.code===Y.FAILED_PRECONDITION||a.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(n))throw n;Qa("Error using user provided cache. Falling back to memory cache: "+n),await Gd(t,new eu)}}else ge("FirestoreClient","Using default OfflineComponentProvider"),await Gd(t,new eu);return t._offlineComponents}async function B_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ge("FirestoreClient","Using user provided OnlineComponentProvider"),await Yy(t,t._uninitializedComponentsProvider._online)):(ge("FirestoreClient","Using default OnlineComponentProvider"),await Yy(t,new yp))),t._onlineComponents}function oA(t){return B_(t).then(e=>e.syncEngine)}async function $_(t){const e=await B_(t),n=e.eventManager;return n.onListen=HR.bind(null,e.syncEngine),n.onUnlisten=QR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=KR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ZR.bind(null,e.syncEngine),n}function lA(t,e,n={}){const r=new jr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new F_({next:m=>{h.Za(),o.enqueueAndForget(()=>P_(i,f));const _=m.docs.has(l);!_&&m.fromCache?d.reject(new he(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&u.source==="server"?d.reject(new he(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new R_(Wf(l.path),h,{includeMetadataChanges:!0,_a:!0});return C_(i,f)}(await $_(t),t.asyncQueue,e,n,r)),r.promise}function cA(t,e,n={}){const r=new jr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new F_({next:m=>{h.Za(),o.enqueueAndForget(()=>P_(i,f)),m.fromCache&&u.source==="server"?d.reject(new he(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new R_(l,h,{includeMetadataChanges:!0,_a:!0});return C_(i,f)}(await $_(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W_(t,e,n){if(!n)throw new he(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function uA(t,e,n,r){if(e===!0&&r===!0)throw new he(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ex(t){if(!ye.isDocumentKey(t))throw new he(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tx(t){if(ye.isDocumentKey(t))throw new he(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ou(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":je()}function Fn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new he(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ou(t);throw new he(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new he(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new he(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new he(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new he(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new he(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,a){return r.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vu{constructor(e,n,r,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nx({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nx(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new I1;switch(r.type){case"firstParty":return new R1(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new he(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Xy.get(n);r&&(ge("ComponentProvider","Removing Datastore"),Xy.delete(n),r.terminate())}(this),Promise.resolve()}}function dA(t,e,n,r={}){var a;const i=(t=Fn(t,Vu))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Qa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Ut.MOCK_USER;else{l=Qj(r.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new he(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ut(d)}t._authCredentials=new S1(new U0(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new na(this.firestore,e,this._query)}}class Zt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new is(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zt(this.firestore,e,this._key)}}class is extends na{constructor(e,n,r){super(e,n,Wf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new ye(e))}withConverter(e){return new is(this.firestore,e,this._path)}}function xe(t,e,...n){if(t=tt(t),W_("collection","path",e),t instanceof Vu){const r=Ze.fromString(e,...n);return tx(r),new is(t,null,r)}{if(!(t instanceof Zt||t instanceof is))throw new he(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return tx(r),new is(t.firestore,null,r)}}function Ie(t,e,...n){if(t=tt(t),arguments.length===1&&(e=F0.newId()),W_("doc","path",e),t instanceof Vu){const r=Ze.fromString(e,...n);return ex(r),new Zt(t,null,new ye(r))}{if(!(t instanceof Zt||t instanceof is))throw new he(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ze.fromString(e,...n));return ex(r),new Zt(t.firestore,t instanceof is?t.converter:null,new ye(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new __(this,"async_queue_retry"),this.Vu=()=>{const r=Kd();r&&ge("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Kd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Kd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new jr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!el(e))throw e;ge("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Ir("INTERNAL UNHANDLED ERROR: ",a),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const a=sm.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(a),a}fu(){this.Eu&&je()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ra extends Vu{constructor(e,n,r,a){super(e,n,r,a),this.type="firestore",this._queue=new rx,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rx(e),this._firestoreClient=void 0,await e}}}function hA(t,e){const n=typeof t=="object"?t:kf(),r=typeof t=="string"?t:"(default)",a=bu(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const i=Hj("firestore");i&&dA(a,...i)}return a}function lm(t){if(t._terminated)throw new he(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||pA(t),t._firestoreClient}function pA(t){var e,n,r;const a=t._freezeSettings(),i=function(l,u,d,h){return new W1(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,q_(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((n=a.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new aA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ti(At.fromBase64String(e))}catch(n){throw new he(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ti(At.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new he(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new he(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new he(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ue(this._lat,e._lat)||Ue(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,a){if(r.length!==a.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==a[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=/^__.*__$/;class mA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ws(e,this.data,this.fieldMask,n,this.fieldTransforms):new tl(e,this.data,n,this.fieldTransforms)}}class H_{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ws(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function K_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw je()}}class hm{constructor(e,n,r,a,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new hm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Fu({path:r,xu:!1});return a.Ou(e),a}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Fu({path:r,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return tu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(K_(this.Cu)&&fA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class gA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Du(e)}Qu(e,n,r,a=!1){return new hm({Cu:e,methodName:n,qu:r,path:St.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uu(t){const e=t._freezeSettings(),n=Du(t._databaseId);return new gA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function G_(t,e,n,r,a,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,a);pm("Data must be an object, but it was:",o,r);const l=Q_(r,o);let u,d;if(i.merge)u=new dn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=xp(e,f,n);if(!o.contains(m))throw new he(Y.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);J_(h,m)||h.push(m)}u=new dn(h),d=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,d=o.fieldTransforms;return new mA(new tn(l),u,d)}class Fu extends cm{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fu}}function vA(t,e,n,r){const a=t.Qu(1,e,n);pm("Data must be an object, but it was:",a,r);const i=[],o=tn.empty();ea(r,(u,d)=>{const h=fm(e,u,n);d=tt(d);const f=a.Nu(h);if(d instanceof Fu)i.push(h);else{const m=al(d,f);m!=null&&(i.push(h),o.set(h,m))}});const l=new dn(i);return new H_(o,l,a.fieldTransforms)}function yA(t,e,n,r,a,i){const o=t.Qu(1,e,n),l=[xp(e,r,n)],u=[a];if(i.length%2!=0)throw new he(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(xp(e,i[m])),u.push(i[m+1]);const d=[],h=tn.empty();for(let m=l.length-1;m>=0;--m)if(!J_(d,l[m])){const _=l[m];let E=u[m];E=tt(E);const w=o.Nu(_);if(E instanceof Fu)d.push(_);else{const x=al(E,w);x!=null&&(d.push(_),h.set(_,x))}}const f=new dn(d);return new H_(h,f,o.fieldTransforms)}function xA(t,e,n,r=!1){return al(n,t.Qu(r?4:3,e))}function al(t,e){if(Z_(t=tt(t)))return pm("Unsupported field value:",e,t),Q_(t,e);if(t instanceof cm)return function(r,a){if(!K_(a.Cu))throw a.Bu(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(a);i&&a.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,a){const i=[];let o=0;for(const l of r){let u=al(l,a.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,a){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pP(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ue.fromDate(r);return{timestampValue:Yc(a.serializer,i)}}if(r instanceof ue){const i=new ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Yc(a.serializer,i)}}if(r instanceof um)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ti)return{bytesValue:p_(a.serializer,r._byteString)};if(r instanceof Zt){const i=a.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Zf(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof dm)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Hf(l.serializer,u)})}}}}}}(r,a);throw a.Bu(`Unsupported field value: ${Ou(r)}`)}(t,e)}function Q_(t,e){const n={};return B0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ea(t,(r,a)=>{const i=al(a,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Z_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ue||t instanceof um||t instanceof ti||t instanceof Zt||t instanceof cm||t instanceof dm)}function pm(t,e,n){if(!Z_(n)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(n)){const r=Ou(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function xp(t,e,n){if((e=tt(e))instanceof Mu)return e._internalPath;if(typeof e=="string")return fm(t,e);throw tu("Field path arguments must be of type string or ",t,!1,void 0,n)}const wA=new RegExp("[~\\*/\\[\\]]");function fm(t,e,n){if(e.search(wA)>=0)throw tu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Mu(...e.split("."))._internalPath}catch{throw tu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function tu(t,e,n,r,a){const i=r&&!r.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${a}`),u+=")"),new he(Y.INVALID_ARGUMENT,l+t+u)}function J_(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,n,r,a,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Bu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class jA extends Y_{data(){return super.data()}}function Bu(t,e){return typeof e=="string"?fm(t,e):e instanceof Mu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new he(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mm{}class X_ extends mm{}function ke(t,e,...n){let r=[];e instanceof mm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof gm).length,l=i.filter(u=>u instanceof $u).length;if(o>1||o>0&&l>0)throw new he(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)t=a._apply(t);return t}class $u extends X_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new $u(e,n,r)}_apply(e){const n=this._parse(e);return eN(e._query,n),new na(e.firestore,e.converter,cp(e._query,n))}_parse(e){const n=Uu(e.firestore);return function(i,o,l,u,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new he(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ax(f,h);const _=[];for(const E of f)_.push(sx(u,i,E));m={arrayValue:{values:_}}}else m=sx(u,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ax(f,h),m=xA(l,o,f,h==="in"||h==="not-in");return vt.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ve(t,e,n){const r=e,a=Bu("where",t);return $u._create(a,r,n)}class gm extends mm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Un.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(a,i){let o=a;const l=i.getFlattenedFilters();for(const u of l)eN(o,u),o=cp(o,u)}(e._query,n),new na(e.firestore,e.converter,cp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class vm extends X_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new vm(e,n)}_apply(e){const n=function(a,i,o){if(a.startAt!==null)throw new he(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new he(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oo(i,o)}(e._query,this._field,this._direction);return new na(e.firestore,e.converter,function(a,i){const o=a.explicitOrderBy.concat([i]);return new ui(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,n))}}function nr(t,e="asc"){const n=e,r=Bu("orderBy",t);return vm._create(r,n)}function sx(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new he(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!J0(e)&&n.indexOf("/")!==-1)throw new he(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ze.fromString(n));if(!ye.isDocumentKey(r))throw new he(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ty(t,new ye(r))}if(n instanceof Zt)return Ty(t,n._key);throw new he(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ou(n)}.`)}function ax(t,e){if(!Array.isArray(t)||t.length===0)throw new he(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eN(t,e){const n=function(a,i){for(const o of a)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new he(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class NA{convertValue(e,n="none"){switch(Qs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Gs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw je()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ea(e,(a,i)=>{r[a]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,a;const i=(a=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map(o=>dt(o.doubleValue));return new dm(i)}convertGeoPoint(e){return new um(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ff(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Do(e));default:return null}}convertTimestamp(e){const n=ds(e);return new ue(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ze.fromString(e);$e(x_(r));const a=new zo(r.get(1),r.get(3)),i=new ye(r.popFirst(5));return a.isEqual(n)||Ir(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nN extends Y_{constructor(e,n,r,a,i,o){super(e,n,r,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new pc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Bu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class pc extends nN{data(e={}){return super.data(e)}}class bA{constructor(e,n,r,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Qi(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new pc(this._firestore,this._userDataWriter,r.key,r,new Qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new he(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const u=new pc(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Qi(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new pc(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Qi(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:kA(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function kA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return je()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t){t=Fn(t,Zt);const e=Fn(t.firestore,ra);return lA(lm(e),t._key).then(n=>TA(e,t,n))}class rN extends NA{constructor(e){super(),this.firestore=e}convertBytes(e){return new ti(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,n)}}function Se(t){t=Fn(t,na);const e=Fn(t.firestore,ra),n=lm(e),r=new rN(e);return _A(t._query),cA(n,t._query).then(a=>new bA(e,r,t,a))}function sN(t,e,n){t=Fn(t,Zt);const r=Fn(t.firestore,ra),a=tN(t.converter,e,n);return qu(r,[G_(Uu(r),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,_n.none())])}function $t(t,e,n,...r){t=Fn(t,Zt);const a=Fn(t.firestore,ra),i=Uu(a);let o;return o=typeof(e=tt(e))=="string"||e instanceof Mu?yA(i,"updateDoc",t._key,e,n,r):vA(i,"updateDoc",t._key,e),qu(a,[o.toMutation(t._key,_n.exists(!0))])}function Vn(t){return qu(Fn(t.firestore,ra),[new Kf(t._key,_n.none())])}function on(t,e){const n=Fn(t.firestore,ra),r=Ie(t),a=tN(t.converter,e);return qu(n,[G_(Uu(t.firestore),"addDoc",r._key,a,t.converter!==null,{}).toMutation(r._key,_n.exists(!1))]).then(()=>r)}function qu(t,e){return function(r,a){const i=new jr;return r.asyncQueue.enqueueAndForget(async()=>JR(await oA(r),a,i)),i.promise}(lm(t),e)}function TA(t,e,n){const r=n.docs.get(e._key),a=new rN(t);return new nN(t,a,e._key,r,new Qi(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(a){ci=a})(Xs),qs(new cs("firestore",(r,{instanceIdentifier:a,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new ra(new C1(r.getProvider("auth-internal")),new D1(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new he(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zo(d.options.projectId,h)}(o,a),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Jn(jy,"4.7.3",e),Jn(jy,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN="firebasestorage.googleapis.com",iN="storageBucket",EA=2*60*1e3,IA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct extends or{constructor(e,n,r=0){super(Qd(e),`Firebase Storage: ${n} (${Qd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ct.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Qd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var lt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(lt||(lt={}));function Qd(t){return"storage/"+t}function ym(){const t="An unknown error occurred, please check the error payload for server response.";return new ct(lt.UNKNOWN,t)}function SA(t){return new ct(lt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function CA(t){return new ct(lt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function PA(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ct(lt.UNAUTHENTICATED,t)}function RA(){return new ct(lt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function AA(t){return new ct(lt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function DA(){return new ct(lt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zA(){return new ct(lt.CANCELED,"User canceled the upload/download.")}function LA(t){return new ct(lt.INVALID_URL,"Invalid URL '"+t+"'.")}function OA(t){return new ct(lt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function VA(){return new ct(lt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iN+"' property when initializing the app?")}function MA(){return new ct(lt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function UA(){return new ct(lt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function FA(t){return new ct(lt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function wp(t){return new ct(lt.INVALID_ARGUMENT,t)}function oN(){return new ct(lt.APP_DELETED,"The Firebase app was deleted.")}function BA(t){return new ct(lt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function uo(t,e){return new ct(lt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Li(t){throw new ct(lt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=pn.makeFromUrl(e,n)}catch{return new pn(e,"")}if(r.path==="")return r;throw OA(e)}static makeFromUrl(e,n){let r=null;const a="([A-Za-z0-9.\\-_]+)";function i(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+a+o,"i"),u={bucket:1,path:3};function d(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${f}/${h}/b/${a}/o${m}`,"i"),E={bucket:1,path:3},w=n===aN?"(?:storage.googleapis.com|storage.cloud.google.com)":n,x="([^?#]*)",v=new RegExp(`^https?://${w}/${a}/${x}`,"i"),S=[{regex:l,indices:u,postModify:i},{regex:_,indices:E,postModify:d},{regex:v,indices:{bucket:1,path:2},postModify:d}];for(let R=0;R<S.length;R++){const L=S[R],U=L.regex.exec(e);if(U){const N=U[L.indices.bucket];let y=U[L.indices.path];y||(y=""),r=new pn(N,y),L.postModify(r);break}}if(r==null)throw LA(e);return r}}class $A{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(t,e,n){let r=1,a=null,i=null,o=!1,l=0;function u(){return l===2}let d=!1;function h(...x){d||(d=!0,e.apply(null,x))}function f(x){a=setTimeout(()=>{a=null,t(_,u())},x)}function m(){i&&clearTimeout(i)}function _(x,...v){if(d){m();return}if(x){m(),h.call(null,x,...v);return}if(u()||o){m(),h.call(null,x,...v);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,f(S)}let E=!1;function w(x){E||(E=!0,m(),!d&&(a!==null?(x||(l=2),clearTimeout(a),f(0)):x||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,w(!0)},n),w}function WA(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){return t!==void 0}function KA(t){return typeof t=="object"&&!Array.isArray(t)}function xm(t){return typeof t=="string"||t instanceof String}function ix(t){return wm()&&t instanceof Blob}function wm(){return typeof Blob<"u"}function ox(t,e,n,r){if(r<e)throw wp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw wp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function lN(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const a=e(r)+"="+e(t[r]);n=n+a+"&"}return n=n.slice(0,-1),n}var Vs;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Vs||(Vs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t,e){const n=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||a||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e,n,r,a,i,o,l,u,d,h,f,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=a,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){const e=(r,a)=>{if(a){r(!1,new Wl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Vs.NO_ERROR,u=i.getStatus();if(!l||GA(u,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Vs.ABORT;r(!1,new Wl(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new Wl(d,i))})},n=(r,a)=>{const i=this.resolve_,o=this.reject_,l=a.connection;if(a.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());HA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=ym();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(a.canceled){const u=this.appDelete_?oN():zA();o(u)}else{const u=DA();o(u)}};this.canceled_?n(!1,new Wl(!1,null,!0)):this.backoffId_=qA(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&WA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function ZA(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function JA(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function YA(t,e){e&&(t["X-Firebase-GMPID"]=e)}function XA(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eD(t,e,n,r,a,i,o=!0){const l=lN(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return YA(d,e),ZA(d,n),JA(d,i),XA(d,r),new QA(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nD(...t){const e=tD();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(wm())return new Blob(t);throw new ct(lt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function rD(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sD(t){if(typeof atob>"u")throw FA("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zd{constructor(e,n){this.data=e,this.contentType=n||null}}function aD(t,e){switch(t){case Gn.RAW:return new Zd(cN(e));case Gn.BASE64:case Gn.BASE64URL:return new Zd(uN(t,e));case Gn.DATA_URL:return new Zd(oD(e),lD(e))}throw ym()}function cN(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function iD(t){let e;try{e=decodeURIComponent(t)}catch{throw uo(Gn.DATA_URL,"Malformed data URL.")}return cN(e)}function uN(t,e){switch(t){case Gn.BASE64:{const a=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(a||i)throw uo(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Gn.BASE64URL:{const a=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(a||i)throw uo(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=sD(e)}catch(a){throw a.message.includes("polyfill")?a:uo(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}class dN{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw uo(Gn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=cD(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function oD(t){const e=new dN(t);return e.base64?uN(Gn.BASE64,e.rest):iD(e.rest)}function lD(t){return new dN(t).contentType}function cD(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n){let r=0,a="";ix(e)?(this.data_=e,r=e.size,a=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,n){if(ix(this.data_)){const r=this.data_,a=rD(r,e,n);return a===null?null:new qr(a)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new qr(r,!0)}}static getBlob(...e){if(wm()){const n=e.map(r=>r instanceof qr?r.data_:r);return new qr(nD.apply(null,n))}else{const n=e.map(o=>xm(o)?aD(Gn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const a=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)a[i++]=o[l]}),new qr(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hN(t){let e;try{e=JSON.parse(t)}catch{return null}return KA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function dD(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function pN(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(t,e){return e}class Kt{constructor(e,n,r,a){this.server=e,this.local=n||e,this.writable=!!r,this.xform=a||hD}}let Hl=null;function pD(t){return!xm(t)||t.length<2?t:pN(t)}function fN(){if(Hl)return Hl;const t=[];t.push(new Kt("bucket")),t.push(new Kt("generation")),t.push(new Kt("metageneration")),t.push(new Kt("name","fullPath",!0));function e(i,o){return pD(o)}const n=new Kt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const a=new Kt("size");return a.xform=r,t.push(a),t.push(new Kt("timeCreated")),t.push(new Kt("updated")),t.push(new Kt("md5Hash",null,!0)),t.push(new Kt("cacheControl",null,!0)),t.push(new Kt("contentDisposition",null,!0)),t.push(new Kt("contentEncoding",null,!0)),t.push(new Kt("contentLanguage",null,!0)),t.push(new Kt("contentType",null,!0)),t.push(new Kt("metadata","customMetadata",!0)),Hl=t,Hl}function fD(t,e){function n(){const r=t.bucket,a=t.fullPath,i=new pn(r,a);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function mD(t,e,n){const r={};r.type="file";const a=n.length;for(let i=0;i<a;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return fD(r,t),r}function mN(t,e,n){const r=hN(e);return r===null?null:mD(t,r,n)}function gD(t,e,n,r){const a=hN(e);if(a===null||!xm(a.downloadTokens))return null;const i=a.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),_=Wu(m,n,r),E=lN({alt:"media",token:d});return _+E})[0]}function vD(t,e){const n={},r=e.length;for(let a=0;a<r;a++){const i=e[a];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class jm{constructor(e,n,r,a){this.url=e,this.method=n,this.handler=r,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gN(t){if(!t)throw ym()}function yD(t,e){function n(r,a){const i=mN(t,a,e);return gN(i!==null),i}return n}function xD(t,e){function n(r,a){const i=mN(t,a,e);return gN(i!==null),gD(i,a,t.host,t._protocol)}return n}function vN(t){function e(n,r){let a;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?a=RA():a=PA():n.getStatus()===402?a=CA(t.bucket):n.getStatus()===403?a=AA(t.path):a=r,a.status=n.getStatus(),a.serverResponse=r.serverResponse,a}return e}function yN(t){const e=vN(t);function n(r,a){let i=e(r,a);return r.getStatus()===404&&(i=SA(t.path)),i.serverResponse=a.serverResponse,i}return n}function wD(t,e,n){const r=e.fullServerUrl(),a=Wu(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new jm(a,i,xD(t,n),o);return l.errorHandler=yN(e),l}function jD(t,e){const n=e.fullServerUrl(),r=Wu(n,t.host,t._protocol),a="DELETE",i=t.maxOperationRetryTime;function o(u,d){}const l=new jm(r,a,o,i);return l.successCodes=[200,204],l.errorHandler=yN(e),l}function _D(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function ND(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=_D(null,e)),r}function bD(t,e,n,r,a){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let R=0;R<2;R++)S=S+Math.random().toString().slice(2);return S}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const d=ND(e,r,a),h=vD(d,n),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+u+"--",_=qr.getBlob(f,r,m);if(_===null)throw MA();const E={name:d.fullPath},w=Wu(i,t.host,t._protocol),x="POST",v=t.maxUploadRetryTime,j=new jm(w,x,yD(t,n),v);return j.urlParams=E,j.headers=o,j.body=_.uploadData(),j.errorHandler=vN(e),j}class kD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,a){if(this.sent_)throw Li("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),a!==void 0)for(const i in a)a.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,a[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Li("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Li("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Li("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Li("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class TD extends kD{initXhr(){this.xhr_.responseType="text"}}function _m(){return new TD}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n){this._service=e,n instanceof pn?this._location=n:this._location=pn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Zs(e,n)}get root(){const e=new pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pN(this._location.path)}get storage(){return this._service}get parent(){const e=uD(this._location.path);if(e===null)return null;const n=new pn(this._location.bucket,e);return new Zs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw BA(e)}}function ED(t,e,n){t._throwIfRoot("uploadBytes");const r=bD(t.storage,t._location,fN(),new qr(e,!0),n);return t.storage.makeRequestWithTokens(r,_m).then(a=>({metadata:a,ref:t}))}function ID(t){t._throwIfRoot("getDownloadURL");const e=wD(t.storage,t._location,fN());return t.storage.makeRequestWithTokens(e,_m).then(n=>{if(n===null)throw UA();return n})}function SD(t){t._throwIfRoot("deleteObject");const e=jD(t.storage,t._location);return t.storage.makeRequestWithTokens(e,_m)}function CD(t,e){const n=dD(t._location.path,e),r=new pn(t._location.bucket,n);return new Zs(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(t){return/^[A-Za-z]+:\/\//.test(t)}function RD(t,e){return new Zs(t,e)}function xN(t,e){if(t instanceof Nm){const n=t;if(n._bucket==null)throw VA();const r=new Zs(n,n._bucket);return e!=null?xN(r,e):r}else return e!==void 0?CD(t,e):t}function AD(t,e){if(e&&PD(e)){if(t instanceof Nm)return RD(t,e);throw wp("To use ref(service, url), the first argument must be a Storage instance.")}else return xN(t,e)}function lx(t,e){const n=e==null?void 0:e[iN];return n==null?null:pn.makeFromBucketSpec(n,t)}function DD(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:a}=r;a&&(t._overrideAuthToken=typeof a=="string"?a:Qj(a,t.app.options.projectId))}class Nm{constructor(e,n,r,a,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=a,this._firebaseVersion=i,this._bucket=null,this._host=aN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=EA,this._maxUploadRetryTime=IA,this._requests=new Set,a!=null?this._bucket=pn.makeFromBucketSpec(a,this._host):this._bucket=lx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,e):this._bucket=lx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ox("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ox("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Zs(this,e)}_makeRequest(e,n,r,a,i=!0){if(this._deleted)return new $A(oN());{const o=eD(e,this._appId,r,a,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,a).getPromise()}}const cx="@firebase/storage",ux="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wN="storage";function zD(t,e,n){return t=tt(t),ED(t,e,n)}function LD(t){return t=tt(t),ID(t)}function OD(t){return t=tt(t),SD(t)}function dx(t,e){return t=tt(t),AD(t,e)}function VD(t=kf(),e){t=tt(t);const r=bu(t,wN).getImmediate({identifier:e}),a=Hj("storage");return a&&MD(r,...a),r}function MD(t,e,n,r={}){DD(t,e,n,r)}function UD(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new Nm(n,r,a,e,Xs)}function FD(){qs(new cs(wN,UD,"PUBLIC").setMultipleInstances(!0)),Jn(cx,ux,""),Jn(cx,ux,"esm2017")}FD();const BD={apiKey:"AIzaSyApJWhSahWIITIe_qpfcdsS852xc2jZ9Yc",authDomain:"sailplan-5018e.firebaseapp.com",projectId:"sailplan-5018e",storageBucket:"sailplan-5018e.firebasestorage.app",messagingSenderId:"638121403294",appId:"1:638121403294:web:7a4961951d112e9f646c8f"},bm=Yj(BD),Hn=b1(bm),se=hA(bm),hx=VD(bm);function yt(){const[t,e]=C.useState(null),[n,r]=C.useState(!0);return C.useEffect(()=>{const a=pC(Hn,i=>{e(i),r(!1)});return()=>a()},[]),{user:t,loading:n}}function $D(){return s.jsxs("div",{className:"landing",children:[s.jsx("header",{className:"header",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"header-inner",children:[s.jsxs(ie,{to:"/",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsx("nav",{className:"nav",children:s.jsxs("ul",{className:"nav-links",children:[s.jsx("li",{children:s.jsx("a",{href:"#features",className:"nav-link",children:"Funkce"})}),s.jsx("li",{children:s.jsx("a",{href:"#how-it-works",className:"nav-link",children:"Jak to funguje"})}),s.jsx("li",{children:s.jsx("a",{href:"#pricing",className:"nav-link",children:"Cenk"})})]})}),s.jsxs("div",{className:"header-actions",children:[s.jsx(ie,{to:"/login",className:"btn btn-ghost",children:"Pihlsit se"}),s.jsx(ie,{to:"/register",className:"btn btn-primary",children:"Registrace"})]})]})})}),s.jsxs("section",{className:"hero",children:[s.jsx("div",{className:"floating-element",style:{fontSize:"4rem",color:"var(--turquoise)"},children:s.jsx("i",{className:"fas fa-anchor"})}),s.jsx("div",{className:"floating-element",style:{fontSize:"3rem",color:"var(--coral)"},children:s.jsx("i",{className:"fas fa-compass"})}),s.jsx("div",{className:"floating-element",style:{fontSize:"3.5rem",color:"var(--turquoise-light)"},children:s.jsx("i",{className:"fas fa-life-ring"})}),s.jsx("div",{className:"container",children:s.jsxs("div",{className:"hero-content animate-in",children:[s.jsxs("h1",{children:["Organizujte plavby ",s.jsx("span",{children:"bez stresu"})]}),s.jsx("p",{children:"Kompletn platforma pro sprvu jachtovch plaveb. Od plnovn pes rozdlen posdky a po pedvn lod  ve na jednom mst."}),s.jsx("div",{className:"hero-buttons",children:s.jsxs(ie,{to:"/register",className:"btn btn-coral btn-lg",children:[s.jsx("i",{className:"fas fa-rocket"}),"Zat zdarma"]})})]})})]}),s.jsx("section",{id:"features",className:"features",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"section-header animate-in",children:[s.jsx("h2",{children:"Ve co potebujete pro spnou plavbu"}),s.jsx("p",{children:"SailPlan nabz kompletn sadu nstroj pro organiztory, kapitny i astnky plaveb."})]}),s.jsxs("div",{className:"features-grid",children:[s.jsxs("div",{className:"card feature-card animate-in delay-1",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"Sprva plaveb"}),s.jsx("p",{children:"Organizujte plavby s jednou nebo vce lodmi. Piazujte astnky, sledujte kapacity a spravujte posdky."})]}),s.jsxs("div",{className:"card feature-card animate-in delay-2",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"Chytr checklisty"}),s.jsx("p",{children:"Vytvote si vlastn checklisty pro pedvn lod, balen zavazadel nebo cokoliv jinho. Ve pehledn na jednom mst."})]}),s.jsxs("div",{className:"card feature-card animate-in delay-3",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"Crew listy"}),s.jsx("p",{children:"Sbrejte dleit daje od astnk automaticky. Definujte jak informace potebujete od posdky i kapitn."})]}),s.jsxs("div",{className:"card feature-card animate-in delay-4",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"Sledovn plateb"}),s.jsx("p",{children:"Mjte pehled o zlohch a platbch. Pipomnky termn a jasn pehled kdo co zaplatil."})]}),s.jsxs("div",{className:"card feature-card animate-in delay-1",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"Trasy a lokace"}),s.jsx("p",{children:"Sdlejte informace o mst startu, trase i cli plavby. Vetn tip na dopravu a praktickch informac."})]}),s.jsxs("div",{className:"card feature-card animate-in delay-2",children:[s.jsx("div",{className:"feature-icon",children:""}),s.jsx("h4",{children:"asov osa"}),s.jsx("p",{children:"Hlavn timeline s dleitmi termny. Od zaplacen zlohy pes vyplnn crew listu a po den odjezdu."})]})]})]})}),s.jsx("section",{id:"how-it-works",style:{padding:"var(--space-3xl) 0",background:"white"},children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{children:"Ti pohledy, jeden systm"}),s.jsx("p",{children:"Kad uivatel vid to, co potebuje. A u jste organiztor, kapitn nebo astnk."})]}),s.jsxs("div",{className:"features-grid",style:{marginTop:"var(--space-2xl)"},children:[s.jsxs("div",{className:"card",style:{border:"2px solid transparent",transition:"all 0.3s"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:"var(--space-lg)"},children:[s.jsx("div",{style:{width:"56px",height:"56px",background:"linear-gradient(135deg, var(--coral), var(--coral-light))",borderRadius:"var(--radius-lg)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem"},children:s.jsx("i",{className:"fas fa-crown"})}),s.jsxs("div",{children:[s.jsx("h4",{style:{margin:0},children:"Organiztor"}),s.jsx("span",{className:"text-muted text-sm",children:"Pln kontrola"})]})]}),s.jsx("p",{className:"text-muted",children:"Vytvejte plavby, piazujte astnky do lod, sledujte platby a crew listy. Kompletn pehled o vech lodch a posdkch."})]}),s.jsxs("div",{className:"card",style:{border:"2px solid transparent",transition:"all 0.3s"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:"var(--space-lg)"},children:[s.jsx("div",{style:{width:"56px",height:"56px",background:"linear-gradient(135deg, var(--turquoise), var(--ocean-light))",borderRadius:"var(--radius-lg)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem"},children:s.jsx("i",{className:"fas fa-ship"})}),s.jsxs("div",{children:[s.jsx("h4",{style:{margin:0},children:"Kapitn"}),s.jsx("span",{className:"text-muted text-sm",children:"Veden lod"})]})]}),s.jsx("p",{className:"text-muted",children:"Pstup ke crew listu va lod, checklisty pro pedn a vracen lod. Vechny informace o va posdce."})]}),s.jsxs("div",{className:"card",style:{border:"2px solid transparent",transition:"all 0.3s"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:"var(--space-lg)"},children:[s.jsx("div",{style:{width:"56px",height:"56px",background:"linear-gradient(135deg, var(--ocean-mid), var(--ocean-light))",borderRadius:"var(--radius-lg)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.5rem"},children:s.jsx("i",{className:"fas fa-user"})}),s.jsxs("div",{children:[s.jsx("h4",{style:{margin:0},children:"astnk"}),s.jsx("span",{className:"text-muted text-sm",children:"Posdka"})]})]}),s.jsx("p",{className:"text-muted",children:"Vyplte crew list, sledujte termny, zjistte do kter lod patte a kdo je vae posdka. Ve pehledn na jednom mst."})]})]})]})}),s.jsx("section",{id:"pricing",className:"features",children:s.jsxs("div",{className:"container container-narrow",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{children:"Jednoduch cenk"}),s.jsx("p",{children:"Aktuln je SailPlan zcela zdarma. Do budoucna plnujeme prmiov funkce."})]}),s.jsxs("div",{className:"card",style:{textAlign:"center",padding:"var(--space-3xl)",border:"2px solid var(--turquoise)"},children:[s.jsx("div",{style:{display:"inline-block",background:"var(--success-light)",color:"var(--success)",padding:"4px 16px",borderRadius:"var(--radius-full)",fontSize:"0.875rem",fontWeight:600,marginBottom:"var(--space-lg)"},children:"Aktuln dostupn"}),s.jsx("h3",{style:{fontSize:"2.5rem",marginBottom:"var(--space-sm)"},children:"Zdarma"}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:"Vechny funkce bez omezen"}),s.jsxs("ul",{style:{listStyle:"none",textAlign:"left",maxWidth:"300px",margin:"0 auto var(--space-xl)"},children:[s.jsxs("li",{style:{padding:"var(--space-sm) 0",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check",style:{color:"var(--success)"}}),"Neomezen poet plaveb"]}),s.jsxs("li",{style:{padding:"var(--space-sm) 0",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check",style:{color:"var(--success)"}}),"Neomezen poet astnk"]}),s.jsxs("li",{style:{padding:"var(--space-sm) 0",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check",style:{color:"var(--success)"}}),"Vlastn checklisty a templaty"]}),s.jsxs("li",{style:{padding:"var(--space-sm) 0",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check",style:{color:"var(--success)"}}),"Crew listy a sprva posdky"]}),s.jsxs("li",{style:{padding:"var(--space-sm) 0",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check",style:{color:"var(--success)"}}),"Sledovn plateb"]})]}),s.jsxs(ie,{to:"/register",className:"btn btn-primary btn-lg",children:[s.jsx("i",{className:"fas fa-rocket"}),"Zat pouvat"]})]})]})}),s.jsx("section",{style:{background:"linear-gradient(135deg, var(--ocean-deep), var(--ocean-mid))",padding:"var(--space-3xl) 0",textAlign:"center"},children:s.jsxs("div",{className:"container",children:[s.jsx("h2",{style:{color:"white",marginBottom:"var(--space-md)"},children:"Pipraveni vyplout?"}),s.jsx("p",{style:{color:"var(--gray-400)",marginBottom:"var(--space-xl)",maxWidth:"500px",marginLeft:"auto",marginRight:"auto"},children:"Zaregistrujte se zdarma a zante organizovat sv plavby profesionln."}),s.jsxs(ie,{to:"/register",className:"btn btn-coral btn-lg",children:[s.jsx("i",{className:"fas fa-sailboat"}),"Vytvoit et zdarma"]})]})}),s.jsx("footer",{className:"footer",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"footer-grid",children:[s.jsxs("div",{className:"footer-brand",children:[s.jsxs(ie,{to:"/",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsx("p",{children:"Modern platforma pro organizaci jachtovch plaveb. Vytvoeno s lskou pro nmonky."})]}),s.jsxs("div",{className:"footer-links",children:[s.jsx("h5",{children:"Produkt"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"#features",children:"Funkce"})}),s.jsx("li",{children:s.jsx("a",{href:"#pricing",children:"Cenk"})})]})]}),s.jsxs("div",{className:"footer-links",children:[s.jsx("h5",{children:"Podpora"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"#",children:"Npovda"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"Kontakt"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"FAQ"})})]})]}),s.jsxs("div",{className:"footer-links",children:[s.jsx("h5",{children:"Prvn"}),s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("a",{href:"#",children:"Podmnky pouit"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"Ochrana soukrom"})}),s.jsx("li",{children:s.jsx("a",{href:"#",children:"GDPR"})})]})]})]}),s.jsxs("div",{className:"footer-bottom",children:[s.jsx("p",{children:" 2025 SailPlan. Vechna prva vyhrazena."}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)"},children:[s.jsx("a",{href:"#",style:{color:"var(--gray-400)"},children:s.jsx("i",{className:"fab fa-facebook"})}),s.jsx("a",{href:"#",style:{color:"var(--gray-400)"},children:s.jsx("i",{className:"fab fa-instagram"})}),s.jsx("a",{href:"#",style:{color:"var(--gray-400)"},children:s.jsx("i",{className:"fab fa-twitter"})})]})]})]})})]})}const Va={async signUp(t,e,n){try{const r=await oC(Hn,t,e);return n&&await uC(r.user,{displayName:n}),{user:r.user,error:null}}catch(r){return{user:null,error:r.message}}},async signIn(t,e){try{return{user:(await lC(Hn,t,e)).user,error:null}}catch(n){return{user:null,error:n.message}}},async signInWithGoogle(){try{const t=new pr,n=(await AC(Hn,t)).user;return{user:n,userData:{email:n.email||"",displayName:n.displayName||"",phoneNumber:n.phoneNumber||"",photoURL:n.photoURL||""},error:null}}catch(t){if(Hn.currentUser&&t.code==="auth/popup-closed-by-user"){const e=Hn.currentUser;return{user:e,userData:{email:e.email||"",displayName:e.displayName||"",phoneNumber:e.phoneNumber||"",photoURL:e.photoURL||""},error:null}}return{user:null,userData:null,error:t.message}}},async signOut(){try{return await zf(Hn),{error:null}}catch(t){return{error:t.message}}}},px="userProfiles",ps={async saveProfile(t,e){try{const n=Ie(se,px,t);return await sN(n,{...e,updatedAt:ue.now()},{merge:!0}),{error:null}}catch(n){return{error:n.message}}},async getProfile(t){try{const e=Ie(se,px,t),n=await hn(e);return n.exists()?{data:n.data(),error:null}:{data:null,error:null}}catch(e){return{data:null,error:e.message}}}};async function fc(t){var e,n,r;if(!t)return!1;try{const{data:a,error:i}=await ps.getProfile(t);if(i||!a)return!1;const o=((e=a.name)==null?void 0:e.trim())||"",l=((n=a.phone)==null?void 0:n.trim())||"",u=((r=a.email)==null?void 0:r.trim())||"";return o.length>=2&&l.length>0&&u.length>0}catch(a){return console.error("Error checking required profile fields:",a),!1}}function qD(t){var i,o,l;const e={},n=((i=t.name)==null?void 0:i.trim())||"",r=((o=t.phone)==null?void 0:o.trim())||"",a=((l=t.email)==null?void 0:l.trim())||"";return n.length<2&&(e.name="Jmno a pjmen mus obsahovat alespo 2 znaky"),r.length===0&&(e.phone="Telefon je povinn"),a.length===0?e.email="Email je povinn":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||(e.email="Email nen ve sprvnm formtu"),{valid:Object.keys(e).length===0,errors:e}}function WD(){const[t,e]=C.useState(!1),[n,r]=C.useState(""),[a,i]=C.useState(""),[o,l]=C.useState(""),[u,d]=C.useState(""),[h,f]=C.useState(!1),m=_t(),_=async w=>{if(w.preventDefault(),d(""),f(!0),t){const{user:x,error:v}=await Va.signUp(n,a,o);if(v)d(v),f(!1);else if(x){const j=await fc(x.uid);m(j?"/dashboard":"/onboarding?mode=onboarding")}}else{const{user:x,error:v}=await Va.signIn(n,a);if(v)d(v),f(!1);else if(x){const j=await fc(x.uid);m(j?"/dashboard":"/onboarding?mode=onboarding")}}},E=async()=>{d(""),f(!0);const{user:w,error:x}=await Va.signInWithGoogle();if(x)d(x),f(!1);else if(w){const v=await fc(w.uid);m(v?"/dashboard":"/onboarding?mode=onboarding")}};return s.jsx("div",{className:"login-page",children:s.jsxs("div",{className:"login-container",children:[s.jsxs(ie,{to:"/",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsxs("div",{className:"login-card",children:[s.jsx("h1",{children:t?"Vytvoit et":"Pihlsit se"}),s.jsx("p",{className:"subtitle",children:t?"Zaregistrujte se a zante organizovat plavby":"Pihlaste se do svho tu"}),u&&s.jsx("div",{className:"error-message",children:u}),s.jsxs("form",{id:"login-form",onSubmit:_,className:"login-form",children:[t&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jmno"}),s.jsx("input",{type:"text",value:o,onChange:w=>l(w.target.value),placeholder:"Vae jmno"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",value:n,onChange:w=>r(w.target.value),placeholder:"vas@email.cz",required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Heslo"}),s.jsx("input",{type:"password",value:a,onChange:w=>i(w.target.value),placeholder:"",required:!0,minLength:6})]})]}),s.jsxs("div",{style:{marginTop:"var(--space-md)"},children:[s.jsx("button",{type:"submit",form:"login-form",className:"btn btn-primary btn-block",disabled:h,children:h?"Natn...":t?"Vytvoit et":"Pihlsit se"}),s.jsx("div",{style:{textAlign:"center",margin:"var(--space-xs) 0",color:"var(--gray-500)",fontSize:"0.875rem"},children:"nebo"}),s.jsxs("button",{type:"button",className:"btn btn-google btn-block",onClick:E,disabled:h,children:[s.jsxs("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"20",height:"20",children:[s.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),s.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),s.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),s.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Pokraovat s Google"]})]}),s.jsx("div",{className:"login-footer",children:!t&&s.jsxs("p",{style:{textAlign:"center",margin:0,color:"var(--gray-600)",fontSize:"0.875rem"},children:["Nemte et?"," ",s.jsx(ie,{to:"/register",className:"link-button",children:"Zaregistrujte se"})]})})]})]})})}const Cn="participants",Je={async addParticipant(t,e,n,r=null){try{if((await this.getParticipant(t,e)).data)return{id:null,error:"Uivatel je ji astnkem tto plavby"};const{data:i,error:o}=await ps.getProfile(e);return o?{id:null,error:"Chyba pi natn profilu uivatele"}:!i||!i.name||i.name.trim().length<2?{id:null,error:'Uivatel nem vyplnn jmno v profilu. Prosm, vyplte jmno v sekci "Mj profil" ped pidnm do plavby.'}:{id:(await on(xe(se,Cn),{tripId:t,userId:e,role:n,boatId:r||null,status:"confirmed",createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(a){return{id:null,error:a.message}}},async getParticipant(t,e){try{const n=ke(xe(se,Cn),ve("tripId","==",t),ve("userId","==",e)),r=await Se(n);if(!r.empty){const a=r.docs[0];return{data:{id:a.id,...a.data()},error:null}}return{data:null,error:null}}catch(n){return{data:null,error:n.message}}},async getParticipantById(t){try{const e=Ie(se,Cn,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"astnk nenalezen"}}catch(e){return{data:null,error:e.message}}},async getTripParticipants(t){var e;try{const n=ke(xe(se,Cn),ve("tripId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{participants:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,Cn),ve("tripId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{participants:i,error:null}}catch(r){return{participants:[],error:r.message}}return{participants:[],error:n.message}}},async getUserParticipations(t){var e;try{const n=ke(xe(se,Cn),ve("userId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{participations:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,Cn),ve("userId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{participations:i,error:null}}catch(r){return{participations:[],error:r.message}}return{participations:[],error:n.message}}},async getUserRoleInTrip(t,e,n){if(e===n){const a=await this.getParticipant(t,e);return a.data?a.data.role==="captain"?"captain":"participant":"organizer"}const r=await this.getParticipant(t,e);return r.data?r.data.role:null},async updateParticipantRole(t,e){try{const n=Ie(se,Cn,t);return await $t(n,{role:e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async assignToBoat(t,e){try{const n=Ie(se,Cn,t);return await $t(n,{boatId:e||null,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async removeParticipant(t){try{return await Vn(Ie(se,Cn,t)),{error:null}}catch(e){return{error:e.message}}},async getBoatParticipants(t,e){try{const n=ke(xe(se,Cn),ve("tripId","==",t),ve("boatId","==",e)),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{participants:a,error:null}}catch(n){return{participants:[],error:n.message}}}},$n="trips";function fx(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e="abcdefghijklmnopqrstuvwxyz",n="0123456789",r="!@#$%^&*",a=t+e+n+r;let i="";i+=t[Math.floor(Math.random()*t.length)],i+=e[Math.floor(Math.random()*e.length)],i+=n[Math.floor(Math.random()*n.length)],i+=r[Math.floor(Math.random()*r.length)];for(let o=4;o<8;o++)i+=a[Math.floor(Math.random()*a.length)];return i.split("").sort(()=>Math.random()-.5).join("")}const pt={async createTrip(t){try{const e=fx();return{id:(await on(xe(se,$n),{...t,password:e,createdAt:ue.now(),updatedAt:ue.now()})).id,password:e,error:null}}catch(e){return{id:null,password:null,error:e.message}}},async getTrip(t){try{const e=Ie(se,$n,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"Plavba nenalezena"}}catch(e){return{data:null,error:e.message}}},async getTripByCodeAndPassword(t,e){try{const n=Ie(se,$n,t),r=await hn(n);if(r.exists()){const o=r.data();return o.password===e?{data:{id:r.id,...o},error:null}:{data:null,error:"Nesprvn heslo"}}const a=ke(xe(se,$n),ve("tripId","==",t),ve("password","==",e)),i=await Se(a);if(!i.empty){const o=i.docs[0];return{data:{id:o.id,...o.data()},error:null}}return{data:null,error:"Nesprvn ID nebo heslo"}}catch(n){return{data:null,error:n.message}}},async getTripByCode(t,e){return this.getTripByCodeAndPassword(t,e)},async getUserOrganizingTrips(t){var e;try{const n=ke(xe(se,$n),ve("organizerId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{trips:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,$n),ve("organizerId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{trips:i,error:null}}catch(r){return{trips:[],error:r.message}}return{trips:[],error:n.message}}},async getUserParticipatingTrips(t){try{const{participations:e,error:n}=await Je.getUserParticipations(t);if(n)return{trips:[],error:n};if(e.length===0)return{trips:[],error:null};const a=e.map(l=>Ie(se,$n,l.tripId)).map(l=>hn(l)),i=await Promise.all(a),o=[];return i.forEach((l,u)=>{if(l.exists()){const d=e[u];o.push({id:l.id,...l.data(),participationRole:d.role,participationId:d.id,boatId:d.boatId})}}),o.sort((l,u)=>{var f,m,_,E;const d=((m=(f=l.createdAt)==null?void 0:f.toDate)==null?void 0:m.call(f))||new Date(0);return(((E=(_=u.createdAt)==null?void 0:_.toDate)==null?void 0:E.call(_))||new Date(0))-d}),{trips:o,error:null}}catch(e){return{trips:[],error:e.message}}},async getUserTrips(t){return this.getUserOrganizingTrips(t)},async updateTrip(t,e){try{const n=Ie(se,$n,t);return await $t(n,{...e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async deleteTrip(t){try{return await Vn(Ie(se,$n,t)),{error:null}}catch(e){return{error:e.message}}},async generateAndSetPassword(t){try{const e=Ie(se,$n,t),n=await hn(e);if(!n.exists())return{password:null,error:"Plavba nenalezena"};const r=n.data();if(r.password)return{password:r.password,error:null};const a=fx();return await $t(e,{password:a,updatedAt:ue.now()}),{password:a,error:null}}catch(e){return{password:null,error:e.message}}}};function HD(){const t=_t(),[e]=Fj(),{user:n,loading:r}=yt(),a=e.get("mode")||"register",i=e.get("tripId")||null,[o,l]=C.useState({email:"",password:"",passwordConfirm:"",name:"",phone:""}),[u,d]=C.useState(!1),[h,f]=C.useState(!1),[m,_]=C.useState(!1),[E,w]=C.useState({}),[x,v]=C.useState(null),[j,S]=C.useState(""),[R,L]=C.useState(i||"");C.useEffect(()=>{a==="join-trip"&&i&&(N(),L(i.toUpperCase()))},[a,i]);const U=async()=>{await Va.signOut(),t("/")};C.useEffect(()=>{r||(n&&a==="onboarding"?y():n&&n.email&&l(B=>({...B,email:n.email||""})))},[n,a,r]),C.useEffect(()=>{n&&n.providerData&&n.providerData.some(ee=>ee.providerId==="google.com")&&(d(!0),!o.email&&n.email&&l(ee=>({...ee,email:n.email||"",name:n.displayName||ee.name,phone:n.phoneNumber||ee.phone})))},[n]);const N=async()=>{try{const{data:B}=await pt.getTrip(i);B&&v(B)}catch(B){console.error("Error loading trip:",B)}},y=async()=>{if(n)try{const{data:B}=await ps.getProfile(n.uid);l(B?ee=>({...ee,name:B.name||"",phone:B.phone||"",email:B.email||n.email||""}):ee=>({...ee,email:n.email||""}))}catch(B){console.error("Error loading profile:",B)}},k=async()=>{w({}),_(!0);try{const{user:B,userData:ee,error:W}=await Va.signInWithGoogle();if(W){w({general:W}),_(!1);return}B&&ee&&(l(D=>({...D,email:ee.email||"",name:ee.displayName||"",phone:ee.phoneNumber||""})),d(!0))}catch(B){w({general:B.message||"Chyba pi pihlen pes Google"})}finally{_(!1)}},b=(B,ee)=>{l(W=>({...W,[B]:ee})),E[B]&&w(W=>{const D={...W};return delete D[B],D})},A=()=>{const B={};n||u||(o.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)||(B.email="Email nen ve sprvnm formtu"):B.email="Email je povinn",o.password?o.password.length<6&&(B.password="Heslo mus obsahovat alespo 6 znak"):B.password="Heslo je povinn",o.password!==o.passwordConfirm&&(B.passwordConfirm="Hesla se neshoduj"));const ee=qD({name:o.name,phone:o.phone,email:o.email});return Object.assign(B,ee.errors),a==="join-trip"&&(!R.trim()&&!i&&(B.tripCode="ID plavby je povinn"),j.trim()||(B.tripPassword="Heslo plavby je povinn")),w(B),Object.keys(B).length===0},z=async B=>{if(B.preventDefault(),!!A()){f(!0),w({});try{let ee=n;if(!ee)if(u){if(ee=Hn.currentUser,!ee){w({general:"Uivatel nen pihlen"}),f(!1);return}}else{const{user:q,error:G}=await Va.signUp(o.email,o.password,o.name);if(G){w({general:G}),f(!1);return}ee=q}const W={name:o.name.trim(),phone:o.phone.trim(),email:o.email.trim()},{error:D}=await ps.saveProfile(ee.uid,W);if(D){w({general:"Chyba pi ukldn profilu: "+D}),f(!1);return}if(a==="join-trip"){const q=R.trim().toUpperCase()||(i==null?void 0:i.toUpperCase().trim());if(!q){w({tripCode:"ID plavby je povinn"}),f(!1);return}const{data:G,error:I}=await pt.getTripByCodeAndPassword(q,j.trim());if(I||!G){w({tripPassword:"Nesprvn heslo plavby"}),f(!1);return}const{id:O,error:F}=await Je.addParticipant(G.id,ee.uid,"participant",null);if(F){w({general:F}),f(!1);return}t(`/trip/${G.id}/participant`);return}if(a==="onboarding"){const q=sessionStorage.getItem("onboardingReturnUrl")||"/dashboard";sessionStorage.removeItem("onboardingReturnUrl"),t(q)}else t("/dashboard")}catch(ee){w({general:ee.message||"Dolo k chyb"}),f(!1)}}},$=(()=>{switch(a){case"join-trip":return{title:"Pidat se k plavb",subtitle:x?`Pipojte se k plavb "${x.name||"Bez nzvu"}"`:"Vyplte daje pro pipojen k plavb",note:"Pidnm se k plavb dojde k registraci. Po plavb je mon et zruit."};case"onboarding":return{title:"Doplnit daje",subtitle:"Pro pokraovn prosm doplte sv kontaktn daje",note:null};default:return{title:"Vytvoit et",subtitle:"Zaregistrujte se a zante organizovat plavby",note:null}}})(),Q=!n||n&&u;return s.jsx("div",{className:"onboarding-page",children:s.jsxs("div",{className:"onboarding-container",children:[s.jsxs(ie,{to:"/",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsxs("div",{className:"onboarding-card",children:[s.jsx("h1",{children:$.title}),s.jsx("p",{className:"subtitle",children:$.subtitle}),E.general&&s.jsxs("div",{className:"error-message",children:[s.jsx("i",{className:"fas fa-exclamation-circle"}),E.general]}),s.jsxs("form",{onSubmit:z,className:"onboarding-form",children:[s.jsxs("div",{className:"form-sections-container",children:[Q&&s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"form-section-title",children:[s.jsx("i",{className:"fas fa-user-circle"}),"et"]}),!u&&s.jsx("div",{className:"form-section-note",children:s.jsxs("p",{children:["Ji mte et? ",s.jsx(ie,{to:"/login",className:"link-inline",children:"Pihlaste se"})]})}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Email *"}),s.jsx("input",{type:"email",className:`form-input ${E.email?"error":""}`,value:o.email,onChange:B=>b("email",B.target.value),placeholder:"vas@email.cz",disabled:u||!!n,required:!u&&!n}),E.email&&s.jsx("p",{className:"form-error",children:E.email}),u&&s.jsxs("p",{className:"form-help",style:{color:"var(--success)",fontSize:"0.75rem",marginTop:"4px"},children:[s.jsx("i",{className:"fas fa-lock",style:{marginRight:"4px"}}),"Email je propojen s vam Google tem a nelze ho zmnit"]})]}),!u&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"password-fields-group",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Heslo *"}),s.jsx("input",{type:"password",className:`form-input ${E.password?"error":""}`,value:o.password,onChange:B=>b("password",B.target.value),placeholder:"",required:!0,minLength:6}),E.password&&s.jsx("p",{className:"form-error",children:E.password})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Potvrzen hesla *"}),s.jsx("input",{type:"password",className:`form-input ${E.passwordConfirm?"error":""}`,value:o.passwordConfirm,onChange:B=>b("passwordConfirm",B.target.value),placeholder:"",required:!0,minLength:6}),E.passwordConfirm&&s.jsx("p",{className:"form-error",children:E.passwordConfirm})]})]})}),!u&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"divider",children:s.jsx("span",{children:"nebo"})}),s.jsx("button",{type:"button",className:"btn btn-google btn-block",onClick:k,disabled:m||h,children:m?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-spinner fa-spin"}),"Pihlaovn..."]}):s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"20",height:"20",children:[s.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),s.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),s.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),s.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Pokraovat s Google"]})})]}),u&&s.jsxs("div",{className:"google-success",children:[s.jsx("i",{className:"fas fa-check-circle"}),"spn pihleno pes Google"]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"form-section-title",children:[s.jsx("i",{className:"fas fa-user"}),"Kontaktn daje"]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Jmno a pjmen *"}),s.jsx("input",{type:"text",className:`form-input ${E.name?"error":""}`,value:o.name,onChange:B=>b("name",B.target.value),placeholder:"nap. Jan Novk",required:!0,minLength:2}),E.name&&s.jsx("p",{className:"form-error",children:E.name})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Telefon *"}),s.jsx("input",{type:"tel",className:`form-input ${E.phone?"error":""}`,value:o.phone,onChange:B=>b("phone",B.target.value),placeholder:"nap. +420 123 456 789",required:!0}),E.phone&&s.jsx("p",{className:"form-error",children:E.phone})]}),!u&&!n&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Email *"}),s.jsx("input",{type:"email",className:`form-input ${E.email?"error":""}`,value:o.email,onChange:B=>b("email",B.target.value),placeholder:"vas@email.cz",required:!0}),E.email&&s.jsx("p",{className:"form-error",children:E.email})]})]}),a==="join-trip"&&s.jsxs("div",{className:"form-section trip-password-section",children:[s.jsxs("h3",{className:"form-section-title",children:[s.jsx("i",{className:"fas fa-ship"}),"daje o plavb"]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"ID plavby *"}),s.jsx("input",{type:"text",className:`form-input ${E.tripCode?"error":""}`,value:R,onChange:B=>{L(B.target.value.toUpperCase()),E.tripCode&&w(ee=>{const W={...ee};return delete W.tripCode,W})},placeholder:"nap. ABC123",disabled:!!i,required:!0,maxLength:6,style:{fontFamily:"monospace",textTransform:"uppercase"}}),E.tripCode&&s.jsx("p",{className:"form-error",children:E.tripCode}),s.jsx("p",{className:"form-help",children:"ID plavby vm poskytl organiztor."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Heslo plavby *"}),s.jsx("input",{type:"password",className:`form-input ${E.tripPassword?"error":""}`,value:j,onChange:B=>{S(B.target.value),E.tripPassword&&w(ee=>{const W={...ee};return delete W.tripPassword,W})},placeholder:"Zadejte heslo plavby",required:!0}),E.tripPassword&&s.jsx("p",{className:"form-error",children:E.tripPassword}),s.jsx("p",{className:"form-help",children:"Heslo vm poskytl organiztor plavby."})]})]})]}),s.jsxs("div",{className:"form-actions",children:[a==="onboarding"&&s.jsxs("button",{type:"button",className:"btn btn-ghost",onClick:U,children:[s.jsx("i",{className:"fas fa-sign-out-alt"}),"Odhlsit se"]}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h||m,children:h?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-spinner fa-spin"}),"Zpracovvn..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-check"}),"Pokraovat"]})})]})]}),$.note&&s.jsx("div",{className:"info-note-subtle",children:$.note}),a!=="onboarding"&&s.jsx("div",{className:"onboarding-footer",children:s.jsxs("p",{children:["Ji mte et?"," ",s.jsx(ie,{to:"/login",className:"link-button",children:"Pihlaste se"})]})})]})]})})}const ks="boats",Jt={async createBoat(t,e){try{return{id:(await on(xe(se,ks),{tripId:t,...e,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(n){return{id:null,error:n.message}}},async getBoat(t){try{const e=Ie(se,ks,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"Lo nenalezena"}}catch(e){return{data:null,error:e.message}}},async getTripBoats(t){var e;try{try{const n=ke(xe(se,ks),ve("tripId","==",t),nr("createdAt","asc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{boats:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index")){const r=ke(xe(se,ks),ve("tripId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0),d=((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0);return u-d}),{boats:i,error:null}}throw n}}catch(n){return console.error("Error loading boats:",n),{boats:[],error:n.message}}},async updateBoat(t,e){try{const n=Ie(se,ks,t);return await $t(n,{...e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async deleteBoat(t){try{return await Vn(Ie(se,ks,t)),{error:null}}catch(e){return{error:e.message}}},async assignCaptain(t,e){try{const n=Ie(se,ks,t);return await $t(n,{captainId:e||null,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}}},lr=t=>{const[e,n]=C.useState(()=>typeof window<"u"?window.matchMedia(t).matches:!1);return C.useEffect(()=>{if(typeof window>"u")return;const r=window.matchMedia(t),a=i=>{n(i.matches)};return n(r.matches),r.addEventListener("change",a),()=>{r.removeEventListener("change",a)}},[t]),e};function km({tripId:t,onClose:e,onSuccess:n}){const r=_t(),{user:a}=yt(),[i,o]=C.useState(t||""),[l,u]=C.useState(""),[d,h]=C.useState(!1),[f,m]=C.useState(""),_="participant",E=async w=>{if(w.preventDefault(),m(""),!i.trim()||!l.trim()){m("Vyplte ID plavby i heslo.");return}if(!a){r(`/onboarding?mode=join-trip&tripId=${i}`);return}h(!0);try{const{data:x,error:v}=await pt.getTripByCodeAndPassword(i.toUpperCase().trim(),l.trim());if(v||!x){m("Nesprvn ID nebo heslo. Zkuste to znovu."),h(!1);return}const{data:j}=await Je.getParticipant(x.id,a.uid);if(j){m("Ji jsi astnkem tto plavby."),h(!1);return}const{id:S,error:R}=await Je.addParticipant(x.id,a.uid,_,null);if(R){m(R),h(!1);return}n?n():(e(),r(a?`/trip/${x.id}/${_==="captain"?"captain":"participant"}`:"/login"))}catch(x){m(x.message||"Dolo k chyb"),h(!1)}};return s.jsx("div",{className:"modal-overlay active",onClick:e,children:s.jsxs("div",{className:"modal",onClick:w=>w.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h4",{children:"Pipojit se k plavb"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("form",{onSubmit:E,children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{className:"form-label",children:["ID plavby ",t?"":"*"]}),s.jsx("input",{type:"text",className:"form-input",value:i,onChange:w=>o(w.target.value.toUpperCase()),placeholder:"nap. ABC123",style:{fontFamily:"monospace",textTransform:"uppercase",background:t?"var(--gray-50)":"var(--white)"},maxLength:6,readOnly:!!t,required:!t}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:t?"ID plavby je automaticky pedvyplnno.":"Zadejte ID plavby, kter vm poskytl organiztor."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Heslo *"}),s.jsx("input",{type:"password",className:"form-input",value:l,onChange:w=>u(w.target.value),placeholder:"Zadejte heslo",style:{fontFamily:"monospace"},maxLength:20,required:!0}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Zadejte heslo, kter vm poskytl organiztor."})]}),f&&s.jsxs("div",{style:{padding:"var(--space-md)",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius-md)",color:"var(--danger)",marginTop:"var(--space-md)"},children:[s.jsx("i",{className:"fas fa-exclamation-circle"})," ",f]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:e,children:"Zruit"}),s.jsxs("button",{type:"submit",className:"btn btn-coral",disabled:d,children:[s.jsx("i",{className:"fas fa-sign-in-alt"}),d?"Pipojovn...":"Pipojit se"]})]})]})})]})})}function KD(){var S;const{user:t}=yt();lr("(max-width: 768px)");const[e,n]=C.useState(null),[r,a]=C.useState({boatCount:0,participantCount:0}),[i,o]=C.useState({upcoming:0,completed:0}),[l,u]=C.useState(!0),[d,h]=C.useState(!1),f=(t==null?void 0:t.displayName)||((S=t==null?void 0:t.email)==null?void 0:S.split("@")[0])||"Uivateli";C.useEffect(()=>{t&&m()},[t]);const m=async()=>{var T,$;u(!0);const[R,L]=await Promise.all([pt.getUserOrganizingTrips(t.uid),pt.getUserParticipatingTrips(t.uid)]),U=new Map;R.trips.forEach(Q=>{U.set(Q.id,{...Q,isOrganizing:!0})}),L.trips.forEach(Q=>{if(U.has(Q.id)){const B=U.get(Q.id);U.set(Q.id,{...B,participationRole:Q.participationRole||B.participationRole,participationId:Q.participationId||B.participationId,boatId:Q.boatId||B.boatId})}else U.set(Q.id,{...Q,isOrganizing:!1})});const N=Array.from(U.values()),y=Q=>Q?Q.toDate?Q.toDate():Q.seconds?new Date(Q.seconds*1e3):null:null,k=new Date;let b=null,A=0,z=0;if(N.forEach(Q=>{const B=y(Q.startDate),ee=y(Q.endDate);if(B&&B>k)A++,(!b||B<y(b.startDate))&&(b=Q);else if(!b&&Q.isOrganizing){const W=y(Q.startDate);(!b||W&&W>y(b.startDate))&&(b=Q)}ee&&ee<k&&z++}),n(b),o({upcoming:A,completed:z}),b){const[Q,B]=await Promise.all([Jt.getTripBoats(b.id),Je.getTripParticipants(b.id)]);a({boatCount:((T=Q.boats)==null?void 0:T.length)||0,participantCount:(($=B.participants)==null?void 0:$.length)||0})}else a({boatCount:0,participantCount:0});u(!1)},_=R=>R?R.toDate?R.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):R.seconds?new Date(R.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",E=(R,L)=>{if(!R||!L)return"Neuvedeno";const U=_(R),N=_(L);return`${U}  ${N}`},w=R=>{if(!R)return null;const N=(R.toDate?R.toDate():new Date(R.seconds*1e3))-new Date,y=Math.ceil(N/(1e3*60*60*24));return y>0?y:null},x=R=>R.participationRole==="captain"?`/trip/${R.id}/captain`:`/trip/${R.id}/participant`,v=R=>({participant:"astnk",captain:"Kapitn",organizer:"Organiztor"})[R]||R,j=R=>{const L=[];R.isOrganizing&&L.push("organizer");const U=R.participationRole||R.role;return U&&U!=="organizer"&&L.push(U),L.length===0&&L.push("participant"),L};return l?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):s.jsxs("div",{className:"container",children:[s.jsx("div",{className:"welcome-banner animate-in",children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsxs("h2",{children:["Ahoj, ",f,"! "]}),e?s.jsxs("p",{children:["M blc se plavbu za ",w(e.startDate)," dn. Nezapome zkontrolovat checklist."]}):s.jsx("p",{children:"Zatm nem dn nadchzejc plavby. Vytvo novou nebo se pipoj k existujc."})]}),s.jsxs("div",{className:"welcome-stats",style:{display:"flex",gap:"var(--space-xl)",flexWrap:"wrap"},children:[s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"2rem",fontWeight:700,fontFamily:"var(--font-display)"},children:i.upcoming}),s.jsx("div",{style:{fontSize:"0.875rem",opacity:.8},children:"Nadchzejc"})]}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"2rem",fontWeight:700,fontFamily:"var(--font-display)"},children:i.completed}),s.jsx("div",{style:{fontSize:"0.875rem",opacity:.8},children:"Dokonen"})]})]})]})}),s.jsxs("div",{className:"dashboard-grid",children:[s.jsxs("div",{className:"main-content",children:[s.jsxs("h3",{style:{marginBottom:"var(--space-lg)"},children:[s.jsx("i",{className:"fas fa-calendar-alt",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),e?"Nadchzejc plavba":"Nem nadchzejc plavbu"]}),e?s.jsx("div",{className:"trip-card animate-in delay-1",style:{marginBottom:"var(--space-xl)"},children:s.jsxs("div",{onClick:()=>{const R=x(e);window.location.href=R},style:{display:"block",textDecoration:"none",cursor:"pointer"},children:[s.jsxs("div",{className:"trip-card-image",style:e.bannerImageUrl?{background:`url(${e.bannerImageUrl}) center/cover no-repeat`,position:"relative"}:{background:"linear-gradient(135deg, #1a5f7a, #06b6d4)"},children:[e.bannerImageUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.6), rgba(10, 22, 40, 0.4))"}}),s.jsx("h3",{style:{position:"relative",zIndex:1},children:e.name||"Bez nzvu"})]}),s.jsxs("div",{className:"trip-card-content",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--space-md)"},children:[s.jsxs("div",{className:"trip-meta",children:[s.jsxs("div",{className:"trip-meta-item",children:[s.jsx("i",{className:"fas fa-calendar"}),E(e.startDate,e.endDate)]}),e.startLocation&&s.jsxs("div",{className:"trip-meta-item",children:[s.jsx("i",{className:"fas fa-map-marker-alt"}),e.startLocation]})]}),s.jsx("div",{style:{display:"flex",gap:"var(--space-xs)",flexWrap:"wrap",justifyContent:"flex-end",marginLeft:"var(--space-md)",alignItems:"center"},children:j(e).map(R=>R==="organizer"?s.jsxs(ie,{to:`/trip/${e.id}/organizer`,className:`role-badge ${R}`,onClick:L=>L.stopPropagation(),style:{cursor:"pointer",textDecoration:"none"},title:"Otevt jako organiztor",onMouseEnter:L=>{L.currentTarget.style.transform="scale(1.05)",L.currentTarget.style.boxShadow="0 4px 12px rgba(249, 115, 22, 0.3)"},onMouseLeave:L=>{L.currentTarget.style.transform="scale(1)",L.currentTarget.style.boxShadow="none"},children:[s.jsx("i",{className:"fas fa-crown"}),v(R),s.jsx("i",{className:"fas fa-external-link-alt",style:{marginLeft:"4px",fontSize:"0.7rem"}})]},R):s.jsxs("span",{className:`role-badge ${R}`,children:[s.jsx("i",{className:`fas fa-${R==="captain"?"ship":"user"}`}),v(R)]},R))})]}),s.jsxs("div",{className:"trip-stats",children:[s.jsxs("div",{className:"trip-stat",children:[s.jsx("div",{className:"trip-stat-value",children:r.boatCount}),s.jsx("div",{className:"trip-stat-label",children:"Lod"})]}),s.jsxs("div",{className:"trip-stat",children:[s.jsx("div",{className:"trip-stat-value",children:r.participantCount}),s.jsx("div",{className:"trip-stat-label",children:"astnk"})]}),e.startDate&&s.jsxs("div",{className:"trip-stat",children:[s.jsx("div",{className:"trip-stat-value",children:w(e.startDate)||"-"}),s.jsx("div",{className:"trip-stat-label",children:"Dn do startu"})]})]})]})]})}):s.jsxs("div",{className:"card",style:{padding:"var(--space-2xl)",textAlign:"center"},children:[s.jsx("div",{className:"empty-state-icon",style:{margin:"0 auto var(--space-lg)"},children:s.jsx("i",{className:"fas fa-sailboat"})}),s.jsx("h3",{children:"Nem nadchzejc plavbu"}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Vytvo novou plavbu, pipoj se k existujc pomoc ID a hesla, nebo pokej a t organiztor pozve."}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",justifyContent:"center",flexWrap:"wrap"},children:[s.jsxs(ie,{to:"/trip/new",className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Zorganizovat plavbu"]}),s.jsxs("button",{className:"btn btn-coral",onClick:()=>h(!0),children:[s.jsx("i",{className:"fas fa-sign-in-alt"}),"Zastnit se plavby"]})]})]})]}),s.jsx("aside",{children:e&&s.jsxs("div",{className:"sidebar-card animate-in delay-3",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-bell",style:{color:"var(--warning)"}}),"Pipomnky"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-md)"},children:s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",padding:"var(--space-md)",background:"var(--foam)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{style:{color:"var(--turquoise)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-info-circle"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{color:"var(--ocean-deep)"},children:"Piprav se na plavbu"}),s.jsx("div",{className:"text-sm text-muted",children:"Zkontroluj checklist a crewlist"})]})]})})]})})]}),d&&s.jsx(km,{onClose:()=>h(!1)})]})}function GD(){const{user:t}=yt(),[e,n]=C.useState([]),[r,a]=C.useState({}),[i,o]=C.useState(!0),[l,u]=C.useState(!1);C.useEffect(()=>{t&&d()},[t]);const d=async()=>{if(!t)return;o(!0);const{trips:E,error:w}=await pt.getUserParticipatingTrips(t.uid);if(!w){n(E);const x={};for(const v of E)x[v.id]=0;a(x)}o(!1)},h=E=>E?E.toDate?E.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):E.seconds?new Date(E.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"Neuvedeno":"Neuvedeno",f=(E,w)=>{if(!E||!w)return"Neuvedeno";const x=h(E),v=h(w);return`${x}  ${v}`},m=E=>({participant:"astnk",captain:"Kapitn",organizer:"Organiztor"})[E]||E,_=(E,w)=>w==="organizer"?`/trip/${E.id}/organizer`:w==="captain"?`/trip/${E.id}/captain`:`/trip/${E.id}/participant`;return i?s.jsx("div",{className:"container",children:s.jsx("div",{className:"loading",children:"Natn plaveb..."})}):s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"row wrap",style:{alignItems:"flex-end",marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"grow",children:[s.jsx("h1",{className:"h1",children:"M plavby"}),s.jsx("p",{className:"subtitle",style:{textAlign:"left"},children:"Plavby, kterch se astn jako astnk nebo kapitn."})]}),s.jsxs("button",{className:"btn btn-coral",onClick:()=>u(!0),children:[s.jsx("i",{className:"fas fa-sign-in-alt"}),"Zastnit se plavby"]})]}),s.jsx("div",{className:"trips-content",children:e.length>0?s.jsx("div",{className:"grid two",children:e.map(E=>{const w=E.participationRole||"participant";return s.jsx(ie,{to:_(E,w),className:"card",style:{textDecoration:"none",display:"block",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:x=>{x.currentTarget.style.transform="translateY(-2px)",x.currentTarget.style.boxShadow="var(--shadow-lg)"},onMouseLeave:x=>{x.currentTarget.style.transform="translateY(0)",x.currentTarget.style.boxShadow="var(--shadow-md)"},children:s.jsx("div",{className:"hd",children:s.jsxs("div",{className:"grow",children:[s.jsx("div",{className:"h2",style:{marginBottom:"var(--space-sm)"},children:E.name||"Bez nzvu"}),s.jsxs("div",{className:"p",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-calendar",style:{marginRight:"6px",color:"var(--gray-400)"}}),f(E.startDate,E.endDate)]}),E.startLocation&&s.jsxs("div",{className:"p",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-map-marker-alt",style:{marginRight:"6px",color:"var(--gray-400)"}}),E.startLocation]}),s.jsx("div",{style:{marginTop:"var(--space-sm)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:s.jsxs("span",{className:`role-badge ${w}`,style:{fontSize:"0.75rem"},children:[s.jsx("i",{className:`fas fa-${w==="captain"?"ship":"user"}`}),m(w)]})})]})})},E.id)})}):s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),s.jsx("h3",{children:"Zatm se neastn dn plavby"}),s.jsx("p",{children:"Pipoj se k plavb pomoc ID a hesla, nebo pokej a t organiztor pozve."}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",justifyContent:"center",flexWrap:"wrap",marginTop:"var(--space-lg)"},children:[s.jsxs("button",{className:"btn btn-coral",onClick:()=>u(!0),children:[s.jsx("i",{className:"fas fa-sign-in-alt"}),"Zastnit se plavby"]}),s.jsxs(ie,{to:"/trip/new",className:"btn",children:[s.jsx("i",{className:"fas fa-plus"}),"Zorganizovat plavbu"]})]})]})}),l&&s.jsx(km,{onClose:()=>u(!1)})]})}function QD(){const{user:t}=yt(),[e,n]=C.useState([]),[r,a]=C.useState({}),[i,o]=C.useState({}),[l,u]=C.useState(!0);C.useEffect(()=>{t&&d()},[t]);const d=async()=>{var E,w;if(!t)return;u(!0);const{trips:m,error:_}=await pt.getUserOrganizingTrips(t.uid);if(!_){n(m);const x={},v={};for(const j of m){const[S,R]=await Promise.all([Jt.getTripBoats(j.id),Je.getTripParticipants(j.id)]),L=((E=S.boats)==null?void 0:E.length)||0,U=((w=R.participants)==null?void 0:w.length)||0;x[j.id]={boatCount:L,participantCount:U},v[j.id]=0}a(x),o(v)}u(!1)},h=m=>m?m.toDate?m.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):m.seconds?new Date(m.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"Neuvedeno":"Neuvedeno",f=(m,_)=>{if(!m||!_)return"Neuvedeno";const E=h(m),w=h(_);return`${E}  ${w}`};return l?s.jsx("div",{className:"container",children:s.jsx("div",{className:"loading",children:"Natn plaveb..."})}):s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"row wrap",style:{alignItems:"flex-end",marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"grow",children:[s.jsx("h1",{className:"h1",children:"Organizuji"}),s.jsx("p",{className:"subtitle",style:{textAlign:"left"},children:"Plavby, kter organizuje. Zde m pln pstup ke vem funkcm sprvy plavby."})]}),e.length===0&&s.jsxs(ie,{to:"/trip/new",className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Zorganizovat plavbu"]})]}),s.jsx("div",{className:"trips-content",children:e.length>0?s.jsx("div",{className:"grid two",children:e.map(m=>{const _=r[m.id]||{boatCount:0,participantCount:0};return s.jsx(ie,{to:`/trip/${m.id}/organizer`,className:"card",style:{textDecoration:"none",display:"block",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:E=>{E.currentTarget.style.transform="translateY(-2px)",E.currentTarget.style.boxShadow="var(--shadow-lg)"},onMouseLeave:E=>{E.currentTarget.style.transform="translateY(0)",E.currentTarget.style.boxShadow="var(--shadow-md)"},children:s.jsx("div",{className:"hd",children:s.jsxs("div",{className:"grow",children:[s.jsx("div",{className:"h2",style:{marginBottom:"var(--space-sm)"},children:m.name||"Bez nzvu"}),s.jsxs("div",{className:"p",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-calendar",style:{marginRight:"6px",color:"var(--gray-400)"}}),f(m.startDate,m.endDate)]}),m.startLocation&&s.jsxs("div",{className:"p",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-map-marker-alt",style:{marginRight:"6px",color:"var(--gray-400)"}}),m.startLocation]}),s.jsxs("div",{style:{marginTop:"var(--space-sm)",display:"flex",alignItems:"center",gap:"var(--space-md)",flexWrap:"wrap"},children:[s.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:[s.jsx("i",{className:"fas fa-ship",style:{marginRight:"4px",color:"var(--turquoise)"}}),_.boatCount," ",_.boatCount===1?"lo":_.boatCount<5?"lod":"lod"]}),s.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:[s.jsx("i",{className:"fas fa-users",style:{marginRight:"4px",color:"var(--coral)"}}),_.participantCount," ",_.participantCount===1?"astnk":_.participantCount<5?"astnci":"astnk"]}),s.jsxs("span",{className:"role-badge organizer",style:{fontSize:"0.75rem"},children:[s.jsx("i",{className:"fas fa-crown"}),"Organiztor"]})]})]})})},m.id)})}):s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:s.jsx("i",{className:"fas fa-chart-line"})}),s.jsx("h3",{children:"Zatm dn plavby neorganizuje"}),s.jsx("p",{children:"Zante vytvoenm nov plavby a pozvte sv ptele."})]})})]})}const ca="tripTemplates",nu={async createTemplate(t,e,n){try{const r=await hn(Ie(se,"trips",e));if(!r.exists())return{id:null,error:"Plavba nenalezena"};const a=r.data();return{id:(await on(xe(se,ca),{organizerId:t,name:n.name||a.name||"Bez nzvu",description:n.description||a.description||"",startDate:a.startDate||null,endDate:a.endDate||null,location:a.location||"",maxParticipants:a.maxParticipants||null,sourceTripId:e,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(r){return{id:null,error:r.message}}},async createTripFromTemplate(t,e,n={}){try{const{data:r,error:a}=await this.getTemplate(e);return a||!r?{id:null,error:a||"Template nenalezen"}:{id:(await on(xe(se,"trips"),{organizerId:t,name:n.name||r.name||"Nov plavba",description:n.description||r.description||"",startDate:n.startDate?ue.fromDate(new Date(n.startDate)):r.startDate||null,endDate:n.endDate?ue.fromDate(new Date(n.endDate)):r.endDate||null,location:n.location||r.location||"",maxParticipants:n.maxParticipants||r.maxParticipants||null,status:"draft",sourceTemplateId:e,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(r){return{id:null,error:r.message}}},async getTemplates(t){var e;try{const n=ke(xe(se,ca),ve("organizerId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{templates:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,ca),ve("organizerId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{templates:i,error:null}}catch(r){return{templates:[],error:r.message}}return{templates:[],error:n.message}}},async getTemplate(t){try{const e=Ie(se,ca,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"Template nenalezen"}}catch(e){return{data:null,error:e.message}}},async updateTemplate(t,e){try{const n=Ie(se,ca,t);return await $t(n,{...e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async deleteTemplate(t){try{return await Vn(Ie(se,ca,t)),{error:null}}catch(e){return{error:e.message}}}},Jd="crewlistTemplates",Oi="crewlistData",Nn={async saveTemplate(t,e){try{const n=ke(xe(se,Jd),ve("tripId","==",t)),r=await Se(n);if(r.empty)return{id:(await on(xe(se,Jd),{tripId:t,...e,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null};{const a=r.docs[0];return await $t(a.ref,{...e,updatedAt:ue.now()}),{id:a.id,error:null}}}catch(n){return{id:null,error:n.message}}},async getTemplate(t){try{const e=ke(xe(se,Jd),ve("tripId","==",t)),n=await Se(e);if(!n.empty){const r=n.docs[0];return{data:{id:r.id,...r.data()},error:null}}return{data:null,error:null}}catch(e){return{data:null,error:e.message}}},async saveCrewlistData(t,e,n,r){try{const a=ke(xe(se,Oi),ve("tripId","==",t),ve("boatId","==",e),ve("userId","==",n)),i=await Se(a);if(i.empty)return{id:(await on(xe(se,Oi),{tripId:t,boatId:e,userId:n,...r,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null};{const o=i.docs[0];return await $t(o.ref,{...r,updatedAt:ue.now()}),{id:o.id,error:null}}}catch(a){return{id:null,error:a.message}}},async getCrewlistData(t,e,n){try{const r=ke(xe(se,Oi),ve("tripId","==",t),ve("boatId","==",e),ve("userId","==",n)),a=await Se(r);if(!a.empty){const i=a.docs[0];return{data:{id:i.id,...i.data()},error:null}}return{data:null,error:null}}catch(r){return{data:null,error:r.message}}},async getBoatCrewlistData(t,e){try{const n=ke(xe(se,Oi),ve("tripId","==",t),ve("boatId","==",e)),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{data:a,error:null}}catch(n){return{data:[],error:n.message}}},async getTripCrewlistData(t){try{const e=ke(xe(se,Oi),ve("tripId","==",t)),n=await Se(e),r=[];return n.forEach(a=>{r.push({id:a.id,...a.data()})}),{data:r,error:null}}catch(e){return{data:[],error:e.message}}}},Vi="timelineEvents",Mi="timelineCompletions",wt={async createEvent(t,e){try{return{id:(await on(xe(se,Vi),{tripId:t,name:e.name||"",description:e.description||"",type:e.type||"custom",date:e.date?ue.fromDate(new Date(e.date)):null,roles:e.roles||[],checkable:e.checkable!==!1,order:e.order||0,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(n){return{id:null,error:n.message}}},async getTripEvents(t){var e;try{const n=ke(xe(se,Vi),ve("tripId","==",t),nr("order","asc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{events:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,Vi),ve("tripId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>(o.order||0)-(l.order||0)),{events:i,error:null}}catch(r){return{events:[],error:r.message}}return{events:[],error:n.message}}},async updateEvent(t,e){try{const n=Ie(se,Vi,t),r={...e,updatedAt:ue.now()};return e.date&&(r.date=ue.fromDate(new Date(e.date))),await $t(n,r),{error:null}}catch(n){return{error:n.message}}},async deleteEvent(t){try{const e=ke(xe(se,Mi),ve("eventId","==",t)),r=(await Se(e)).docs.map(a=>Vn(a.ref));return await Promise.all(r),await Vn(Ie(se,Vi,t)),{error:null}}catch(e){return{error:e.message}}},async setEventCompletion(t,e,n){try{const r=ke(xe(se,Mi),ve("eventId","==",t),ve("userId","==",e)),a=await Se(r);if(a.empty)n&&await on(xe(se,Mi),{eventId:t,userId:e,completed:!0,createdAt:ue.now(),updatedAt:ue.now()});else{const i=a.docs[0];await $t(i.ref,{completed:n,updatedAt:ue.now()})}return{error:null}}catch(r){return{error:r.message}}},async getEventCompletion(t,e){try{const n=ke(xe(se,Mi),ve("eventId","==",t),ve("userId","==",e)),r=await Se(n);return r.empty?{completed:!1,error:null}:{completed:r.docs[0].data().completed===!0,error:null}}catch(n){return{completed:!1,error:n.message}}},async getTripCompletions(t){try{const{events:e,error:n}=await this.getTripEvents(t);if(n)return{completions:[],error:n};const r=e.map(l=>l.id);if(r.length===0)return{completions:[],error:null};const a=ke(xe(se,Mi)),i=await Se(a),o=[];return i.forEach(l=>{const u=l.data();r.includes(u.eventId)&&o.push({id:l.id,eventId:u.eventId,userId:u.userId,completed:u.completed===!0})}),{completions:o,error:null}}catch(e){return{completions:[],error:e.message}}}},ua="checklistTemplates",qn="checklistInstances",Fe={async createTemplate(t,e){try{return{id:(await on(xe(se,ua),{organizerId:t,name:e.name||"",description:e.description||"",categories:e.categories||[],items:e.items||[],isDefault:e.isDefault||!1,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(n){return{id:null,error:n.message}}},async getTemplates(t){var e;try{const n=ke(xe(se,ua),ve("organizerId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{templates:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,ua),ve("organizerId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{templates:i,error:null}}catch(r){return{templates:[],error:r.message}}return{templates:[],error:n.message}}},async getTemplate(t){try{const e=Ie(se,ua,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"Template nenalezen"}}catch(e){return{data:null,error:e.message}}},async updateTemplate(t,e){try{const n=Ie(se,ua,t);return await $t(n,{...e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async deleteTemplate(t){try{return await Vn(Ie(se,ua,t)),{error:null}}catch(e){return{error:e.message}}},async createInstance(t,e,n){var r;try{let a=ke(xe(se,qn),ve("tripId","==",t),ve("templateId","==",e));n.boatId&&(a=ke(a,ve("boatId","==",n.boatId))),n.userId&&(a=ke(a,ve("userId","==",n.userId))),n.role&&(a=ke(a,ve("role","==",n.role)));const o=(await Se(a)).docs.filter(d=>{const h=d.data(),f=n.boatId?h.boatId===n.boatId:!h.boatId,m=n.userId?h.userId===n.userId:!h.userId,_=n.role?h.role===n.role:!h.role;return f&&m&&_});if(o.length>0)return{id:o[0].id,error:null,duplicate:!0};const{data:l}=await this.getTemplate(e);return l?{id:(await on(xe(se,qn),{tripId:t,templateId:e,name:l.name||"Checklist",boatId:n.boatId||null,role:n.role||null,userId:n.userId||null,items:l.items.map(d=>({...d,completed:!1,note:""})),createdAt:ue.now(),updatedAt:ue.now()})).id,error:null,duplicate:!1}:{id:null,error:"Template nenalezen",duplicate:!1}}catch(a){if(a.code==="failed-precondition"||(r=a.message)!=null&&r.includes("index"))try{let i=ke(xe(se,qn),ve("tripId","==",t),ve("templateId","==",e));const l=(await Se(i)).docs.filter(h=>{const f=h.data(),m=n.boatId&&f.boatId===n.boatId||!n.boatId&&!f.boatId,_=n.userId&&f.userId===n.userId||!n.userId&&!f.userId,E=n.role&&f.role===n.role||!n.role&&!f.role;return m&&_&&E});if(l.length>0)return{id:l[0].id,error:null,duplicate:!0};const{data:u}=await this.getTemplate(e);return u?{id:(await on(xe(se,qn),{tripId:t,templateId:e,name:u.name||"Checklist",boatId:n.boatId||null,role:n.role||null,userId:n.userId||null,items:u.items.map(h=>({...h,completed:!1,note:""})),createdAt:ue.now(),updatedAt:ue.now()})).id,error:null,duplicate:!1}:{id:null,error:"Template nenalezen",duplicate:!1}}catch(i){return{id:null,error:i.message,duplicate:!1}}return{id:null,error:a.message,duplicate:!1}}},async getTripInstances(t,e={}){try{let n=ke(xe(se,qn),ve("tripId","==",t));e.boatId&&(n=ke(n,ve("boatId","==",e.boatId))),e.role&&(n=ke(n,ve("role","==",e.role))),e.userId&&(n=ke(n,ve("userId","==",e.userId)));const r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{instances:a,error:null}}catch(n){return{instances:[],error:n.message}}},async updateItem(t,e,n){try{const r=Ie(se,qn,t),a=await hn(r);if(!a.exists())return{error:"Instance nenalezena"};const o=a.data().items.map(l=>l.id===e||l.itemId===e?{...l,...n}:l);return await $t(r,{items:o,updatedAt:ue.now()}),{error:null}}catch(r){return{error:r.message}}},async syncInstancesFromTemplate(t){try{const{data:e}=await this.getTemplate(t);if(!e)return{updated:0,error:"Template nenalezen"};const n=ke(xe(se,qn),ve("templateId","==",t)),r=await Se(n);let a=0;const i=[];return r.forEach(o=>{const l=o.data(),u=l.items||[],d=new Map;u.forEach(f=>{const m=f.id||f.itemId;m&&d.set(m,f)});const h=e.items.map(f=>{const m=d.get(f.id||f.itemId);return m?{...f,completed:m.completed||!1,value:m.value||"",note:m.note||""}:{...f,completed:!1,value:"",note:""}});i.push($t(Ie(se,qn,o.id),{name:e.name||l.name,items:h,updatedAt:ue.now()})),a++}),await Promise.all(i),{updated:a,error:null}}catch(e){return{updated:0,error:e.message}}},async deleteInstance(t){try{return await Vn(Ie(se,qn,t)),{error:null}}catch(e){return{error:e.message}}},async deleteInstances(t){try{const e=t.map(n=>Vn(Ie(se,qn,n)));return await Promise.all(e),{deleted:t.length,error:null}}catch(e){return{deleted:0,error:e.message}}}};function Uo({title:t,icon:e,children:n,defaultCollapsed:r=!1,isNew:a=!1,onDelete:i,deleteLabel:o}){const[l,u]=C.useState(a?!1:r);return s.jsxs("div",{className:`collapsable-item ${l?"collapsed":""}`,children:[s.jsxs("div",{className:"collapsable-item-header",onClick:()=>u(!l),children:[s.jsxs("div",{className:"collapsable-item-header-content",children:[s.jsx("i",{className:`fas ${e}`,style:{fontSize:"0.875rem",color:"var(--gray-500)",marginRight:"var(--space-xs)"}}),s.jsx("h5",{className:"collapsable-item-title",children:t||"(Bez nzvu)"})]}),s.jsxs("div",{className:"collapsable-item-actions",onClick:d=>d.stopPropagation(),children:[i&&s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost btn-sm",style:{color:"var(--danger)"},onClick:i,title:o||"Smazat",children:s.jsx("i",{className:"fas fa-trash"})}),s.jsx("i",{className:"fas fa-chevron-down",style:{transform:l?"rotate(-90deg)":"rotate(0deg)",transition:"transform var(--transition-fast)",fontSize:"0.75rem",color:"var(--gray-400)",marginLeft:"var(--space-sm)"}})]})]}),!l&&s.jsx("div",{className:"collapsable-item-content",children:n})]})}function mx(){var D,q,G;const{tripId:t}=ir(),[e]=Fj(),n=_t(),{user:r}=yt(),a=!!t,i=e.get("template"),o=e.get("createTemplate")==="true",l=e.get("templateName"),[u,d]=C.useState({name:l||"",startDate:"",endDate:"",startLocation:"",endLocation:"",locationName:"",locationDescription:"",locationImageUrl:"",checkInDateTime:"",checkOutDateTime:"",tripStops:[],description:"",descriptionForParticipants:"",price:"",priceNote:"",deposit:"",paymentInfo:{accountNumber:"",iban:"",notes:""},bannerImageUrl:"",usefulLinks:[]}),[h,f]=C.useState({participant:[],captain:[]}),[m,_]=C.useState([]),[E,w]=C.useState([]),[x,v]=C.useState([]),[j,S]=C.useState(!1),[R,L]=C.useState(!1),[U,N]=C.useState(!1),[y,k]=C.useState(new Set);C.useEffect(()=>{r&&T(),a&&t?(b(),A(),z(),$()):i&&loadTemplate()},[t,a,i,r]);const b=async()=>{const{data:I,error:O}=await pt.getTrip(t);if(!O&&I){const F=H=>{if(!H)return"";const X=H.toDate?H.toDate():new Date(H.seconds*1e3),te=X.getFullYear(),ae=String(X.getMonth()+1).padStart(2,"0"),pe=String(X.getDate()).padStart(2,"0"),oe=String(X.getHours()).padStart(2,"0"),De=String(X.getMinutes()).padStart(2,"0");return`${te}-${ae}-${pe}T${oe}:${De}`};d({name:I.name||"",startDate:I.startDate?I.startDate.toDate?I.startDate.toDate().toISOString().split("T")[0]:new Date(I.startDate.seconds*1e3).toISOString().split("T")[0]:"",endDate:I.endDate?I.endDate.toDate?I.endDate.toDate().toISOString().split("T")[0]:new Date(I.endDate.seconds*1e3).toISOString().split("T")[0]:"",startLocation:I.startLocation||"",endLocation:I.endLocation||"",locationName:I.locationName||"",locationDescription:I.locationDescription||"",locationImageUrl:I.locationImageUrl||"",description:I.description||"",descriptionForParticipants:I.descriptionForParticipants||"",price:I.price||"",priceNote:I.priceNote||"",deposit:I.deposit||"",paymentInfo:I.paymentInfo||{accountNumber:"",iban:"",notes:""},bannerImageUrl:I.bannerImageUrl||"",usefulLinks:I.usefulLinks||[],checkInDateTime:I.checkInDateTime?F(I.checkInDateTime):"",checkOutDateTime:I.checkOutDateTime?F(I.checkOutDateTime):"",tripStops:Array.isArray(I.tripStops)?I.tripStops:I.tripStops?[{id:Date.now().toString(),name:I.tripStops,description:"",imageUrl:""}]:[]})}},A=async()=>{var O,F;const{data:I}=await Nn.getTemplate(t);f(I?{participant:((O=I.fields)==null?void 0:O.participant)||[],captain:((F=I.fields)==null?void 0:F.captain)||[]}:{participant:[],captain:[]})},z=async()=>{const{events:I,error:O}=await wt.getTripEvents(t);if(!O&&I){const F=I.map(H=>({...H,date:H.date?H.date.toDate?H.date.toDate().toISOString().split("T")[0]:new Date(H.date.seconds*1e3).toISOString().split("T")[0]:""}));_(F)}else _([])},T=async()=>{if(!r)return;const{templates:I,error:O}=await Fe.getTemplates(r.uid);O||w(I)},$=async()=>{const{data:I}=await pt.getTrip(t);I&&I.assignedChecklists?v(I.assignedChecklists):v([])},Q=async I=>{const{events:O}=await wt.getTripEvents(I),F=new Set((O==null?void 0:O.map(X=>X.id))||[]),H=new Set(m.map(X=>X.id).filter(X=>X));for(const X of O||[])H.has(X.id)||await wt.deleteEvent(X.id);for(let X=0;X<m.length;X++){const te=m[X],ae={name:te.name||"",description:te.description||"",type:te.type||"custom",date:te.date||null,roles:te.roles||[],checkable:te.checkable!==!1,order:X};te.id&&F.has(te.id)?await wt.updateEvent(te.id,ae):await wt.createEvent(I,ae)}},B=async I=>{const{participants:O}=await Je.getTripParticipants(I),{boats:F}=await Jt.getTripBoats(I),{instances:H}=await Fe.getTripInstances(I),X=new Set;for(const ae of x){const{templateId:pe,roles:oe,assignToBoats:De}=ae;if(pe){if(oe&&oe.length>0)for(const Te of oe)if(Te==="organizer")X.add(`${pe}:organizer:`);else{const V=O.filter(J=>J.role===Te);for(const J of V)X.add(`${pe}:${Te}:${J.userId}`)}if(De)for(const Te of F)X.add(`${pe}::${Te.id}`)}}const te=[];for(const ae of H){const pe=ae.templateId,oe=ae.role||"",De=ae.userId||"",Te=ae.boatId||"";let V="";oe==="organizer"?V=`${pe}:organizer:`:Te?V=`${pe}::${Te}`:oe&&De&&(V=`${pe}:${oe}:${De}`),V&&!X.has(V)&&te.push(ae.id)}if(te.length>0){const{error:ae}=await Fe.deleteInstances(te);ae&&console.error("Chyba pi mazn instanc checklist:",ae)}for(const ae of x){const{templateId:pe,roles:oe,assignToBoats:De}=ae;if(!pe)continue;const Te=new Set;if(oe&&oe.length>0)for(const V of oe)if(V==="organizer")await Fe.createInstance(I,pe,{role:"organizer"});else{const J=O.filter(Z=>Z.role===V);for(const Z of J)if(!Te.has(Z.userId)){const le=await Fe.createInstance(I,pe,{role:V,userId:Z.userId});le.id&&!le.duplicate&&Te.add(Z.userId)}}if(De)for(const V of F)await Fe.createInstance(I,pe,{boatId:V.id})}},ee=async I=>{if(I.preventDefault(),!r){alert("Muste bt pihleni");return}S(!0);const O={...u,organizerId:r.uid,startDate:u.startDate?ue.fromDate(new Date(u.startDate)):null,endDate:u.endDate?ue.fromDate(new Date(u.endDate)):null,checkInDateTime:u.checkInDateTime?ue.fromDate(new Date(u.checkInDateTime)):null,checkOutDateTime:u.checkOutDateTime?ue.fromDate(new Date(u.checkOutDateTime)):null,price:u.price||null,deposit:u.deposit?parseFloat(u.deposit):null,assignedChecklists:x};if(delete O.addOrganizerAsParticipant,delete O.organizerRole,a){const{error:F}=await pt.updateTrip(t,O);if(F){alert("Chyba pi ukldn: "+F),S(!1);return}const{error:H}=await Nn.saveTemplate(t,{fields:{participant:h.participant||[],captain:h.captain||[]}});H&&(console.error("Chyba pi ukldn crewlist templatu:",H),alert("Chyba pi ukldn definice crewlistu: "+H)),await Q(t),await B(t),n(`/trip/${t}/organizer`)}else{const{id:F,password:H,error:X}=await pt.createTrip(O);if(X){alert("Chyba pi vytven: "+X),S(!1);return}if(F){const{error:te}=await Nn.saveTemplate(F,{fields:{participant:h.participant||[],captain:h.captain||[]}});te&&(console.error("Chyba pi ukldn crewlist templatu:",te),alert("Chyba pi ukldn definice crewlistu: "+te)),await Q(F),await B(F)}if(o&&F){const{error:te}=await nu.createTemplate(r.uid,F,{name:u.name||"Bez nzvu",description:u.description||""});te&&console.error("Chyba pi vytven templatu:",te)}n(`/trip/${F}/organizer`);return}S(!1)},W=async()=>{if(!confirm("Opravdu chcete smazat tuto plavbu? Tato akce je nevratn a smae vechny souvisejc data (astnky, lod, dokumenty, atd.).")||!confirm("Jste si jisti? Tato akce je definitivn."))return;N(!0);const{error:I}=await pt.deleteTrip(t);I?(alert("Chyba pi mazn plavby: "+I),N(!1)):n("/organizing")};return s.jsxs("div",{children:[s.jsx("div",{className:"trip-header",style:{padding:"var(--space-xl) 0"},children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:"/organizing",children:"Organizuji"}),a&&s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:`/trip/${t}/organizer`,children:u.name||"Plavba"})]}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:a?"Upravit":"Nov plavba"})]}),s.jsxs("div",{className:"trip-title-row",style:{marginTop:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",style:{fontSize:"2rem"},children:a?"Upravit plavbu":"Nov plavba"}),a&&u.name&&s.jsx("p",{style:{color:"var(--gray-400)",marginTop:"var(--space-sm)"},children:u.name})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)"},children:[a&&s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:W,disabled:U,style:{background:"rgba(239, 68, 68, 0.2)",borderColor:"rgba(239, 68, 68, 0.4)",color:"white"},children:[s.jsx("i",{className:"fas fa-trash"}),U?"Mazn...":"Smazat plavbu"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>n(-1),style:{background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.3)",color:"white"},children:[s.jsx("i",{className:"fas fa-times"}),"Zruit"]}),s.jsxs("button",{type:"submit",form:"trip-form",className:"btn btn-coral",disabled:j,children:[s.jsx("i",{className:"fas fa-save"}),j?"Ukldn...":a?"Uloit zmny":"Vytvoit plavbu"]})]})]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsx("div",{className:"container",children:s.jsxs("form",{id:"trip-form",onSubmit:ee,children:[s.jsxs("div",{className:"form-section animate-in",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Zkladn informace"]}),s.jsx("p",{children:"Hlavn daje o plavb viditeln pro astnky"})]})})}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Nzev plavby *"}),s.jsx("input",{type:"text",className:"form-input",value:u.name,onChange:I=>d({...u,name:I.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"URL banner obrzku (voliteln)"}),s.jsx("input",{type:"url",className:"form-input",value:u.bannerImageUrl,onChange:I=>d({...u,bannerImageUrl:I.target.value}),placeholder:"https://..."}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Banner obrzek pro hlaviku plavby (doporuen pomr stran 4:1)"}),u.bannerImageUrl&&s.jsx("div",{style:{marginTop:"var(--space-sm)"},children:s.jsx("img",{src:u.bannerImageUrl,alt:"Nhled banneru",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},onError:I=>{I.target.style.display="none"}})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Datum od *"}),s.jsx("input",{type:"date",className:"form-input",value:u.startDate,onChange:I=>d({...u,startDate:I.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Datum do *"}),s.jsx("input",{type:"date",className:"form-input",value:u.endDate,onChange:I=>d({...u,endDate:I.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Cena zjezdu"}),s.jsx("input",{type:"text",className:"form-input",value:u.price,onChange:I=>d({...u,price:I.target.value}),placeholder:"nap. 12 000 K"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Poznmka k cen"}),s.jsx("input",{type:"text",className:"form-input",value:u.priceNote,onChange:I=>d({...u,priceNote:I.target.value}),placeholder:"Co je/nen v cen..."})]})]}),s.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:"var(--space-lg)",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},children:[s.jsxs("h5",{style:{marginBottom:"var(--space-md)",fontSize:"1rem",fontWeight:600},children:[s.jsx("i",{className:"fas fa-money-bill-wave",style:{color:"var(--coral)",marginRight:"var(--space-xs)"}}),"Informace o platbch"]}),s.jsx("p",{className:"text-xs text-muted",style:{marginBottom:"var(--space-md)"},children:"Tyto informace se zobraz astnkm v modalu po kliknut na tlatko u ceny nebo v timeline eventech typu platba."}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"var(--space-md)"},children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"slo tu *"}),s.jsx("input",{type:"text",className:"form-input",value:((D=u.paymentInfo)==null?void 0:D.accountNumber)||"",onChange:I=>d({...u,paymentInfo:{...u.paymentInfo,accountNumber:I.target.value}}),placeholder:"nap. 1234567890"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"IBAN (voliteln)"}),s.jsx("input",{type:"text",className:"form-input",value:((q=u.paymentInfo)==null?void 0:q.iban)||"",onChange:I=>d({...u,paymentInfo:{...u.paymentInfo,iban:I.target.value}}),placeholder:"nap. CZ6508000000192000145399"})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Dal informace"}),s.jsx("textarea",{className:"form-input",rows:3,value:((G=u.paymentInfo)==null?void 0:G.notes)||"",onChange:I=>d({...u,paymentInfo:{...u.paymentInfo,notes:I.target.value}}),placeholder:"Dal informace k platb, termny, zpsob platby..."})]})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"var(--space-md)"},children:[s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Zkrcen popis (voliteln)"}),s.jsx("textarea",{className:"form-input",rows:4,style:{resize:"vertical"},value:u.description,onChange:I=>d({...u,description:I.target.value}),placeholder:"Tento popis uvid zjemci, kte jet nejsou astnky plavby..."}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Zobraz se na veejn strnce plavby pro zjemce. Pokud nen vyplnn, zobraz se popis pro astnky."})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Popis"}),s.jsx("textarea",{className:"form-input",rows:4,style:{resize:"vertical"},value:u.descriptionForParticipants,onChange:I=>d({...u,descriptionForParticipants:I.target.value}),placeholder:"Tento popis uvid pouze astnci, kte se ji pipojili k plavb..."}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Zobraz se pouze astnkm, kte se ji pipojili k plavb."})]})]})]}),s.jsxs("div",{className:"form-section animate-in delay-1",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-map-marker-alt",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),"Lokality"]}),s.jsx("p",{children:"Msto startu, cle a zastvky bhem plavby"})]})})}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{className:"form-label",children:"Nzev lokality (voliteln)"}),s.jsx("input",{type:"text",className:"form-input",value:u.locationName,onChange:I=>d({...u,locationName:I.target.value}),placeholder:"Nap. Jadransk moe, Chorvatsko"})]}),s.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[s.jsx("label",{className:"form-label",children:"Popis lokality (voliteln)"}),s.jsx("textarea",{className:"form-input",value:u.locationDescription,onChange:I=>d({...u,locationDescription:I.target.value}),placeholder:"Popis lokality, zajmavosti, tipy...",rows:3})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Msto startu *"}),s.jsx("input",{type:"text",className:"form-input",value:u.startLocation,onChange:I=>d({...u,startLocation:I.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Msto cle (voliteln)"}),s.jsx("input",{type:"text",className:"form-input",value:u.endLocation,onChange:I=>d({...u,endLocation:I.target.value}),placeholder:"Stejn jako start"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Obrzek lokality (voliteln)"}),s.jsx("input",{type:"url",className:"form-input",value:u.locationImageUrl,onChange:I=>d({...u,locationImageUrl:I.target.value}),placeholder:"https://example.com/image.jpg"}),s.jsx("small",{className:"text-muted",style:{display:"block",marginTop:"var(--space-xs)",fontSize:"0.875rem"},children:"URL obrzku, kter se zobraz na kart lokality"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Check-in datum a as"}),s.jsx("input",{type:"datetime-local",className:"form-input",value:u.checkInDateTime,onChange:I=>d({...u,checkInDateTime:I.target.value})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Check-out datum a as"}),s.jsx("input",{type:"datetime-local",className:"form-input",value:u.checkOutDateTime,onChange:I=>d({...u,checkOutDateTime:I.target.value})})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Zastvky bhem plavby"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[u.tripStops.map((I,O)=>s.jsx(Uo,{title:I.name||`Zastvka ${O+1}`,icon:"fa-map-marker-alt",defaultCollapsed:!0,isNew:y.has(I.id),onDelete:()=>{k(F=>{const H=new Set(F);return H.delete(I.id),H}),d(F=>({...F,tripStops:F.tripStops.filter((H,X)=>X!==O)}))},deleteLabel:"Smazat zastvku",children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",value:I.name||"",onChange:F=>{const H=[...u.tripStops];H[O]={...H[O],name:F.target.value},d(X=>({...X,tripStops:H}))},placeholder:"Nzev zastvky (nap. Ostrov Bra)"}),s.jsx("textarea",{className:"form-input",rows:2,value:I.description||"",onChange:F=>{const H=[...u.tripStops];H[O]={...H[O],description:F.target.value},d(X=>({...X,tripStops:H}))},placeholder:"Popis (voliteln)"}),s.jsx("input",{type:"url",className:"form-input",value:I.imageUrl||"",onChange:F=>{const H=[...u.tripStops];H[O]={...H[O],imageUrl:F.target.value},d(X=>({...X,tripStops:H}))},placeholder:"URL obrzku (voliteln)"}),I.imageUrl&&s.jsx("div",{style:{marginTop:"var(--space-xs)"},children:s.jsx("img",{src:I.imageUrl,alt:I.name||"Nhled",style:{maxWidth:"100%",maxHeight:"150px",borderRadius:"var(--radius-sm)",border:"1px solid var(--gray-200)"},onError:F=>{F.target.style.display="none"}})})]})},I.id)),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{const I=Date.now().toString();k(O=>new Set([...O,I])),d(O=>({...O,tripStops:[...O.tripStops,{id:I,name:"",description:"",imageUrl:""}]}))},children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat zastvku"]})]}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Pidejte zastvky bhem plavby. Kad zastvka me mt nzev, popis a obrzek."})]})]})]}),s.jsxs("div",{className:"form-section animate-in delay-2",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-link",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Uiten odkazy"]}),s.jsx("p",{children:"Pidejte odkazy na extern sluby (WhatsApp skupina, SettleUp, atd.)"})]})})}),s.jsx("div",{style:{padding:"0"},children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[u.usefulLinks.map((I,O)=>s.jsx(Uo,{title:I.label||`Odkaz ${O+1}`,icon:"fa-link",defaultCollapsed:!0,isNew:y.has(I.id),onDelete:()=>{k(F=>{const H=new Set(F);return H.delete(I.id),H}),d(F=>({...F,usefulLinks:F.usefulLinks.filter((H,X)=>X!==O)}))},deleteLabel:"Smazat odkaz",children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",value:I.label||"",onChange:F=>{const H=[...u.usefulLinks];H[O]={...H[O],label:F.target.value},d(X=>({...X,usefulLinks:H}))},placeholder:"Nzev odkazu (nap. WhatsApp skupina)"}),s.jsx("input",{type:"url",className:"form-input",value:I.url||"",onChange:F=>{const H=[...u.usefulLinks];H[O]={...H[O],url:F.target.value},d(X=>({...X,usefulLinks:H}))},placeholder:"URL (https://...)"}),s.jsx("input",{type:"text",className:"form-input",value:I.icon||"",onChange:F=>{const H=[...u.usefulLinks];H[O]={...H[O],icon:F.target.value},d(X=>({...X,usefulLinks:H}))},placeholder:"FontAwesome ikona (nap. fa-whatsapp) - voliteln"})]})},I.id)),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{const I=Date.now().toString();k(O=>new Set([...O,I])),d(O=>({...O,usefulLinks:[...O.usefulLinks,{id:I,label:"",url:"",icon:""}]}))},children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat odkaz"]})]})})]}),s.jsxs("div",{className:"form-section animate-in delay-2",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),"Definice crewlistu"]}),s.jsx("p",{children:"Definujte, jak daje potebujete od astnk a kapitn"})]})})}),s.jsx("div",{style:{marginBottom:"var(--space-md)"},children:s.jsx(gx,{title:"daje pro astnky",fields:h.participant,onFieldsChange:I=>f(O=>({...O,participant:I})),newItemIds:y,setNewItemIds:k})}),s.jsx("div",{children:s.jsx(gx,{title:"daje pro kapitny",fields:h.captain,onFieldsChange:I=>f(O=>({...O,captain:I})),newItemIds:y,setNewItemIds:k})})]}),s.jsxs("div",{className:"form-section animate-in delay-3",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-flag-checkered",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Hlavn checklist (Ped plavbou)"]}),s.jsx("p",{children:"Definujte udlosti a koly, kter je poteba splnit ped plavbou"})]})})}),s.jsx(ZD,{events:m,onEventsChange:_,newItemIds:y,setNewItemIds:k})]}),s.jsxs("div",{className:"form-section animate-in delay-4",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-tasks",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),"Systmov checklisty"]}),s.jsx("p",{children:"Piate systmov checklisty k rolm nebo lodm"})]})})}),s.jsx(JD,{checklistTemplates:E,assignedChecklists:x,onAssignedChange:v,newItemIds:y,setNewItemIds:k})]}),s.jsxs("div",{className:"sticky-actions",children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>n(-1),children:"Zruit"}),s.jsxs("button",{type:"submit",className:"btn btn-coral",disabled:j,children:[s.jsx("i",{className:"fas fa-save"}),j?"Ukldn...":a?"Uloit zmny":"Vytvoit plavbu"]})]})]})})})]})}function gx({title:t,fields:e,onFieldsChange:n,newItemIds:r,setNewItemIds:a}){const i=()=>{const u=`field_${Date.now()}`;a(h=>new Set([...h,u]));const d={id:u,label:"",type:"text",required:!1,helpText:""};n([...e,d])},o=(u,d)=>{const h=[...e];h[u]={...h[u],...d},n(h)},l=u=>{const d=e[u];d!=null&&d.id&&a(h=>{const f=new Set(h);return f.delete(d.id),f}),n(e.filter((h,f)=>f!==u))};return s.jsxs("div",{style:{background:"var(--gray-50)",padding:"var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-sm)"},children:[s.jsx("h4",{style:{fontSize:"1.125rem",margin:0},children:t}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:i,children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat pole"]})]}),e.length===0?s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem",margin:0},children:'Zatm nejsou definovna dn pole. Kliknte na "Pidat pole" pro pidn prvnho pole.'}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:e.map((u,d)=>s.jsxs(Uo,{title:u.label||`Pole ${d+1}`,icon:"fa-list",defaultCollapsed:!0,isNew:r==null?void 0:r.has(u.id),onDelete:()=>l(d),deleteLabel:"Smazat pole",children:[s.jsxs("div",{className:"crewlist-field-grid",style:{gap:"var(--space-sm)",marginBottom:"var(--space-sm)"},children:[s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Nzev pole *"}),s.jsx("input",{type:"text",className:"form-input",value:u.label,onChange:h=>o(d,{label:h.target.value}),placeholder:"nap. Jmno a pjmen",required:!0})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Typ"}),s.jsxs("select",{className:"form-input",value:u.type,onChange:h=>o(d,{type:h.target.value}),children:[s.jsx("option",{value:"text",children:"Text"}),s.jsx("option",{value:"email",children:"Email"}),s.jsx("option",{value:"tel",children:"Telefon"}),s.jsx("option",{value:"date",children:"Datum"}),s.jsx("option",{value:"textarea",children:"Dlouh text"})]})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Povinn"}),s.jsx("div",{style:{display:"flex",alignItems:"center",height:"100%",paddingTop:"1.5rem"},children:s.jsx("input",{type:"checkbox",checked:u.required,onChange:h=>o(d,{required:h.target.checked}),style:{width:"18px",height:"18px",cursor:"pointer"}})})]})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Npovda (voliteln)"}),s.jsx("input",{type:"text",className:"form-input",value:u.helpText||"",onChange:h=>o(d,{helpText:h.target.value}),placeholder:"Voliteln npovda pro uivatele..."})]})]},u.id))})]})}function ZD({events:t,onEventsChange:e,newItemIds:n,setNewItemIds:r}){const a=()=>{const u=`event_${Date.now()}`;r(h=>new Set([...h,u]));const d={id:u,name:"",description:"",type:"custom",date:"",roles:[],checkable:!0,order:t.length};e([...t,d])},i=(u,d)=>{const h=[...t];h[u]={...h[u],...d},e(h)},o=u=>{const d=t[u];d!=null&&d.id&&typeof d.id=="string"&&d.id.startsWith("event_")&&r(h=>{const f=new Set(h);return f.delete(d.id),f}),e(t.filter((h,f)=>f!==u))},l=(u,d)=>{const f=t[u].roles||[],m=f.includes(d)?f.filter(_=>_!==d):[...f,d];i(u,{roles:m})};return s.jsxs("div",{style:{background:"var(--gray-50)",padding:"var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-sm)"},children:[s.jsx("h4",{style:{fontSize:"1.125rem",margin:0},children:"Udlosti ped plavbou"}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:a,children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat udlost"]})]}),t.length===0?s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem",margin:0},children:'Zatm nejsou definovan dn udlosti. Kliknte na "Pidat udlost" pro pidn prvn udlosti.'}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:t.map((u,d)=>{const h=u.id||`new-${d}`;return s.jsxs(Uo,{title:u.name||`Udlost ${d+1}`,icon:"fa-flag-checkered",defaultCollapsed:!0,isNew:n==null?void 0:n.has(h),onDelete:()=>o(d),deleteLabel:"Smazat udlost",children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--space-sm)",marginBottom:"var(--space-sm)"},children:[s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Nzev udlosti *"}),s.jsx("input",{type:"text",className:"form-input",value:u.name,onChange:f=>i(d,{name:f.target.value}),placeholder:"nap. Platba zlohy",required:!0})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Typ"}),s.jsxs("select",{className:"form-input",value:u.type,onChange:f=>i(d,{type:f.target.value}),children:[s.jsx("option",{value:"custom",children:"Vlastn"}),s.jsx("option",{value:"crewlist",children:"Crewlist"}),s.jsx("option",{value:"payment",children:"Platba"})]})]})]}),s.jsxs("div",{className:"form-group",style:{margin:0,marginBottom:"var(--space-sm)"},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Popis"}),s.jsx("textarea",{className:"form-input",rows:2,value:u.description,onChange:f=>i(d,{description:f.target.value}),placeholder:"Popis udlosti..."})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--space-sm)",marginBottom:"var(--space-sm)"},children:[s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Datum splnn (voliteln)"}),s.jsx("input",{type:"date",className:"form-input",value:u.date||"",onChange:f=>i(d,{date:f.target.value})})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Monost oznait jako splnno"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",height:"100%",paddingTop:"1.5rem"},children:[s.jsx("input",{type:"checkbox",checked:u.checkable,onChange:f=>i(d,{checkable:f.target.checked}),style:{width:"18px",height:"18px",cursor:"pointer"}}),s.jsx("span",{style:{marginLeft:"var(--space-sm)",fontSize:"0.875rem"},children:"Checkable"})]})]})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",marginBottom:"var(--space-xs)"},children:"Pro jak role je udlost urena"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:["organizer","captain","participant"].map(f=>{const m={organizer:"Organiztoi",captain:"Kapitni",participant:"astnci"};return s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:(u.roles||[]).includes(f),onChange:()=>l(d,f),style:{width:"18px",height:"18px",cursor:"pointer"}}),s.jsx("span",{style:{fontSize:"0.875rem"},children:m[f]})]},f)})})]})]},h)})})]})}function JD({checklistTemplates:t,assignedChecklists:e,onAssignedChange:n,newItemIds:r,setNewItemIds:a}){const i=()=>{const d=`assignment_${Date.now()}`;a(f=>new Set([...f,d]));const h={id:d,templateId:"",roles:[],assignToBoats:!1};n([...e,h])},o=(d,h)=>{const f=[...e];f[d]={...f[d],...h},n(f)},l=d=>{const h=e[d];h!=null&&h.id&&a(f=>{const m=new Set(f);return m.delete(h.id),m}),n(e.filter((f,m)=>m!==d))},u=(d,h)=>{const m=e[d].roles||[],_=m.includes(h)?m.filter(E=>E!==h):[...m,h];o(d,{roles:_})};return s.jsxs("div",{style:{background:"var(--gray-50)",padding:"var(--space-md)",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-sm)"},children:[s.jsx("h4",{style:{fontSize:"1.125rem",margin:0},children:"Piazen checklisty"}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:i,children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat piazen"]})]}),t.length===0?s.jsxs("p",{className:"text-muted",style:{fontSize:"0.875rem",marginBottom:"var(--space-md)"},children:["Zatm nemte vytvoen dn checklist templaty. Vytvote je v ",s.jsx(ie,{to:"/settings/organizer",target:"_blank",children:"Nastaven organiztora"}),"."]}):null,e.length===0?s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem",margin:0},children:'Zatm nejsou piazeny dn checklisty. Kliknte na "Pidat piazen" pro pidn prvnho piazen.'}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:e.map((d,h)=>{const f=t.find(_=>_.id===d.templateId),m=d.id||`assignment_${h}`;return s.jsxs(Uo,{title:(f==null?void 0:f.name)||`Checklist ${h+1}`,icon:"fa-tasks",defaultCollapsed:!0,isNew:r==null?void 0:r.has(m),onDelete:()=>l(h),deleteLabel:"Smazat piazen",children:[s.jsxs("div",{className:"form-group",style:{margin:0,marginBottom:"var(--space-sm)"},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Checklist *"}),s.jsxs("select",{className:"form-input",value:d.templateId,onChange:_=>o(h,{templateId:_.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Vyberte checklist"}),t.map(_=>s.jsx("option",{value:_.id,children:_.name||"Bez nzvu"},_.id))]})]}),f&&s.jsxs("div",{style:{marginBottom:"var(--space-sm)",padding:"var(--space-xs) var(--space-sm)",background:"var(--gray-50)",borderRadius:"var(--radius-sm)"},children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Popis:"}),s.jsx("div",{className:"text-sm",children:f.description||"Bez popisu"})]}),s.jsxs("div",{className:"form-group",style:{margin:0},children:[s.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",marginBottom:"var(--space-xs)"},children:"Piadit k"}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:[["organizer","captain","participant"].map(_=>{const E={organizer:"Organiztoi",captain:"Kapitni",participant:"astnci"};return s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:(d.roles||[]).includes(_),onChange:()=>u(h,_),style:{width:"18px",height:"18px",cursor:"pointer"}}),s.jsx("span",{style:{fontSize:"0.875rem"},children:E[_]})]},_)}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:d.assignToBoats||!1,onChange:()=>o(h,{assignToBoats:!d.assignToBoats}),style:{width:"18px",height:"18px",cursor:"pointer"}}),s.jsx("span",{style:{fontSize:"0.875rem"},children:"Vem lodm"})]})]})]})]},m)})})]})}const da="tripDocuments",jp={async uploadDocument(t,e,n={}){try{const r=dx(hx,`trips/${t}/documents/${Date.now()}_${e.name}`),a=await zD(r,e),i=await LD(a.ref);return{id:(await on(xe(se,da),{tripId:t,name:n.name||e.name,description:n.description||"",category:n.category||"other",fileName:e.name,fileSize:e.size,fileType:e.type,storagePath:a.ref.fullPath,downloadURL:i,uploadedBy:n.uploadedBy||null,createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(r){return{id:null,error:r.message}}},async getTripDocuments(t){var e;try{const n=ke(xe(se,da),ve("tripId","==",t),nr("createdAt","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{documents:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,da),ve("tripId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{documents:i,error:null}}catch(r){return{documents:[],error:r.message}}return{documents:[],error:n.message}}},async getDocument(t){try{const e=Ie(se,da,t),n=await hn(e);return n.exists()?{data:{id:n.id,...n.data()},error:null}:{data:null,error:"Dokument nenalezen"}}catch(e){return{data:null,error:e.message}}},async updateDocument(t,e){try{const n=Ie(se,da,t);return await $t(n,{...e,updatedAt:ue.now()}),{error:null}}catch(n){return{error:n.message}}},async deleteDocument(t){try{const{data:e}=await this.getDocument(t);if(!e)return{error:"Dokument nenalezen"};if(e.storagePath){const n=dx(hx,e.storagePath);await OD(n)}return await Vn(Ie(se,da,t)),{error:null}}catch(e){return{error:e.message}}},async getDownloadURL(t){try{const{data:e}=await this.getDocument(t);return e?{url:e.downloadURL,error:null}:{url:null,error:"Dokument nenalezen"}}catch(e){return{url:null,error:e.message}}}};function rr(t,e){return(t==null?void 0:t.organizerId)===e}function il(t,e){return(t==null?void 0:t.userId)===e&&(t==null?void 0:t.role)==="captain"}function YD(t,e){return(t==null?void 0:t.userId)===e}function jN(t,e){return rr(t,e)}function XD(t,e,n,r){return!!(rr(t,r)||il(n,r)&&(n==null?void 0:n.boatId)===(e==null?void 0:e.id))}function e2(t,e,n,r){return!!(rr(t,r)||il(n,r)&&(n==null?void 0:n.boatId)===(e==null?void 0:e.id))}function t2(t,e,n,r){return!!(rr(t,r)||il(n,r)&&(n==null?void 0:n.boatId)===(e==null?void 0:e.id)||YD(n,r)&&(n==null?void 0:n.boatId)===(e==null?void 0:e.id))}function n2(t,e,n){return!!(rr(t,n)||(e==null?void 0:e.userId)===n)}function r2(t,e){return rr(t,e)}function s2(t,e,n,r,a,i){return!t||!r||!n?!1:!!(i==="organizer"&&rr(t,r)||i==="captain"&&il(n,r)&&a===r)}function Tm(t,e,n){if(!t||!n)return[];const r=[];return t.organizerId===n&&r.push("organizer"),e&&e.userId===n&&(e.role==="captain"?r.push("captain"):r.push("participant")),r}function Ma(t){return{organizer:"Organiztor",captain:"Kapitn",participant:"astnk"}[t]||t}function _N(t,e,n,r,a){return!t||!e||!a?!1:!!(rr(t,a)||e.boatId&&n&&n.id===e.boatId&&il(r,a)&&(r==null?void 0:r.boatId)===n.id||e.userId===a||e.role==="organizer"&&rr(t,a))}const Ua=new Map;async function NN(t){if(!t)return null;if(Ua.has(t))return Ua.get(t);try{const{data:e,error:n}=await ps.getProfile(t);return n||!e?null:(Ua.set(t,e),e)}catch(e){return console.error("Error fetching user profile:",e),null}}async function bN(t,e="NN"){if(!t)return e;const n=await NN(t);if(n!=null&&n.name){const r=n.name.trim().split(/\s+/);return r.length>=2?(r[0][0]+r[r.length-1][0]).toUpperCase():n.name.substring(0,2).toUpperCase()}return t.substring(0,2).toUpperCase()}async function pi(t){if(!t||t.length===0)return new Map;const e=new Map,n=[];for(const r of t)Ua.has(r)?e.set(r,Ua.get(r)):n.push(r);if(n.length>0){const r=n.map(i=>NN(i));(await Promise.all(r)).forEach((i,o)=>{if(i){const l=n[o];e.set(l,i)}})}return e}function a2(){Ua.clear()}const ni=({isOpen:t,onClose:e,title:n,children:r,maxHeight:a=80})=>{const[i,o]=C.useState(!1),[l,u]=C.useState(!1),[d,h]=C.useState(!1),f=C.useRef(null),m=300;if(C.useEffect(()=>{let x,v;return t?(o(!0),x=setTimeout(()=>{u(!0)},50)):(u(!1),v=setTimeout(()=>{o(!1)},m)),()=>{clearTimeout(x),clearTimeout(v)}},[t]),C.useEffect(()=>(i?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[i]),C.useEffect(()=>{const x=()=>{if(f.current){const{scrollHeight:v,clientHeight:j,scrollTop:S}=f.current,R=v>j,L=S+j>=v-10;h(R&&!L)}};return i&&l&&(setTimeout(x,100),window.addEventListener("resize",x),f.current&&f.current.addEventListener("scroll",x)),()=>{window.removeEventListener("resize",x),f.current&&f.current.removeEventListener("scroll",x)}},[i,l]),typeof document>"u"||!i)return null;const _={position:"fixed",inset:"0px",backgroundColor:"rgba(0, 0, 0, 0.4)",backdropFilter:"blur(4px)",zIndex:100,transition:`opacity ${m}ms ease-in-out`,opacity:l?1:0,pointerEvents:l?"auto":"none",touchAction:"none"},E={position:"fixed",bottom:"0px",left:"0px",right:"0px",zIndex:110,width:"100%",maxWidth:"48rem",marginLeft:"auto",marginRight:"auto",padding:"1.5rem",backgroundColor:"var(--white)",color:"var(--gray-800)",borderTopLeftRadius:"1.5rem",borderTopRightRadius:"1.5rem",boxShadow:"0 -10px 15px -3px rgb(0 0 0 / 0.1), 0 -4px 6px -4px rgb(0 0 0 / 0.1)",overflow:"hidden",maxHeight:"90vh",display:"flex",flexDirection:"column",willChange:"transform"},w=l?"opening":"closing";return ju.createPortal(s.jsxs(s.Fragment,{children:[s.jsx("div",{style:_,onClick:e,"aria-hidden":"true"}),s.jsxs("div",{style:E,role:"dialog","aria-modal":"true","aria-labelledby":"drawer-title",onClick:x=>x.stopPropagation(),className:`bottom-drawer-wrapper ${w}`,children:[s.jsxs("div",{className:"bottom-drawer-header",children:[s.jsx("h2",{id:"drawer-title",className:"bottom-drawer-title",children:typeof n=="string"?n:s.jsx("span",{children:n})}),s.jsx("button",{onClick:e,className:"bottom-drawer-close","aria-label":"Zavt",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{ref:f,className:`bottom-drawer-content ${d?"scrollable":""}`,style:{maxHeight:`${Math.min(a,90)}vh`,overflowY:"auto",flex:1,minHeight:0,position:"relative"},children:[r,d&&s.jsx("div",{className:"bottom-drawer-scroll-indicator",children:s.jsx("i",{className:"fas fa-chevron-down"})})]})]})]}),document.body)};function i2({tripId:t,onClose:e,onSuccess:n}){const{user:r}=yt(),a=lr("(max-width: 768px)"),[i,o]=C.useState(null),[l,u]=C.useState(""),[d,h]=C.useState("participant"),[f,m]=C.useState(""),[_,E]=C.useState([]),[w,x]=C.useState(!1),[v,j]=C.useState(""),[S,R]=C.useState(!1);C.useEffect(()=>{L()},[]);const L=async()=>{const[b,A]=await Promise.all([pt.getTrip(t),Jt.getTripBoats(t)]);if(b.data){let z=b.data;if(!z.password){const{password:T}=await pt.generateAndSetPassword(t);T&&(z={...z,password:T})}o(z)}A.boats&&E(A.boats)},U=b=>{navigator.clipboard.writeText(b).then(()=>{})},N=async()=>{if(!r||!i||r.uid!==i.organizerId){j("Nemte oprvnn");return}R(!0),j("");const{id:b,error:A}=await Je.addParticipant(t,r.uid,"participant",null);if(A){j("Chyba pi pidvn: "+A),R(!1);return}R(!1),n&&n(),e()},y=async b=>{if(b.preventDefault(),!l){j("Zadejte emailovou adresu");return}x(!0),j(""),j("Email pozvnky budou odeslny. Pro okamit pipojen pouijte ID a heslo."),x(!1)},k=s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Sdliteln odkaz a heslo"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Odkaz na plavbu"}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",value:i!=null&&i.id?`${window.location.origin}/trip/${i.id}/public`:"",readOnly:!0,style:{flex:1,fontFamily:"monospace",fontSize:"0.875rem"}}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>U(i!=null&&i.id?`${window.location.origin}/trip/${i.id}/public`:""),children:s.jsx("i",{className:"fas fa-copy"})})]})]}),s.jsxs("div",{style:{marginTop:"var(--space-md)"},children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Heslo pro pipojen"}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",value:(i==null?void 0:i.password)||"",readOnly:!0,style:{flex:1,fontFamily:"monospace",fontWeight:600}}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>U((i==null?void 0:i.password)||""),children:s.jsx("i",{className:"fas fa-copy"})})]})]}),s.jsx("p",{className:"text-sm text-muted",style:{marginTop:"var(--space-md)"},children:"Zkoprujte odkaz a polete jej zjemcm spolu s heslem. Odkaz mete poslat i bez hesla, pokud chcete pouze informovat zjemce - heslo jim poskytnete pozdji."})]}),s.jsx("div",{style:{margin:"var(--space-xl) 0",borderTop:"1px solid var(--gray-200)"}}),s.jsx("div",{style:{opacity:.6,pointerEvents:"none"},children:s.jsx("form",{onSubmit:y,children:s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{className:"form-label",children:["Pozvat pes e-mail",s.jsx("span",{style:{marginLeft:"var(--space-xs)",fontSize:"0.75rem",color:"var(--gray-500)"},children:"(Funkce bude brzy dostupn)"})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginBottom:"var(--space-sm)"},children:[s.jsx("input",{type:"email",className:"form-input",value:l,onChange:b=>u(b.target.value),placeholder:"email@example.com",style:{flex:1},disabled:!0}),s.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:!0,children:[s.jsx("i",{className:"fas fa-paper-plane"})," Poslat pozvnku"]})]}),_.length>0&&s.jsxs("div",{className:"form-group",style:{marginTop:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Piadit do lod (voliteln)"}),s.jsxs("select",{className:"form-input",value:f,onChange:b=>m(b.target.value),disabled:!0,children:[s.jsx("option",{value:"",children:"Nepiazeno"}),_.map(b=>s.jsx("option",{value:b.id,children:b.name||`Lo ${b.id.substring(0,8)}`},b.id))]})]}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Email pozvnky budou brzy dostupn. Pro okamit pozvn pouijte sdlen odkaz a heslo ve."})]})})}),v&&s.jsxs("div",{style:{padding:"var(--space-md)",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius-md)",color:"var(--danger)",marginTop:"var(--space-md)"},children:[s.jsx("i",{className:"fas fa-exclamation-circle"})," ",v]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-lg)",flexWrap:"wrap"},children:[r&&i&&i.organizerId===r.uid&&s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:N,disabled:S,style:{flex:a?"1 1 100%":"0 0 auto"},children:[s.jsx("i",{className:"fas fa-user-plus"}),S?"Pidvn...":"Pidat sebe jako astnka"]}),!a&&s.jsx("button",{type:"button",className:"btn btn-primary",onClick:e,style:{flex:"0 0 auto"},children:"Zavt"})]})]});return i?a?s.jsx(ni,{isOpen:!0,onClose:e,title:"Pozvat astnky",maxHeight:80,children:k}):s.jsx("div",{className:"modal-overlay active",onClick:e,children:s.jsxs("div",{className:"modal",onClick:b=>b.stopPropagation(),style:{maxWidth:"800px"},children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h4",{children:"Pozvat astnky"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"modal-body",children:k})]})}):a?s.jsx(ni,{isOpen:!0,onClose:e,title:"Pozvat astnky",maxHeight:80,children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)"},children:"Natn..."})}):s.jsx("div",{className:"modal-overlay active",onClick:e,children:s.jsxs("div",{className:"modal",onClick:b=>b.stopPropagation(),style:{maxWidth:"800px"},children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h4",{children:"Pozvat astnky"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"modal-body",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)"},children:"Natn..."})})]})})}function kN({tripId:t,boatId:e,canEdit:n=!1,userId:r=null,viewContext:a="participant",trip:i=null}){var $,Q;const[o,l]=C.useState(null),[u,d]=C.useState([]),[h,f]=C.useState([]),[m,_]=C.useState(new Map),[E,w]=C.useState(!0),[x,v]=C.useState({}),[j,S]=C.useState(!1);C.useEffect(()=>{R()},[t,e]);const R=async()=>{w(!0);const{data:B}=await Nn.getTemplate(t);B&&l(B);const{data:ee}=await Nn.getBoatCrewlistData(t,e);d(ee);const{participants:W}=await Je.getBoatParticipants(t,e);f(W);const D=W.map(q=>q.userId);if(D.length>0){const q=await pi(D);_(q)}w(!1)};if(C.useEffect(()=>{if(!o||!o.fields||!e||h.length===0){v({});return}},[o,h,u,e]),E)return s.jsx("div",{className:"crewlist-loading",children:"Natn crewlistu..."});if(!o||!o.fields)return s.jsx("div",{className:"crewlist-empty",children:s.jsx("p",{children:"Organiztor zatm nedefinoval poadovan daje pro crewlist."})});const L=[];Object.keys(o.fields).forEach(B=>{o.fields[B].forEach(ee=>{L.find(W=>W.id===ee.id)||L.push(ee)})});const U=(($=o.fields)==null?void 0:$.participant)||[],N=((Q=o.fields)==null?void 0:Q.captain)||[],y=[...U,...N],k=B=>!i||!r||!n?!1:s2(i,null,B,r,B.userId,a),b=B=>{v(ee=>{if(ee[B]){const W=ee[B];z(B,W);const D={...ee};return delete D[B],D}else{const W=h.find(G=>G.id===B);if(!W)return ee;const D=u.find(G=>G.userId===W.userId),q={};return y.forEach(G=>{q[G.id]=(D==null?void 0:D[G.id])||""}),{...ee,[B]:q}}})},A=(B,ee,W)=>{v(D=>({...D,[B]:{...D[B],[ee]:W}}))},z=async(B,ee)=>{const W=h.find(G=>G.id===B);if(!W||!e)return;S(!0);const{id:D,error:q}=await Nn.saveCrewlistData(t,e,W.userId,ee);q?(alert("Chyba pi ukldn: "+q),await R()):await R(),S(!1)},T=async(B,ee,W)=>{const D=x[B];if(!D)return;const q={...D,[ee]:W};await z(B,q),v(G=>({...G,[B]:q}))};return s.jsxs("div",{className:"crewlist-view",children:[s.jsx("div",{className:"crewlist-table-container",children:s.jsxs("table",{className:"crewlist-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Jmno"}),L.map(B=>s.jsx("th",{children:B.label},B.id))]})}),s.jsx("tbody",{children:h.map(B=>{const ee=u.find(G=>G.userId===B.userId),W=B.userId===r,D=!!x[B.id],q=k(B);return s.jsxs("tr",{className:D?"editing-row":"",children:[s.jsx("td",{className:"participant-name",style:{padding:"var(--space-md)",position:"relative"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("span",{children:(()=>{const G=m.get(B.userId);return(G==null?void 0:G.name)||"Neznm uivatel"})()}),W&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.7rem",padding:"2px 6px"},children:"J"}),B.role==="captain"&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.75rem"},children:"Kapitn"}),q&&s.jsx("button",{className:"btn btn-icon btn-ghost",style:{padding:"var(--space-xs)",marginLeft:"auto",color:D?"var(--success)":"var(--gray-400)"},onClick:()=>b(B.id),title:D?"Uloit zmny":"Upravit dek",disabled:j,children:s.jsx("i",{className:`fas ${D?"fa-check":"fa-edit"}`})})]})}),L.map(G=>{const I=y.some(H=>H.id===G.id),O=D&&I;let F="";return D&&x[B.id]?F=x[B.id][G.id]!==void 0?x[B.id][G.id]:(ee==null?void 0:ee[G.id])||"":F=(ee==null?void 0:ee[G.id])||"-",s.jsx("td",{style:{padding:"var(--space-md)"},children:O?G.type==="textarea"?s.jsx("textarea",{className:"form-input",style:{width:"100%",minHeight:"60px",resize:"vertical"},value:F,onChange:H=>A(B.id,G.id,H.target.value),onBlur:H=>T(B.id,G.id,H.target.value),placeholder:G.placeholder,disabled:j}):s.jsx("input",{type:G.type||"text",className:"form-input",style:{width:"100%"},value:F,onChange:H=>A(B.id,G.id,H.target.value),onBlur:H=>T(B.id,G.id,H.target.value),placeholder:G.placeholder,disabled:j}):F},G.id)})]},B.id)})})]})}),h.length===0&&s.jsx("div",{className:"crewlist-empty",children:s.jsx("p",{children:"Na tto lodi zatm nejsou dn astnci."})})]})}function Hu({instance:t,onUpdate:e,canEdit:n=!0,canView:r=!0,isOwnChecklist:a=!1,defaultMode:i="view"}){const[o,l]=C.useState(t),[u,d]=C.useState(i==="edit"&&n);C.useEffect(()=>{l(t)},[t]);const h=!u||!n,f=n&&!a&&!u,m=async(w,x)=>{if(!n||h)return;const v=o.items.map(R=>(R.id||R.itemId)===w?{...R,...x}:R),j={...o,items:v};l(j);const{error:S}=await Fe.updateItem(o.id,w,x);S?(l(t),alert("Chyba pi ukldn: "+S)):e&&e(j)};if(!r)return s.jsx("p",{style:{color:"var(--gray-500)"},children:"Nemte oprvnn zobrazit tento checklist."});if(!o||!o.items)return s.jsx("p",{style:{color:"var(--gray-500)"},children:"Checklist neobsahuje dn poloky."});o.items.filter(w=>w.completed).length,o.items.length;const _={},E=[];return o.items.forEach((w,x)=>{const v=w.id||w.itemId||x.toString(),j=w.category||"";j?(_[j]||(_[j]=[]),_[j].push({...w,itemId:v})):E.push({...w,itemId:v})}),s.jsxs("div",{children:[f&&s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"var(--space-md)"},children:s.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>d(!0),children:[s.jsx("i",{className:"fas fa-edit"})," Upravit"]})}),u&&!a&&s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"var(--space-md)"},children:s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>d(!1),children:[s.jsx("i",{className:"fas fa-eye"})," Zobrazit"]})}),o.description&&s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:o.description}),Object.keys(_).length>0||E.length>0?s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:[Object.keys(_).map(w=>s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-sm)",paddingBottom:"var(--space-xs)",borderBottom:"1px solid var(--gray-200)"},children:w}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:_[w].map(x=>{const v=x.inputType||"checkbox",j=x.allowNote||!1,S=x.completed||!1,R=x.value!==void 0?x.value:S?!0:"";return s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)",padding:"var(--space-sm)",background:S&&v==="checkbox"?"rgba(16, 185, 129, 0.1)":"var(--white)",borderRadius:"var(--radius-sm)",border:`1px solid ${S&&v==="checkbox"?"var(--success)":"var(--gray-200)"}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[v==="checkbox"?s.jsx("input",{type:"checkbox",checked:S,onChange:()=>m(x.itemId,{completed:!S}),disabled:h||!n}):null,s.jsx("span",{style:{flex:1,textDecoration:S&&v==="checkbox"?"line-through":"none",opacity:S&&v==="checkbox"?.7:1},children:x.name||x.text||"Poloka"}),v==="number"&&s.jsx("input",{type:"number",className:"form-input",style:{width:"100px",fontSize:"0.875rem"},value:R,onChange:L=>{const U=L.target.value?parseFloat(L.target.value):null;m(x.itemId,{value:U,completed:U!==null&&U!==""})},disabled:h||!n,placeholder:"0"}),v==="text"&&s.jsx("input",{type:"text",className:"form-input",style:{width:"200px",fontSize:"0.875rem"},value:R||"",onChange:L=>{const U=L.target.value;m(x.itemId,{value:U,completed:U!==""})},disabled:h||!n,placeholder:"Zadejte text..."})]}),j&&s.jsx("div",{style:{marginTop:"var(--space-xs)"},children:s.jsx("input",{type:"text",className:"form-input",style:{width:"100%",fontSize:"0.875rem"},value:x.note||"",onChange:L=>m(x.itemId,{note:L.target.value}),disabled:h||!n,placeholder:"Poznmka (voliteln)..."})}),!j&&x.note&&s.jsxs("div",{className:"text-xs text-muted",style:{fontStyle:"italic",marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-sticky-note"})," ",x.note]})]},x.itemId)})})]},w)),E.length>0&&s.jsxs("div",{children:[Object.keys(_).length>0&&s.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-sm)",paddingBottom:"var(--space-xs)",borderBottom:"1px solid var(--gray-200)"},children:"Ostatn"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:E.map(w=>{const x=w.inputType||"checkbox",v=w.allowNote||!1,j=w.completed||!1,S=w.value!==void 0?w.value:j?!0:"";return s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)",padding:"var(--space-sm)",background:j&&x==="checkbox"?"rgba(16, 185, 129, 0.1)":"var(--white)",borderRadius:"var(--radius-sm)",border:`1px solid ${j&&x==="checkbox"?"var(--success)":"var(--gray-200)"}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[x==="checkbox"?s.jsx("input",{type:"checkbox",checked:j,onChange:()=>m(w.itemId,{completed:!j}),disabled:h||!n}):null,s.jsx("span",{style:{flex:1,textDecoration:j&&x==="checkbox"?"line-through":"none",opacity:j&&x==="checkbox"?.7:1},children:w.name||w.text||"Poloka"}),x==="number"&&s.jsx("input",{type:"number",className:"form-input",style:{width:"100px",fontSize:"0.875rem"},value:S,onChange:R=>{const L=R.target.value?parseFloat(R.target.value):null;m(w.itemId,{value:L,completed:L!==null&&L!==""})},disabled:h||!n,placeholder:"0"}),x==="text"&&s.jsx("input",{type:"text",className:"form-input",style:{width:"200px",fontSize:"0.875rem"},value:S||"",onChange:R=>{const L=R.target.value;m(w.itemId,{value:L,completed:L!==""})},disabled:h||!n,placeholder:"Zadejte text..."})]}),v&&s.jsx("div",{style:{marginTop:"var(--space-xs)"},children:s.jsx("input",{type:"text",className:"form-input",style:{width:"100%",fontSize:"0.875rem"},value:w.note||"",onChange:R=>m(w.itemId,{note:R.target.value}),disabled:h||!n,placeholder:"Poznmka (voliteln)..."})}),!v&&w.note&&s.jsxs("div",{className:"text-xs text-muted",style:{fontStyle:"italic",marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-sticky-note"})," ",w.note]})]},w.itemId)})})]})]}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Tento checklist neobsahuje dn poloky."})]})}function TN({isOpen:t,onClose:e,paymentInfo:n}){const r=lr("(max-width: 768px)");if(!t&&!r)return null;const a=s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-lg)"},children:[n!=null&&n.accountNumber||n!=null&&n.iban||n!=null&&n.notes?s.jsxs(s.Fragment,{children:[n.accountNumber&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-university",style:{marginRight:"var(--space-xs)"}}),"slo tu"]}),s.jsx("div",{className:"font-semibold",style:{fontSize:"1.125rem",color:"var(--gray-700)"},children:n.accountNumber})]}),n.iban&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-globe",style:{marginRight:"var(--space-xs)"}}),"IBAN"]}),s.jsx("div",{className:"font-semibold",style:{fontSize:"1.125rem",color:"var(--gray-700)"},children:n.iban})]}),n.notes&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-info-circle",style:{marginRight:"var(--space-xs)"}}),"Dal informace"]}),s.jsx("div",{className:"text-sm",style:{whiteSpace:"pre-wrap",color:"var(--gray-600)",lineHeight:1.6},children:n.notes})]})]}):s.jsx("p",{className:"text-muted",style:{textAlign:"center",padding:"var(--space-lg)"},children:"Informace o platbch nejsou k dispozici."}),!r&&s.jsx("div",{style:{marginTop:"var(--space-md)"},children:s.jsx("button",{type:"button",className:"btn btn-primary",onClick:e,style:{width:"100%"},children:"Zavt"})})]});if(r)return s.jsx(ni,{isOpen:t,onClose:e,title:s.jsxs("span",{children:[s.jsx("i",{className:"fas fa-money-bill-wave",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),"Informace o platbch"]}),maxHeight:80,children:a});const i=s.jsx("div",{className:"modal-overlay active",onClick:e,children:s.jsxs("div",{className:"modal",onClick:o=>o.stopPropagation(),style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-money-bill-wave",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),"Informace o platbch"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"modal-body",children:a})]})});return ju.createPortal(i,document.body)}function Ku({trip:t,tripId:e,showEditButton:n=!1,viewType:r="participant",onShowMore:a=null}){const[i,o]=C.useState(!1),l=u=>{if(!u)return"";try{let d;return u.toDate?d=u.toDate():u.seconds?d=new Date(u.seconds*1e3):typeof u=="string"?d=new Date(u):d=new Date(u),isNaN(d.getTime())?"":d.toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}};return s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Informace o plavb"]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[a&&(r!=="public"||t.description)&&s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:a,children:[s.jsx("i",{className:"fas fa-expand"}),"Vce informac"]}),n&&e&&s.jsxs(ie,{to:`/trip/${e}/edit`,className:"btn btn-sm btn-ghost",children:[s.jsx("i",{className:"fas fa-edit"})," Upravit"]})]})]}),s.jsx("div",{style:{color:"var(--gray-600)",lineHeight:1.8},children:r==="public"?t.description?s.jsx("p",{style:{marginBottom:"var(--space-md)",whiteSpace:"pre-wrap"},children:t.description}):t.descriptionForParticipants?s.jsx("p",{style:{marginBottom:"var(--space-md)",whiteSpace:"pre-wrap"},children:t.descriptionForParticipants}):s.jsx("p",{style:{marginBottom:"var(--space-md)",color:"var(--gray-400)"},children:"Zatm nen pidn popis plavby."}):t.descriptionForParticipants?s.jsx("p",{style:{marginBottom:"var(--space-md)",whiteSpace:"pre-wrap"},children:t.descriptionForParticipants}):s.jsx("p",{style:{marginBottom:"var(--space-md)",color:"var(--gray-400)"},children:"Zatm nen pidn popis plavby."})}),(t.checkInDateTime||t.checkOutDateTime)&&s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"var(--space-md)",marginTop:"var(--space-xl)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--gray-100)"},children:[t.checkInDateTime&&s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)"},children:s.jsx("i",{className:"fas fa-calendar-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",children:"Check-in"}),s.jsx("div",{className:"font-medium",children:l(t.checkInDateTime)})]})]}),t.checkOutDateTime&&s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(251, 113, 133, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--coral)"},children:s.jsx("i",{className:"fas fa-calendar-times"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",children:"Check-out"}),s.jsx("div",{className:"font-medium",children:l(t.checkOutDateTime)})]})]})]}),t.price&&s.jsxs("div",{className:"trip-price-section",style:{background:"var(--gray-50)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",padding:"var(--space-lg)",marginTop:"var(--space-lg)"},children:[s.jsxs("div",{className:"trip-price-header",style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:t.priceNote?"var(--space-sm)":0,flexWrap:"wrap"},children:[s.jsx("div",{style:{width:"36px",height:"36px",background:"rgba(251, 113, 133, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--coral)",fontSize:"1rem",flexShrink:0},children:s.jsx("i",{className:"fas fa-tag"})}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"2px"},children:"Cena"}),s.jsx("div",{className:"font-semibold",style:{fontSize:"1.125rem",color:"var(--coral)"},children:t.price})]}),r!=="public"&&t.paymentInfo&&s.jsxs("button",{className:"btn btn-sm btn-secondary trip-payment-button",onClick:()=>o(!0),style:{flexShrink:0},children:[s.jsx("i",{className:"fas fa-money-bill-wave"}),s.jsx("span",{className:"trip-payment-button-text",children:"Informace o platbch"})]})]}),t.priceNote&&s.jsx("p",{className:"text-sm text-muted",style:{marginTop:"var(--space-sm)",paddingTop:"var(--space-sm)",borderTop:"1px solid var(--gray-200)"},children:t.priceNote})]}),s.jsx(TN,{isOpen:i,onClose:()=>o(!1),paymentInfo:t==null?void 0:t.paymentInfo})]})}function Gu({trip:t}){const e=n=>{if(!n)return"";try{let r;return n.toDate?r=n.toDate():n.seconds?r=new Date(n.seconds*1e3):typeof n=="string"?r=new Date(n):r=new Date(n),isNaN(r.getTime())?"":r.toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}};return!t.startLocation&&!t.endLocation&&!t.tripStops&&!t.locationName?null:s.jsxs("div",{className:"card animate-in delay-1",style:{marginBottom:"var(--space-xl)"},children:[s.jsxs("h4",{className:"card-title",style:{marginBottom:"var(--space-lg)"},children:[s.jsx("i",{className:"fas fa-map-marked-alt",style:{color:"var(--coral)"}}),"Lokalita"]}),s.jsx("div",{className:"map-placeholder",style:t.locationImageUrl?{background:`url(${t.locationImageUrl}) center/cover no-repeat`,minHeight:"200px",opacity:1}:{},children:!t.locationImageUrl&&s.jsx("i",{className:"fas fa-map"})}),(t.locationName||t.locationDescription)&&s.jsxs("div",{style:{marginBottom:"var(--space-lg)"},children:[t.locationName&&s.jsx("h3",{style:{marginBottom:"var(--space-sm)",fontSize:"1.25rem",fontWeight:600},children:t.locationName}),t.locationDescription&&s.jsx("p",{style:{color:"var(--gray-600)",whiteSpace:"pre-wrap",lineHeight:1.6},children:t.locationDescription})]}),s.jsxs("div",{className:"location-info",children:[t.startLocation&&s.jsxs("div",{className:"location-item",children:[s.jsx("div",{className:"location-icon",children:s.jsx("i",{className:"fas fa-anchor"})}),s.jsxs("div",{className:"location-text",children:[s.jsx("h5",{children:"Msto startu"}),s.jsx("p",{children:t.startLocation}),t.checkInDateTime&&s.jsxs("p",{className:"text-sm text-muted",style:{marginTop:"var(--space-xs)"},children:["Check-in: ",e(t.checkInDateTime)]})]})]}),t.endLocation&&s.jsxs("div",{className:"location-item",children:[s.jsx("div",{className:"location-icon",children:s.jsx("i",{className:"fas fa-flag-checkered"})}),s.jsxs("div",{className:"location-text",children:[s.jsx("h5",{children:"Cl plavby"}),s.jsx("p",{children:t.endLocation})]})]})]}),t.tripStops&&s.jsxs("div",{style:{marginTop:"var(--space-xl)",paddingTop:"var(--space-xl)",borderTop:"1px solid var(--gray-100)"},children:[s.jsxs("h5",{style:{marginBottom:"var(--space-lg)"},children:[s.jsx("i",{className:"fas fa-map-pin",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Zastvky bhem plavby"]}),Array.isArray(t.tripStops)&&t.tripStops.length>0?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"var(--space-md)"},children:t.tripStops.map(n=>s.jsxs("div",{style:{background:"var(--gray-50)",borderRadius:"var(--radius-md)",overflow:"hidden",border:"1px solid var(--gray-200)"},children:[s.jsx("div",{style:{height:"100px",background:n.imageUrl?`url(${n.imageUrl})`:"linear-gradient(135deg, var(--ocean-mid), var(--turquoise))",backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center",color:n.imageUrl?"transparent":"white",fontSize:"1.5rem",position:"relative"},children:!n.imageUrl&&s.jsx("i",{className:"fas fa-map-marker-alt"})}),s.jsxs("div",{style:{padding:"var(--space-md)"},children:[s.jsx("div",{className:"font-medium",children:n.name||"Bez nzvu"}),n.description&&s.jsx("div",{className:"text-sm text-muted",style:{marginTop:"var(--space-xs)"},children:n.description})]})]},n.id||n.name))}):typeof t.tripStops=="string"&&t.tripStops.trim()?s.jsx("p",{style:{color:"var(--gray-600)",whiteSpace:"pre-wrap"},children:t.tripStops}):null]})]})}function Em({usefulLinks:t=[]}){if(!t||t.length===0)return null;const e=n=>{if(!n)return"fas fa-external-link-alt";const r=["whatsapp","facebook","instagram","twitter","youtube","linkedin","github","telegram","discord"],a=n.replace(/^fa-/,"").replace(/^fas fa-/,"").replace(/^fab fa-/,"");return r.includes(a)?`fab fa-${a}`:n.startsWith("fa-")||n.startsWith("fas ")||n.startsWith("fab ")||n.startsWith("far ")?n:`fas fa-${n}`};return s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-link",style:{color:"var(--turquoise)"}}),"Uiten odkazy"]}),s.jsx("div",{style:{marginTop:"var(--space-md)",display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:t.map(n=>s.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:"var(--space-sm)",padding:"var(--space-sm) var(--space-md)",borderRadius:"var(--radius-sm)",textDecoration:"none",color:"var(--turquoise)",fontWeight:500,transition:"all 0.2s",fontSize:"0.875rem",border:"1px solid var(--gray-200)",background:"var(--white)"},onMouseEnter:r=>{r.currentTarget.style.background="var(--turquoise)",r.currentTarget.style.color="var(--white)",r.currentTarget.style.borderColor="var(--turquoise)",r.currentTarget.style.transform="translateX(4px)"},onMouseLeave:r=>{r.currentTarget.style.background="var(--white)",r.currentTarget.style.color="var(--turquoise)",r.currentTarget.style.borderColor="var(--gray-200)",r.currentTarget.style.transform="translateX(0)"},children:[s.jsx("i",{className:e(n.icon),style:{width:"20px",textAlign:"center",color:"inherit"}}),s.jsx("span",{children:n.name||n.label||"Odkaz"})]},n.id||n.name))})]})}function Im({boat:t,participantCount:e=0,highlighted:n=!1,clickable:r=!1,onClick:a=null,showDetails:i=!1,viewType:o="participant"}){if(!t)return null;const l=t.capacity||0,u=!!t.thumbnailUrl,d=l>0&&e>=l,h=l>0?`${e}/${l}`:e.toString(),f="linear-gradient(135deg, var(--ocean-mid), var(--turquoise))",m={background:n?"rgba(6, 182, 212, 0.05)":"var(--gray-50)",border:n?"2px solid var(--turquoise)":"1px solid var(--gray-200)",borderRadius:"var(--radius-lg)",overflow:"hidden",cursor:r||a?"pointer":"default",transition:"all 0.2s",position:"relative"},_={height:"120px",background:u?`url(${t.thumbnailUrl}) center center / cover`:f,display:"flex",alignItems:"center",justifyContent:"center",color:u?"transparent":"rgba(255,255,255,0.3)",fontSize:"3rem",position:"relative"},E=()=>{a&&(typeof a=="function"?a():typeof a=="string"&&(window.location.href=a))},w=s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:_,children:[!u&&s.jsx("i",{className:"fas fa-sailboat"}),!n&&l>0&&s.jsx("span",{className:`status-pill ${d?"success":""}`,style:{fontSize:"0.7rem",position:"absolute",top:"var(--space-sm)",right:"var(--space-sm)"},children:h})]}),s.jsxs("div",{style:{padding:"var(--space-md)"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"var(--space-xs)",marginBottom:"var(--space-xs)"},children:[s.jsx("div",{className:"font-semibold",style:{flex:1,minWidth:0},children:t.name||"Bez nzvu"}),n&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.7rem",flexShrink:0,whiteSpace:"nowrap"},children:"Vae lo"}),r||a?s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)",fontSize:"0.75rem",flexShrink:0,marginTop:"2px"}}):null]}),s.jsxs("div",{className:"text-sm text-muted",style:{marginBottom:i?"var(--space-sm)":"var(--space-xs)"},children:[t.model||"Model neuveden"," ",t.capacity?` ${t.capacity} mst`:""]}),i&&s.jsxs("div",{className:"text-sm",style:{marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-users",style:{marginRight:"4px",color:"var(--gray-400)"}}),e," ",l?`/${l}`:""," osob"]})]})]});return a&&typeof a=="string"&&a.startsWith("/")?s.jsx(ie,{to:a,style:{textDecoration:"none",color:"inherit"},children:s.jsx("div",{style:m,children:w})}):s.jsx("div",{style:m,onClick:r||a?E:void 0,onMouseEnter:x=>{(r||a)&&(x.currentTarget.style.borderColor="var(--turquoise)",x.currentTarget.style.boxShadow="var(--shadow-md)")},onMouseLeave:x=>{(r||a)&&(x.currentTarget.style.borderColor=n?"var(--turquoise)":"var(--gray-200)",x.currentTarget.style.boxShadow="none")},children:w})}function o2({events:t=[],eventCompletions:e={},onEventToggle:n=null,viewType:r="participant",tripId:a=null,participantCount:i=0,trip:o=null}){const[l,u]=C.useState(!1),d=f=>f?f.toDate?f.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):f.seconds?new Date(f.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"";if(t.length===0)return s.jsx("p",{style:{color:"var(--gray-500)",textAlign:"center",padding:"var(--space-xl)"},children:"Zatm nejsou definovan dn udlosti v timeline."});const h=[...t].sort((f,m)=>{var w,x,v,j;const _=(w=f.date)!=null&&w.toDate?f.date.toDate():(x=f.date)!=null&&x.seconds?new Date(f.date.seconds*1e3):new Date(0),E=(v=m.date)!=null&&v.toDate?m.date.toDate():(j=m.date)!=null&&j.seconds?new Date(m.date.seconds*1e3):new Date(0);return!f.date&&!m.date?0:f.date?m.date?_.getTime()-E.getTime():-1:1});return s.jsxs("div",{className:"timeline-view",children:[h.map((f,m)=>{var j,S;const _=(j=f.date)!=null&&j.toDate?f.date.toDate():(S=f.date)!=null&&S.seconds?new Date(f.date.seconds*1e3):null,E=_&&_<new Date;let w=!1,x=0;r==="organizer"?x=(e[f.id]||[]).length:w=e[f.id]||!1;const v=m===t.length-1;return s.jsxs("div",{className:"timeline-item",children:[s.jsxs("div",{className:"timeline-line-container",children:[s.jsxs("div",{className:"timeline-dot-wrapper",children:[s.jsx("div",{className:`timeline-dot ${w||r==="organizer"&&x>0?"completed":E&&!w?"overdue":"pending"}`,style:{cursor:f.checkable?"pointer":"default"},onClick:()=>{f.checkable&&n&&n(f.id)},title:f.checkable?w?"Oznait jako nesplnn":"Oznait jako splnn":"",children:w||r==="organizer"&&x>0?s.jsx("i",{className:"fas fa-check"}):E&&!w?s.jsx("i",{className:"fas fa-exclamation"}):s.jsx("i",{className:"fas fa-circle"})}),_&&s.jsx("div",{className:`timeline-date ${E&&!w?"overdue":""}`,children:d(f.date)})]}),!v&&s.jsx("div",{className:"timeline-line"})]}),s.jsx("div",{className:`timeline-event ${w||r==="organizer"&&x===i&&i>0?"completed":""}`,children:s.jsxs("div",{className:"timeline-event-content",children:[s.jsxs("div",{className:"timeline-event-header-row",children:[s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("h5",{className:"timeline-event-title",children:f.name||"Bez nzvu"}),f.description&&s.jsx("p",{className:"timeline-event-description",children:f.description})]}),s.jsxs("div",{className:"timeline-event-header-right",children:[f.checkable&&r!=="organizer"&&s.jsxs("button",{className:`timeline-check-button ${w?"completed":""}`,onClick:R=>{R.stopPropagation(),n&&n(f.id)},title:w?"Oznait jako nesplnn":"Oznait jako splnn",children:[s.jsx("i",{className:`fas fa-${w?"check":"circle"}`}),s.jsx("span",{className:"timeline-check-button-label",children:w?"Splnno":"Splnit"})]}),r==="organizer"&&s.jsxs("div",{className:"event-status",children:[s.jsx("span",{className:`count ${x===i&&i>0?"completed":""}`,children:x}),s.jsx("span",{children:"/"}),s.jsx("span",{className:"count",children:i})]})]})]}),s.jsxs("div",{className:"timeline-event-meta",children:[s.jsxs("div",{className:"timeline-event-actions",children:[f.type==="crewlist"&&a&&s.jsxs(ie,{to:`/trip/${a}/${r==="organizer"?"organizer":r==="captain"?"captain":"participant"}#crew-list`,className:"btn btn-sm btn-secondary timeline-action-btn",onClick:R=>R.stopPropagation(),children:[s.jsx("i",{className:"fas fa-clipboard-list"})," Otevt crew list"]}),f.type==="payment"&&o&&s.jsxs("button",{className:"btn btn-sm btn-secondary timeline-action-btn",onClick:R=>{R.stopPropagation(),u(!0)},children:[s.jsx("i",{className:"fas fa-money-bill-wave"})," Informace o platbch"]})]}),f.roles&&f.roles.length>0&&s.jsx("div",{className:"timeline-event-roles",children:f.roles.map((R,L)=>s.jsxs("span",{className:`role-tag ${R}`,children:[s.jsx("i",{className:`fas fa-${R==="captain"?"ship":R==="organizer"?"crown":"users"}`}),R==="captain"?"Kapitni":R==="organizer"?"Organiztoi":"astnci"]},L))})]})]})})]},f.id)}),s.jsx(TN,{isOpen:l,onClose:()=>u(!1),paymentInfo:o==null?void 0:o.paymentInfo})]})}function Sm({events:t=[],eventCompletions:e={},onEventToggle:n=null,viewType:r="participant",tripId:a=null,participantCount:i=0,onEditEvents:o=null,showEditButton:l=!1,trip:u=null}){const h=(()=>{switch(r){case"organizer":return{title:"Timeline ped plavbou",description:"Pehled splnn udlost vemi astnky. Kliknte na udlost pro detail.",icon:"fa-flag-checkered",iconColor:"var(--coral)"};case"captain":return{title:"Co je poteba splnit ped plavbou",description:"Tyto udlosti je poteba splnit ped odjezdem na plavbu. Nkter maj stanoven termn.",icon:"fa-flag-checkered",iconColor:"var(--coral)"};case"participant":default:return{title:"Co je poteba splnit ped plavbou",description:"Tyto udlosti je poteba splnit ped odjezdem na plavbu. Nkter maj stanoven termn.",icon:"fa-flag-checkered",iconColor:"var(--coral)"}}})(),f=r!=="organizer"&&t.filter(m=>m.checkable).length>0&&t.filter(m=>m.checkable).every(m=>e[m.id]);return s.jsxs("div",{className:"card before-trip-tab",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:`fas ${h.icon}`,style:{color:h.iconColor}}),h.title]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)",alignItems:"center"},children:[f&&s.jsx("span",{className:"status-pill success",children:"Ve splnno"}),l&&o&&s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:o,children:[s.jsx("i",{className:"fas fa-edit"})," Upravit udlosti"]})]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:h.description}),s.jsx(o2,{events:t,eventCompletions:e,onEventToggle:n,viewType:r,tripId:a,participantCount:i,trip:u})]})}const Cm=({tabs:t=[],activeTab:e,onTabChange:n})=>{const r=C.useRef(null),a=C.useRef(null),[i,o]=C.useState(!1),[l,u]=C.useState(!0),d=()=>{if(r.current){const{scrollLeft:h,scrollWidth:f,clientWidth:m}=r.current;o(h>0),u(h<f-m-1)}};return C.useEffect(()=>{d();const h=r.current;if(h)return h.addEventListener("scroll",d),window.addEventListener("resize",d),()=>{h.removeEventListener("scroll",d),window.removeEventListener("resize",d)}},[t]),C.useEffect(()=>{if(a.current&&r.current){const h=r.current,f=a.current,m=h.getBoundingClientRect(),_=f.getBoundingClientRect(),E=f.offsetLeft-m.width/2+_.width/2;h.scrollTo({left:E,behavior:"smooth"}),setTimeout(d,300)}},[e]),s.jsxs("div",{className:"trip-tabs-bottom-drawer",children:[i&&s.jsx("div",{className:"trip-tabs-scroll-indicator trip-tabs-scroll-indicator-left",children:s.jsx("i",{className:"fas fa-chevron-left"})}),s.jsx("div",{ref:r,className:"trip-tabs-scroll-container",onScroll:d,children:t.map(h=>{const f=e===h.id;return s.jsxs("button",{ref:f?a:null,className:`trip-tabs-tab ${f?"active":""}`,onClick:()=>n(h.id),children:[h.icon&&s.jsx("span",{className:"trip-tabs-tab-icon",children:h.icon}),s.jsx("span",{className:"trip-tabs-tab-label",children:h.label})]},h.id)})}),l&&s.jsx("div",{className:"trip-tabs-scroll-indicator trip-tabs-scroll-indicator-right",children:s.jsx("i",{className:"fas fa-chevron-right"})})]})};function l2(){const{tripId:t}=ir();_t();const{user:e}=yt(),n=lr("(max-width: 768px)"),[r,a]=C.useState(null),[i,o]=C.useState([]),[l,u]=C.useState([]),[d,h]=C.useState([]),[f,m]=C.useState({}),[_,E]=C.useState([]),[w,x]=C.useState([]),[v,j]=C.useState([]),[S,R]=C.useState(new Map),[L,U]=C.useState(!0),[N,y]=C.useState("prehled"),[k,b]=C.useState(!1),[A,z]=C.useState(!1),[T,$]=C.useState(!1),[Q,B]=C.useState(null),[ee,W]=C.useState(null),D=[{id:"prehled",label:"Pehled",icon:s.jsx("i",{className:"fas fa-info-circle"})},{id:"pred-plavbou",label:"Ped plavbou",icon:s.jsx("i",{className:"fas fa-flag-checkered"})},{id:"lode",label:"Lod",icon:s.jsx("i",{className:"fas fa-ship"})},{id:"ucastnici",label:"astnci",icon:s.jsx("i",{className:"fas fa-users"})},{id:"crew-listy",label:"Crew listy",icon:s.jsx("i",{className:"fas fa-clipboard-list"})},{id:"checklisty",label:"Checklisty",icon:s.jsx("i",{className:"fas fa-tasks"})},{id:"dokumenty",label:"Dokumenty",icon:s.jsx("i",{className:"fas fa-file-alt"})}];C.useEffect(()=>{t&&e&&q()},[t,e]),C.useEffect(()=>{const V=window.location.hash;V==="#crew-listy"?y("crew-listy"):V==="#checklisty"?y("checklisty"):V==="#pred-plavbou"&&y("pred-plavbou")},[]),C.useEffect(()=>{const V=()=>{const J=window.location.hash;J==="#crew-listy"?y("crew-listy"):J==="#checklisty"?y("checklisty"):J==="#pred-plavbou"&&y("pred-plavbou")};return window.addEventListener("hashchange",V),()=>window.removeEventListener("hashchange",V)},[]);const q=async()=>{var _e;U(!0);const[V,J,Z,le]=await Promise.all([pt.getTrip(t),Je.getTripParticipants(t),Jt.getTripBoats(t),jp.getTripDocuments(t)]);V.data&&a(V.data);const de=J.participants||[];V.data&&e&&V.data.organizerId===e.uid&&de.find(Ee=>Ee.userId===e.uid),o(de);const qe=de.map(Ee=>Ee.userId);if(qe.length>0){const Ee=await pi(qe);R(Ee)}J.error&&console.error("Error loading participants:",J.error),Z.boats&&u(Z.boats),le.documents&&E(le.documents);const{instances:Oe}=await Fe.getTripInstances(t);if(Oe)if(de.find(En=>En.userId===(e==null?void 0:e.uid))&&((_e=V.data)==null?void 0:_e.organizerId)===(e==null?void 0:e.uid)){const En=Oe.filter(We=>!!(We.role==="organizer"&&!We.userId||We.boatId||We.userId&&We.userId!==e.uid));x(En)}else x(Oe);const{data:Re}=await Nn.getTripCrewlistData(t);Re&&j(Re);const{events:fe,error:ze}=await wt.getTripEvents(t);if(!ze&&fe){h(fe);const{completions:Ee,error:En}=await wt.getTripCompletions(t);if(!En&&Ee){const We={};Ee.forEach(ut=>{We[ut.eventId]||(We[ut.eventId]=[]),ut.completed&&We[ut.eventId].push(ut.userId)}),m(We)}}U(!1)},G=V=>V?V.toDate?V.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):V.seconds?new Date(V.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",I=(V,J)=>{if(!V||!J)return"Neuvedeno";const Z=G(V),le=G(J);return`${Z}  ${le}`},O=V=>{if(!V)return null;const le=(V.toDate?V.toDate():new Date(V.seconds*1e3))-new Date,de=Math.ceil(le/(1e3*60*60*24));return de>0?de:null},F=V=>({participant:"astnk",captain:"Kapitn",organizer:"Organiztor"})[V]||V,H=async V=>{const J=i.find(de=>de.id===V),le=J&&J.userId===e.uid?"Opravdu chcete odstranit sebe ze seznamu astnk? (Zstane organiztorem plavby.)":"Opravdu chcete odstranit tohoto astnka?";if(confirm(le)){const{error:de}=await Je.removeParticipant(V);de?alert("Chyba pi odstraovn astnka: "+de):o(qe=>qe.filter(Oe=>Oe.id!==V))}},X=async(V,J)=>{const{error:Z}=await Je.updateParticipantRole(V,J);Z?alert("Chyba pi aktualizaci role: "+Z):o(le=>le.map(de=>de.id===V?{...de,role:J}:de))},te=async(V,J)=>{const{error:Z}=await Je.assignToBoat(V,J||null);Z?alert("Chyba pi aktualizaci lod: "+Z):o(le=>le.map(de=>de.id===V?{...de,boatId:J||null}:de))};if(L)return s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})});if(!r)return s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Plavba nenalezena"}),s.jsx(ie,{to:"/organizing",className:"btn btn-primary",children:"Zpt na plavby"})]})});if(!r||!e)return s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})});if(!jN(r,e.uid))return s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Nem oprvnn k tto plavb"}),s.jsx(ie,{to:"/organizing",className:"btn btn-primary",children:"Zpt na plavby"})]})});const ae=i.length,pe=l.length,oe=O(r.startDate),Te=(()=>{const V=["id","tripId","boatId","userId","createdAt","updatedAt"];let J=0;const Z=i.length;return i.forEach(le=>{if(!le.boatId)return;const de=v.find(qe=>qe.boatId===le.boatId&&qe.userId===le.userId);de&&Object.keys(de).some(Oe=>{if(V.includes(Oe))return!1;const Re=de[Oe];return Re!=null&&Re!==""})&&J++}),{complete:J,total:Z,percentage:Z>0?J/Z*100:0}})();return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"trip-header organizer",style:r.bannerImageUrl?{backgroundImage:`url(${r.bannerImageUrl})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"}:{},children:[r.bannerImageUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.8), rgba(10, 22, 40, 0.6))"}}),s.jsx("div",{className:"container",style:{position:"relative",zIndex:1},children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:"/organizing",children:"Organizuji"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:r.name||"Bez nzvu"})]}),s.jsxs("div",{className:"trip-title-row",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",children:r.name||"Bez nzvu"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-xs)",flexWrap:"wrap",alignItems:"center"},children:(()=>{const V=i.find(de=>de.userId===e.uid),J=Tm(r,V,e.uid),Z="organizer";return[...J].sort((de,qe)=>de===Z?-1:qe===Z?1:0).map(de=>{const qe=de===Z,Oe=de==="organizer"?"fa-crown":de==="captain"?"fa-ship":"fa-user";if(qe)return s.jsxs("span",{className:`role-badge ${de}`,children:[s.jsx("i",{className:`fas ${Oe}`}),F(de)]},de);{const Re=de==="captain"?`/trip/${t}/captain`:`/trip/${t}/participant`;return s.jsxs(ie,{to:Re,className:`role-badge ${de}`,style:{cursor:"pointer",textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"var(--space-xs)"},title:`Zobrazit jako ${F(de).toLowerCase()}`,onMouseEnter:fe=>{de==="organizer"?(fe.currentTarget.style.transform="scale(1.05)",fe.currentTarget.style.boxShadow="0 4px 12px rgba(249, 115, 22, 0.3)",fe.currentTarget.style.background="rgba(249, 115, 22, 0.4)"):(fe.currentTarget.style.transform="scale(1.05)",fe.currentTarget.style.boxShadow="0 4px 12px rgba(6, 182, 212, 0.3)")},onMouseLeave:fe=>{fe.currentTarget.style.transform="scale(1)",fe.currentTarget.style.boxShadow="none",de==="organizer"&&(fe.currentTarget.style.background="rgba(249, 115, 22, 0.3)")},children:[s.jsx("i",{className:`fas ${Oe}`}),F(de),s.jsx("i",{className:"fas fa-external-link-alt",style:{marginLeft:"4px",fontSize:"0.7rem"}})]},de)}})})()})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>b(!0),children:[s.jsx("i",{className:"fas fa-share-alt"}),"Sdlet"]}),s.jsxs(ie,{to:`/trip/${t}/edit`,className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-edit"}),"Upravit plavbu"]})]})]}),s.jsxs("div",{className:"trip-header-meta",children:[s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-calendar"}),s.jsx("span",{children:I(r.startDate,r.endDate)})]}),(r.locationName||r.startLocation)&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-map-marker-alt"}),s.jsx("span",{children:r.locationName||r.startLocation})]}),oe!==null&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-clock"}),s.jsx("span",{children:oe===0?"Zan dnes":oe===1?"Zan ztra":`${oe} dn do startu`})]}),s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-ship"}),s.jsxs("span",{children:[pe," ",pe===1?"lo":pe<5?"lod":"lod"]})]}),s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-users"}),s.jsxs("span",{children:[ae," ",ae===1?"astnk":ae<5?"astnci":"astnk"]})]})]})]})})]}),n?s.jsx(Cm,{tabs:D,activeTab:N,onTabChange:y}):s.jsx("div",{className:"trip-tabs",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-tabs-inner",children:[s.jsxs("button",{className:`trip-tab ${N==="prehled"?"active":""}`,onClick:()=>y("prehled"),children:[s.jsx("i",{className:"fas fa-info-circle"}),"Pehled"]}),s.jsxs("button",{className:`trip-tab ${N==="pred-plavbou"?"active":""}`,onClick:()=>y("pred-plavbou"),children:[s.jsx("i",{className:"fas fa-flag-checkered"}),"Ped plavbou"]}),s.jsxs("button",{className:`trip-tab ${N==="lode"?"active":""}`,onClick:()=>y("lode"),children:[s.jsx("i",{className:"fas fa-ship"}),"Lod"]}),s.jsxs("button",{className:`trip-tab ${N==="ucastnici"?"active":""}`,onClick:()=>y("ucastnici"),children:[s.jsx("i",{className:"fas fa-users"}),"astnci"]}),s.jsxs("button",{className:`trip-tab ${N==="crew-listy"?"active":""}`,onClick:()=>y("crew-listy"),children:[s.jsx("i",{className:"fas fa-clipboard-list"}),"Crew listy"]}),s.jsxs("button",{className:`trip-tab ${N==="checklisty"?"active":""}`,onClick:()=>y("checklisty"),children:[s.jsx("i",{className:"fas fa-tasks"}),"Checklisty"]}),s.jsxs("button",{className:`trip-tab ${N==="dokumenty"?"active":""}`,onClick:()=>y("dokumenty"),children:[s.jsx("i",{className:"fas fa-file-alt"}),"Dokumenty"]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",children:[N==="prehled"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"admin-panel animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"admin-panel-header",children:[s.jsx("i",{className:"fas fa-crown"}),"Sprva plavby"]}),s.jsx("p",{className:"text-sm text-muted",style:{marginBottom:"var(--space-md)"},children:"Jako organiztor mte pln pstup ke vem funkcm sprvy plavby."}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:[s.jsxs(ie,{to:`/trip/${t}/edit`,className:"btn btn-sm btn-primary",children:[s.jsx("i",{className:"fas fa-edit"})," Upravit plavbu"]}),s.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>b(!0),children:[s.jsx("i",{className:"fas fa-user-plus"})," Pozvat astnky"]})]})]}),s.jsxs("div",{className:"trip-layout",children:[s.jsxs("div",{className:"main-content",children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"var(--space-md)",marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"card animate-in",style:{textAlign:"center",padding:"var(--space-xl)"},children:[s.jsx("div",{style:{fontSize:"2rem",fontWeight:700,color:"var(--coral)"},children:ae}),s.jsx("div",{className:"text-sm text-muted",children:"astnk"})]}),s.jsxs("div",{className:"card animate-in delay-1",style:{textAlign:"center",padding:"var(--space-xl)"},children:[s.jsx("div",{style:{fontSize:"2rem",fontWeight:700,color:"var(--turquoise)"},children:pe}),s.jsx("div",{className:"text-sm text-muted",children:"Lod"})]}),s.jsxs("div",{className:"card animate-in delay-2",style:{textAlign:"center",padding:"var(--space-xl)"},children:[s.jsxs("div",{style:{fontSize:"2rem",fontWeight:700,color:Te.percentage===100?"var(--success)":"var(--warning)"},children:[Te.complete,"/",Te.total]}),s.jsx("div",{className:"text-sm text-muted",children:"Crew listy"})]}),s.jsxs("div",{className:"card animate-in delay-3",style:{textAlign:"center",padding:"var(--space-xl)"},children:[s.jsx("div",{style:{fontSize:"2rem",fontWeight:700,color:"var(--ocean-light)"},children:oe||"-"}),s.jsx("div",{className:"text-sm text-muted",children:"Dn do startu"})]})]}),s.jsx(Ku,{trip:r,tripId:t,showEditButton:!0}),s.jsx(Gu,{trip:r}),s.jsxs("div",{className:"card animate-in delay-2",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)"}}),"Lod"]}),s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>y("lode"),children:[s.jsx("i",{className:"fas fa-cog"})," Spravovat"]})]}),l.length>0?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"var(--space-lg)"},children:l.map(V=>{const J=i.filter(Z=>Z.boatId===V.id);return s.jsx(Im,{boat:V,participantCount:J.length,clickable:!0,onClick:()=>y("lode"),showDetails:!0,viewType:"organizer"},V.id)})}):s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-xl)"},children:[s.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"var(--space-lg)"},children:"Zatm nejsou dn lod. Pidej prvn lo."}),s.jsxs(ie,{to:`/trip/${t}/boat/new`,className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat lo"]})]})]})]}),s.jsxs("aside",{children:[s.jsxs("div",{className:"sidebar-card animate-in",style:{marginBottom:"var(--space-lg)"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-chart-bar",style:{color:"var(--turquoise)"}}),"Stav pprav"]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--space-xs)"},children:[s.jsx("span",{className:"text-sm text-muted",children:"Obsazenost lod"}),s.jsx("span",{className:"text-sm font-medium",children:(()=>{const V=i.filter(Z=>Z.boatId).length,J=l.reduce((Z,le)=>Z+(le.capacity||0),0);return`${V}${J>0?`/${J}`:""}`})()})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${(()=>{const V=i.filter(Z=>Z.boatId).length,J=l.reduce((Z,le)=>Z+(le.capacity||0),0);return J>0?V/J*100:0})()}%`}})})]}),s.jsxs("div",{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--space-xs)"},children:[s.jsx("span",{className:"text-sm text-muted",children:"Crew listy kompletn"}),s.jsxs("span",{className:"text-sm font-medium",children:[Te.complete,"/",Te.total]})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${Te.percentage}%`,background:"var(--success)"}})})]})]})]}),r.usefulLinks&&r.usefulLinks.length>0&&s.jsx(Em,{usefulLinks:r.usefulLinks})]})]})]}),N==="ucastnici"&&s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-users",style:{color:"var(--turquoise)"}}),"astnci"]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>b(!0),children:[s.jsx("i",{className:"fas fa-user-plus"}),"Pidat astnka"]})]}),i.length>0?s.jsx("div",{className:"participants-table",children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{borderBottom:"1px solid var(--gray-200)"},children:[s.jsx("th",{style:{textAlign:"left",padding:"var(--space-md)",color:"var(--gray-600)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:"Jmno"}),s.jsx("th",{style:{textAlign:"left",padding:"var(--space-md)",color:"var(--gray-600)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:"Role"}),s.jsx("th",{style:{textAlign:"left",padding:"var(--space-md)",color:"var(--gray-600)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:"Lo"}),s.jsx("th",{style:{textAlign:"left",padding:"var(--space-md)",color:"var(--gray-600)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:"Status"}),s.jsx("th",{style:{textAlign:"right",padding:"var(--space-md)",color:"var(--gray-600)",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"},children:"Akce"})]})}),s.jsx("tbody",{children:i.map(V=>(l.find(J=>J.id===V.boatId),s.jsxs("tr",{style:{borderBottom:"1px solid var(--gray-100)"},children:[s.jsx("td",{style:{padding:"var(--space-md)"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)"},children:[(()=>{const J=S.get(V.userId),Z=(J==null?void 0:J.name)||"Neznm uivatel";return V.userId===e.uid?s.jsxs("strong",{children:[Z," (organiztor)"]}):Z})(),V.userId===e.uid&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.7rem",padding:"2px 6px"},children:"J"})]})}),s.jsx("td",{style:{padding:"var(--space-md)"},children:s.jsxs("select",{className:"form-input badge",style:{width:"auto",minWidth:"120px",padding:"var(--space-xs) var(--space-md) var(--space-xs) var(--space-sm)",paddingRight:"var(--space-xl)",border:"1px solid var(--gray-200)",cursor:"pointer",fontSize:"0.875rem",fontWeight:"normal",borderRadius:"var(--radius-sm)",transition:"all 0.2s"},value:V.role,onChange:J=>X(V.id,J.target.value),children:[s.jsx("option",{value:"participant",children:"Posdka"}),s.jsx("option",{value:"captain",children:"Kapitn"})]})}),s.jsx("td",{style:{padding:"var(--space-md)"},children:s.jsxs("select",{className:"form-input badge editable-cell",style:{width:"auto",minWidth:"140px",padding:"var(--space-xs) var(--space-md) var(--space-xs) var(--space-sm)",paddingRight:"var(--space-xl)",border:V.boatId?"1px solid var(--gray-200)":"1px solid var(--warning)",backgroundColor:V.boatId?"var(--white)":"rgba(245, 158, 11, 0.1)",cursor:"pointer",fontSize:"0.875rem",fontWeight:V.boatId?"normal":"500",color:V.boatId?"var(--gray-700)":"var(--warning)",borderRadius:"var(--radius-sm)",transition:"all 0.2s"},value:V.boatId||"",onChange:J=>te(V.id,J.target.value),children:[s.jsx("option",{value:"",style:{color:"var(--warning)",fontWeight:"500"},children:"Lo nepiazena"}),l.map(J=>s.jsx("option",{value:J.id,children:J.name||"Bez nzvu"},J.id))]})}),s.jsx("td",{style:{padding:"var(--space-md)"},children:s.jsx("span",{className:"status-pill success",children:V.status||"confirmed"})}),s.jsx("td",{style:{padding:"var(--space-md)",textAlign:"right"},children:s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)",justifyContent:"flex-end"},children:[s.jsx(ie,{to:`/trip/${t}/participant/${V.id}`,className:"btn btn-sm btn-ghost",children:s.jsx("i",{className:"fas fa-eye"})}),s.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>H(V.id),title:V.userId===e.uid?"Me se smazat ze seznamu astnk":"Smazat astnka",children:s.jsx("i",{className:"fas fa-trash"})})]})})]},V.id)))})]})}):s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"var(--space-lg)"},children:"Zatm nejsou dn astnci. Pidej prvn astnka."}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>b(!0),children:[s.jsx("i",{className:"fas fa-user-plus"}),"Pidat astnka"]})]})]}),N==="lode"&&s.jsxs("div",{className:"card animate-in",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)"}}),"Lod a posdky"]}),s.jsxs(ie,{to:`/trip/${t}/boat/new`,className:"btn btn-sm btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat lo"]})]}),l.length>0?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"var(--space-lg)"},children:l.map(V=>{const J=i.filter(fe=>fe.boatId===V.id),Z=J.find(fe=>fe.role==="captain"),le=v.filter(fe=>fe.boatId===V.id),de=["id","tripId","boatId","userId","createdAt","updatedAt"],Oe=J.filter(fe=>{const ze=le.find(_e=>_e.userId===fe.userId);return ze?Object.keys(ze).some(_e=>{if(de.includes(_e))return!1;const Ee=ze[_e];return Ee!=null&&Ee!==""}):!1}).length,Re=Oe===J.length&&J.length>0;return s.jsxs("div",{style:{background:"var(--white)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-lg)",overflow:"hidden",transition:"all 0.2s",position:"relative"},onMouseEnter:fe=>{fe.currentTarget.style.borderColor="var(--turquoise)",fe.currentTarget.style.boxShadow="var(--shadow-md)"},onMouseLeave:fe=>{fe.currentTarget.style.borderColor="var(--gray-200)",fe.currentTarget.style.boxShadow="none"},children:[s.jsxs(ie,{to:`/trip/${t}/boat/${V.id}`,style:{textDecoration:"none",color:"inherit",display:"block"},children:[V.thumbnailUrl&&s.jsx("div",{style:{height:"150px",backgroundImage:`url(${V.thumbnailUrl})`,backgroundSize:"cover",backgroundPosition:"center"}}),s.jsx("div",{style:{padding:"var(--space-lg)",borderBottom:"1px solid var(--gray-100)"},children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[s.jsxs("div",{children:[s.jsx("h4",{style:{margin:0,marginBottom:"var(--space-xs)",fontSize:"1.125rem"},children:V.model||"Model neuveden"}),s.jsx("p",{style:{margin:0,color:"var(--gray-500)",fontSize:"0.875rem"},children:V.name||"Bez nzvu"})]}),s.jsxs("span",{className:`status-pill ${J.length===V.capacity&&V.capacity?"success":""}`,style:{fontSize:"0.75rem"},children:[J.length,V.capacity?`/${V.capacity}`:""]})]})}),s.jsxs("div",{style:{padding:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:"Kapitn"}),s.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:(()=>{if(!Z)return"Nepiazen";const fe=S.get(Z.userId);return(fe==null?void 0:fe.name)||"Neznm uivatel"})()})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:"Crew list"}),s.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:Re?"var(--success)":"var(--warning)"},children:Re?"Kompletn":`${Oe}/${J.length}`})]}),V.charterLink&&s.jsx("div",{style:{marginTop:"var(--space-xs)",paddingTop:"var(--space-xs)",borderTop:"1px solid var(--gray-100)"},children:s.jsxs("a",{href:V.charterLink,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-ghost",style:{fontSize:"0.875rem"},onClick:fe=>fe.stopPropagation(),children:[s.jsx("i",{className:"fas fa-external-link-alt"}),"Detail lodi"]})})]}),J.length>0&&s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)",marginTop:"var(--space-md)",flexWrap:"wrap"},children:[J.slice(0,6).map(fe=>s.jsx("div",{className:`crew-avatar ${fe.role==="captain"?"captain":""}`,style:{width:"28px",height:"28px",fontSize:"0.7rem",marginLeft:0},title:(()=>{const ze=S.get(fe.userId);return(ze==null?void 0:ze.name)||"Neznm uivatel"})(),children:(()=>{const ze=S.get(fe.userId);if(ze!=null&&ze.name){const _e=ze.name.trim().split(/\s+/);return _e.length>=2?(_e[0][0]+_e[_e.length-1][0]).toUpperCase():ze.name.substring(0,2).toUpperCase()}return fe.userId.substring(0,2).toUpperCase()})()},fe.id)),J.length>6&&s.jsxs("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"var(--gray-200)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.7rem",color:"var(--gray-600)",fontWeight:600},children:["+",J.length-6]})]})]})]}),s.jsxs("div",{style:{padding:"var(--space-md)",borderTop:"1px solid var(--gray-100)",background:"var(--gray-50)",display:"flex",gap:"var(--space-sm)",justifyContent:"flex-end"},children:[s.jsxs(ie,{to:`/trip/${t}/boat/${V.id}/edit`,className:"btn btn-sm btn-ghost",onClick:fe=>fe.stopPropagation(),children:[s.jsx("i",{className:"fas fa-edit"}),"Upravit"]}),s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:async fe=>{fe.stopPropagation();const ze=i.filter(Ee=>Ee.boatId===V.id);if(ze.length>0){if(!confirm(`Na tto lodi jsou piazeni astnci (${ze.length}). Opravdu chcete lo smazat? astnci budou odpojeni od lod.`))return}else if(!confirm(`Opravdu chcete smazat lo "${V.name||V.model||"Bez nzvu"}"?`))return;const{error:_e}=await Jt.deleteBoat(V.id);_e?alert("Chyba pi mazn lod: "+_e):await q()},style:{color:"var(--danger)"},children:[s.jsx("i",{className:"fas fa-trash"}),"Smazat"]})]})]},V.id)})}):s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"var(--space-lg)"},children:"Zatm nejsou dn lod. Pidej prvn lo."}),s.jsxs(ie,{to:`/trip/${t}/boat/new`,className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Pidat lo"]})]})]}),N==="pred-plavbou"&&s.jsx(Sm,{events:d,eventCompletions:f,viewType:"organizer",tripId:t,participantCount:i.length,trip:r,onEditEvents:()=>{B(null),$(!0)},showEditButton:!0}),N==="crew-listy"&&s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Crew listy lod"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Pehled vyplnn crew list vemi lodmi."}),l.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:l.map(V=>{const J=v.filter(fe=>fe.boatId===V.id),Z=i.filter(fe=>fe.boatId===V.id),le=["id","tripId","boatId","userId","createdAt","updatedAt"],qe=Z.filter(fe=>{const ze=J.find(_e=>_e.userId===fe.userId);return ze?Object.keys(ze).some(_e=>{if(le.includes(_e))return!1;const Ee=ze[_e];return Ee!=null&&Ee!==""}):!1}).length,Oe=Z.length,Re=qe===Oe&&Oe>0;return s.jsxs(ie,{to:`/trip/${t}/boat/${V.id}#crew-list`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",textDecoration:"none",color:"inherit",transition:"all 0.2s"},onMouseEnter:fe=>fe.currentTarget.style.background="var(--gray-100)",onMouseLeave:fe=>fe.currentTarget.style.background="var(--gray-50)",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"linear-gradient(135deg, var(--ocean-mid), var(--turquoise))",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-ship"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium",children:[V.model||"Model neuveden","  ",V.name||"Bez nzvu"]}),s.jsxs("div",{className:"text-sm text-muted",children:["Kapitn: ",(()=>{const fe=Z.find(_e=>_e.role==="captain");if(!fe)return"Nepiazen";const ze=S.get(fe.userId);return(ze==null?void 0:ze.name)||"Neznm uivatel"})()]})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsxs("span",{className:`status-pill ${Re?"success":"warning"}`,style:{fontSize:"0.75rem"},children:[qe,"/",Oe," ",Re?"kompletn":""]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},V.id)})}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou dn lod. Pidej prvn lo."})]}),N==="checklisty"&&!ee&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-tasks",style:{color:"var(--turquoise)"}}),"Systmov checklisty"]}),s.jsxs(ie,{to:"/settings/organizer",className:"btn btn-sm btn-ghost",children:[s.jsx("i",{className:"fas fa-cog"})," Spravovat checklisty"]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Pehled vyplnn checklist vemi lodmi. Kliknutm otevete a upravte checklist."}),w.length>0?(()=>{const V=[],J=[];return w.forEach(Z=>{Z.role==="organizer"&&!Z.userId&&!Z.boatId?V.push(Z):J.push(Z)}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xl)"},children:[V.length>0&&s.jsxs("div",{children:[s.jsxs("h5",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-md)",paddingBottom:"var(--space-sm)",borderBottom:"2px solid rgba(249, 115, 22, 0.3)"},children:[s.jsx("i",{className:"fas fa-user",style:{color:"var(--coral)",marginRight:"var(--space-xs)"}}),"Vae checklisty"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:V.map(Z=>{var qe,Oe;const le=((qe=Z.items)==null?void 0:qe.filter(Re=>Re.completed).length)||0,de=((Oe=Z.items)==null?void 0:Oe.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"rgba(249, 115, 22, 0.05)",borderRadius:"var(--radius-md)",border:"1px solid rgba(249, 115, 22, 0.2)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:Re=>Re.currentTarget.style.background="rgba(249, 115, 22, 0.1)",onMouseLeave:Re=>Re.currentTarget.style.background="rgba(249, 115, 22, 0.05)",onClick:()=>W(Z.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(249, 115, 22, 0.15)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--coral)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:Z.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:Z.description||"V osobn checklist"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-lg)"},children:[s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{className:"text-sm text-muted",children:"Vyplnno"}),s.jsxs("div",{className:"font-medium",children:[le,"/",de," poloek"]})]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},Z.id)})})]}),J.length>0&&s.jsxs("div",{children:[s.jsxs("h5",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-md)",paddingBottom:"var(--space-sm)",borderBottom:"2px solid var(--gray-200)"},children:[s.jsx("i",{className:"fas fa-eye",style:{color:"var(--gray-500)",marginRight:"var(--space-xs)"}}),"Checklisty k zobrazen a prav"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:J.map(Z=>{var fe,ze;const le=l.find(_e=>_e.id===Z.boatId),de=((fe=Z.items)==null?void 0:fe.filter(_e=>_e.completed).length)||0,qe=((ze=Z.items)==null?void 0:ze.length)||0,Oe=Z.userId!==null&&Z.userId!==(e==null?void 0:e.uid);let Re=null;if(Oe&&i.find(Ee=>Ee.userId===Z.userId)){const Ee=S.get(Z.userId);Re=(Ee==null?void 0:Ee.name)||"Neznm uivatel"}return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:_e=>_e.currentTarget.style.background="var(--gray-100)",onMouseLeave:_e=>_e.currentTarget.style.background="var(--gray-50)",onClick:()=>W(Z.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(249, 115, 22, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--coral)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:Z.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:le?`Lo: ${le.name||"Bez nzvu"}`:Oe&&Re?`astnk: ${Re}`:Z.role?`Role: ${Z.role==="organizer"?"Organiztor":Z.role==="captain"?"Kapitn":"astnk"}`:Z.description||"Systmov checklist"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-lg)"},children:[s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{className:"text-sm text-muted",children:"Vyplnno"}),s.jsxs("div",{className:"font-medium",children:[de,"/",qe," poloek"]})]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},Z.id)})})]})]})})():s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou piazeny dn checklisty. Vytvote checklisty v Nastaven organiztora."})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"O checklistech"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Systmov checklisty se definuj v Nastaven organiztora a piazuj se k jednotlivm lodm nebo rolm. Kliknutm na checklist ho otevete a mete ho upravovat."})]})})]}),N==="checklisty"&&ee&&(()=>{var fe,ze;const V=w.find(_e=>_e.id===ee);if(!V)return W(null),null;const J=l.find(_e=>_e.id===V.boatId),Z=((fe=V.items)==null?void 0:fe.filter(_e=>_e.completed).length)||0,le=((ze=V.items)==null?void 0:ze.length)||0,de=_e=>{x(Ee=>Ee.map(En=>En.id===_e.id?_e:En))},qe=V.role==="organizer"&&!V.userId&&!V.boatId;V.boatId;const Oe=V.userId!==null&&V.userId!==(e==null?void 0:e.uid);let Re=null;if(Oe&&i.find(Ee=>Ee.userId===V.userId)){const Ee=S.get(V.userId);Re=(Ee==null?void 0:Ee.name)||"Neznm uivatel"}return s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>W(null),style:{marginRight:"var(--space-sm)"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-check",style:{color:"var(--turquoise)"}}),V.name||"Checklist"]})]}),s.jsxs("span",{className:`status-pill ${Z===le&&le>0?"success":"warning"}`,children:[Z,"/",le]})]}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[J&&s.jsxs("div",{style:{marginBottom:"var(--space-lg)",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Lo:"}),s.jsx("div",{className:"font-medium",children:J.name||"Bez nzvu"})]}),Oe&&Re&&s.jsxs("div",{style:{marginBottom:"var(--space-lg)",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"astnk:"}),s.jsx("div",{className:"font-medium",children:Re})]}),s.jsx(Hu,{instance:V,onUpdate:de,canEdit:!0,canView:!0,isOwnChecklist:qe,defaultMode:qe?"edit":"view"})]})]})})})(),N==="dokumenty"&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-file-alt",style:{color:"var(--turquoise)"}}),"Dokumenty plavby"]}),s.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>z(!0),children:[s.jsx("i",{className:"fas fa-plus"})," Pidat dokument"]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:"Dokumenty sdlen se vemi astnky plavby."}),_.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:_.map(V=>{var Oe,Re;const J=(Oe=V.createdAt)!=null&&Oe.toDate?V.createdAt.toDate():(Re=V.createdAt)!=null&&Re.seconds?new Date(V.createdAt.seconds*1e3):null,Z=V.fileType||"",le=Z.includes("pdf"),de=Z.includes("image"),qe=V.fileSize?(V.fileSize/(1024*1024)).toFixed(1):"0";return s.jsxs("div",{className:"doc-item",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsxs("div",{className:"doc-item-info",style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{className:`doc-icon ${le?"pdf":de?"image":"link"}`,style:{width:40,height:40,borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",background:le?"var(--danger-light)":de?"var(--turquoise-light)":"var(--gray-200)",color:le?"var(--danger)":de?"var(--turquoise)":"var(--gray-600)"},children:le?s.jsx("i",{className:"fas fa-file-pdf"}):de?s.jsx("i",{className:"fas fa-image"}):s.jsx("i",{className:"fas fa-link"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:V.name||V.fileName||"Bez nzvu"}),s.jsxs("div",{className:"text-sm text-muted",children:[qe," MB  ",J?J.toLocaleDateString("cs-CZ"):"Datum neuvedeno"]})]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)"},children:[s.jsx("a",{href:V.downloadURL,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-ghost",children:s.jsx("i",{className:"fas fa-download"})}),s.jsx("button",{className:"btn btn-sm btn-ghost",onClick:async()=>{if(confirm("Opravdu chcete smazat tento dokument?")){const{error:fe}=await jp.deleteDocument(V.id);fe||await q()}},children:s.jsx("i",{className:"fas fa-trash"})})]})]},V.id)})}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:s.jsx("p",{children:"Zatm nejsou nahrny dn dokumenty."})})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"O dokumentech"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Nahran dokumenty jsou dostupn vem astnkm plavby. Mete nahrvat PDF, obrzky nebo pidat odkazy na extern zdroje."})]})})]})]})}),k&&s.jsx(i2,{tripId:t,onClose:()=>b(!1),onSuccess:async()=>{const V=await Je.getTripParticipants(t);V.participants&&o(V.participants)}}),A&&s.jsx(u2,{tripId:t,userId:e.uid,onClose:()=>z(!1),onSuccess:q}),T&&s.jsx(c2,{tripId:t,event:Q,events:d,onClose:()=>{$(!1),B(null)},onSuccess:q})]})}function c2({tripId:t,event:e,events:n,onClose:r,onSuccess:a}){const i=lr("(max-width: 768px)"),[o,l]=C.useState({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",type:(e==null?void 0:e.type)||"custom",date:e!=null&&e.date&&e.date.toDate?e.date.toDate().toISOString().slice(0,16):"",roles:(e==null?void 0:e.roles)||[],checkable:(e==null?void 0:e.checkable)!==!1}),[u,d]=C.useState(!1),[h,f]=C.useState(""),m=async x=>{x.preventDefault(),d(!0),f("");const v={...o,date:o.date||null,order:e?e.order:n.length||0};let j;e?j=await wt.updateEvent(e.id,v):j=await wt.createEvent(t,v),j.error?(f(j.error),d(!1)):(a(),r())},_=async()=>{if(!e||!confirm("Opravdu chcete smazat tuto udlost?"))return;const{error:x}=await wt.deleteEvent(e.id);x?f(x):(a(),r())},E=x=>{l(v=>({...v,roles:v.roles.includes(x)?v.roles.filter(j=>j!==x):[...v.roles,x]}))},w=s.jsxs("form",{onSubmit:m,children:[h&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:h}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Nzev *"}),s.jsx("input",{type:"text",className:"form-input",value:o.name,onChange:x=>l(v=>({...v,name:x.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Popis"}),s.jsx("textarea",{className:"form-input",rows:3,value:o.description,onChange:x=>l(v=>({...v,description:x.target.value}))})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Typ"}),s.jsxs("select",{className:"form-input",value:o.type,onChange:x=>l(v=>({...v,type:x.target.value})),children:[s.jsx("option",{value:"custom",children:"Vlastn"}),s.jsx("option",{value:"crewlist",children:"Crewlist"}),s.jsx("option",{value:"payment",children:"Platba"})]})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Datum a as (voliteln)"}),s.jsx("input",{type:"datetime-local",className:"form-input",value:o.date,onChange:x=>l(v=>({...v,date:x.target.value}))})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Pro role"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:["organizer","captain","participant"].map(x=>s.jsx("button",{type:"button",className:`btn btn-sm ${o.roles.includes(x)?"btn-primary":"btn-ghost"}`,onClick:()=>E(x),children:x==="organizer"?"Organiztoi":x==="captain"?"Kapitni":"astnci"},x))}),s.jsx("p",{className:"text-xs text-muted",style:{marginTop:"var(--space-xs)"},children:"Pokud nen vybrna dn role, udlost se zobraz vem."})]}),s.jsx("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"checkbox",checked:o.checkable,onChange:x=>l(v=>({...v,checkable:x.target.checked}))}),s.jsx("span",{children:"astnci mohou oznait jako splnno"})]})}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-lg)",flexDirection:i?"column":"row",justifyContent:i?"stretch":"space-between",alignItems:i?"stretch":"center"},children:[s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flex:i?"1":"0 0 auto"},children:e&&s.jsxs("button",{type:"button",className:"btn btn-ghost",onClick:_,style:{color:"var(--danger)",flex:i?"1":"0 0 auto"},children:[s.jsx("i",{className:"fas fa-trash"})," Smazat"]})}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",flex:i?"1":"0 0 auto",flexDirection:i?"column":"row"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,style:{flex:i?"1":"0 0 auto"},children:"Zruit"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,style:{flex:i?"1":"0 0 auto"},children:u?"Ukldn...":e?"Uloit zmny":"Vytvoit udlost"})]})]})]});return i?s.jsx(ni,{isOpen:!0,onClose:r,title:e?"Upravit udlost":"Nov udlost",maxHeight:80,children:w}):s.jsx("div",{className:"modal-overlay",onClick:r,style:{position:"fixed",inset:0,background:"rgba(10, 22, 40, 0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:s.jsxs("div",{className:"modal",onClick:x=>x.stopPropagation(),style:{background:"var(--white)",borderRadius:"var(--radius-xl)",boxShadow:"var(--shadow-xl)",maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("div",{className:"modal-header",style:{padding:"var(--space-xl)",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("h4",{children:e?"Upravit udlost":"Nov udlost"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:r,children:s.jsx("i",{className:"fas fa-times"})})]}),w]})})}function u2({tripId:t,userId:e,onClose:n,onSuccess:r}){const a=lr("(max-width: 768px)"),[i,o]=C.useState(null),[l,u]=C.useState({name:"",description:"",category:"other"}),[d,h]=C.useState(!1),[f,m]=C.useState(null),_=x=>{const v=x.target.files[0];v&&(o(v),l.name||u(j=>({...j,name:v.name})))},E=async x=>{if(x.preventDefault(),!i){m("Vyberte soubor k nahrn");return}h(!0),m(null);const{id:v,error:j}=await jp.uploadDocument(t,i,{...l,uploadedBy:e});j?(m(j),h(!1)):(r(),n())},w=s.jsxs("form",{onSubmit:E,children:[f&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:f}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Soubor *"}),s.jsx("input",{type:"file",className:"form-input",onChange:_,required:!0}),i&&s.jsxs("div",{className:"text-sm text-muted",style:{marginTop:"var(--space-xs)"},children:[i.name," (",(i.size/(1024*1024)).toFixed(1)," MB)"]})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Nzev *"}),s.jsx("input",{type:"text",className:"form-input",value:l.name,onChange:x=>u(v=>({...v,name:x.target.value})),placeholder:"Nzev dokumentu",required:!0})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Popis"}),s.jsx("textarea",{className:"form-input",rows:3,value:l.description,onChange:x=>u(v=>({...v,description:x.target.value})),placeholder:"Popis dokumentu..."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Kategorie"}),s.jsxs("select",{className:"form-input",value:l.category,onChange:x=>u(v=>({...v,category:x.target.value})),children:[s.jsx("option",{value:"other",children:"Ostatn"}),s.jsx("option",{value:"itinerary",children:"Itiner"}),s.jsx("option",{value:"rules",children:"Pravidla"}),s.jsx("option",{value:"map",children:"Mapa"}),s.jsx("option",{value:"weather",children:"Pedpov poas"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-lg)",flexDirection:a?"column":"row",justifyContent:a?"stretch":"flex-end"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:n,style:{flex:a?"1":"0 0 auto"},children:"Zruit"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d||!i,style:{flex:a?"1":"0 0 auto"},children:d?"Nahrvn...":"Nahrt dokument"})]})]});return a?s.jsx(ni,{isOpen:!0,onClose:n,title:"Pidat dokument",maxHeight:80,children:w}):s.jsx("div",{className:"modal-overlay",onClick:n,style:{position:"fixed",inset:0,background:"rgba(10, 22, 40, 0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:s.jsxs("div",{className:"modal",onClick:x=>x.stopPropagation(),style:{background:"var(--white)",borderRadius:"var(--radius-xl)",boxShadow:"var(--shadow-xl)",maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("div",{className:"modal-header",style:{padding:"var(--space-xl)",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-plus",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Pidat dokument"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:n,children:s.jsx("i",{className:"fas fa-times"})})]}),w]})})}const vx="organizerContacts",Fo={async saveContactDetails(t,e){try{const n=Ie(se,vx,t);return await sN(n,{...e,updatedAt:ue.now()},{merge:!0}),{error:null}}catch(n){return{error:n.message}}},async getContactDetails(t){try{const e=Ie(se,vx,t),n=await hn(e);return n.exists()?{data:n.data(),error:null}:{data:null,error:null}}catch(e){return{data:null,error:e.message}}}};function Pm({contacts:t=[]}){if(!t||t.length===0)return null;const e=a=>{if(!a)return"?";const i=a.trim().split(" ");return i.length>=2?(i[0][0]+i[1][0]).toUpperCase():a[0].toUpperCase()},n=a=>{switch(a){case"organizer":return"Organiztor plavby";case"captain":return"Kapitn va lod";default:return""}},r=a=>{switch(a){case"organizer":return"linear-gradient(135deg, var(--coral), var(--coral-light))";case"captain":return"linear-gradient(135deg, var(--turquoise), var(--turquoise-light))";default:return"linear-gradient(135deg, var(--ocean-mid), var(--ocean-light))"}};return s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-address-book",style:{color:"var(--turquoise)"}}),"Kontakty"]}),s.jsx("div",{style:{marginTop:"var(--space-md)"},children:t.map((a,i)=>!a||!a.name&&!a.email&&!a.phone?null:s.jsxs("div",{style:{marginBottom:i<t.length-1?"var(--space-lg)":0},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:"var(--space-md)"},children:[s.jsx("div",{className:"crew-avatar",style:{background:r(a.role),width:a.role==="captain"?"40px":"48px",height:a.role==="captain"?"40px":"48px",fontSize:a.role==="captain"?"0.875rem":"1rem"},children:a.role==="organizer"?"O":a.role==="captain"?"K":e(a.name)}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{className:"font-medium",children:a.name||(a.role==="organizer"?"Organiztor":a.role==="captain"?"Kapitn":"Kontakt")}),a.role&&s.jsx("div",{className:"text-sm text-muted",children:n(a.role)})]})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[a.email&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Email"}),s.jsx("a",{href:`mailto:${a.email}`,className:"font-medium",style:{color:"var(--ocean-deep)",textDecoration:"none"},children:a.email})]}),a.phone&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Telefon"}),s.jsx("a",{href:`tel:${a.phone}`,className:"font-medium",style:{color:"var(--ocean-deep)",textDecoration:"none"},children:a.phone})]}),a.address&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Adresa"}),s.jsx("div",{className:"font-medium",style:{whiteSpace:"pre-wrap"},children:a.address})]})]}),i<t.length-1&&s.jsx("div",{style:{marginTop:"var(--space-md)",paddingTop:"var(--space-md)",borderTop:"1px solid var(--gray-100)"}})]},i))})]})}const Ts="boatLogs",ru={async createLogEntry(t,e,n){try{return{id:(await on(xe(se,Ts),{tripId:t,boatId:e,date:n.date?ue.fromDate(new Date(n.date)):ue.now(),route:n.route||"",engineHours:n.engineHours||null,distanceTotal:n.distanceTotal||null,distanceSails:n.distanceSails||null,fuel:n.fuel||null,notes:n.notes||"",locations:n.locations||[],createdAt:ue.now(),updatedAt:ue.now()})).id,error:null}}catch(r){return{id:null,error:r.message}}},async getBoatLogs(t,e){var n;try{const r=ke(xe(se,Ts),ve("tripId","==",t),ve("boatId","==",e),nr("date","desc")),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),{entries:i,error:null}}catch(r){if(r.code==="failed-precondition"||(n=r.message)!=null&&n.includes("index"))try{const a=ke(xe(se,Ts),ve("tripId","==",t),ve("boatId","==",e)),i=await Se(a),o=[];return i.forEach(l=>{o.push({id:l.id,...l.data()})}),o.sort((l,u)=>{var f,m,_,E;const d=((m=(f=l.date)==null?void 0:f.toDate)==null?void 0:m.call(f))||new Date(0);return(((E=(_=u.date)==null?void 0:_.toDate)==null?void 0:E.call(_))||new Date(0))-d}),{entries:o,error:null}}catch(a){return{entries:[],error:a.message}}return{entries:[],error:r.message}}},async getTripLogs(t){var e;try{const n=ke(xe(se,Ts),ve("tripId","==",t),nr("date","desc")),r=await Se(n),a=[];return r.forEach(i=>{a.push({id:i.id,...i.data()})}),{entries:a,error:null}}catch(n){if(n.code==="failed-precondition"||(e=n.message)!=null&&e.includes("index"))try{const r=ke(xe(se,Ts),ve("tripId","==",t)),a=await Se(r),i=[];return a.forEach(o=>{i.push({id:o.id,...o.data()})}),i.sort((o,l)=>{var h,f,m,_;const u=((f=(h=o.date)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date(0);return(((_=(m=l.date)==null?void 0:m.toDate)==null?void 0:_.call(m))||new Date(0))-u}),{entries:i,error:null}}catch(r){return{entries:[],error:r.message}}return{entries:[],error:n.message}}},async updateLogEntry(t,e){try{const n=Ie(se,Ts,t),r={...e,updatedAt:ue.now()};return e.date&&(r.date=ue.fromDate(new Date(e.date))),await $t(n,r),{error:null}}catch(n){return{error:n.message}}},async deleteLogEntry(t){try{return await Vn(Ie(se,Ts,t)),{error:null}}catch(e){return{error:e.message}}}};function d2({tripId:t,boatId:e,entry:n,onClose:r,onSave:a}){var w;const i=lr("(max-width: 768px)"),[o,l]=C.useState({date:(w=n==null?void 0:n.date)!=null&&w.toDate?n.date.toDate().toISOString().split("T")[0]:new Date().toISOString().split("T")[0],route:(n==null?void 0:n.route)||"",engineHours:(n==null?void 0:n.engineHours)!==null&&(n==null?void 0:n.engineHours)!==void 0?n.engineHours:"",distanceTotal:(n==null?void 0:n.distanceTotal)!==null&&(n==null?void 0:n.distanceTotal)!==void 0?n.distanceTotal:"",distanceSails:(n==null?void 0:n.distanceSails)!==null&&(n==null?void 0:n.distanceSails)!==void 0?n.distanceSails:"",fuel:(n==null?void 0:n.fuel)!==null&&(n==null?void 0:n.fuel)!==void 0?n.fuel:"",notes:(n==null?void 0:n.notes)||""}),[u,d]=C.useState(!1),[h,f]=C.useState(null),m=async x=>{x.preventDefault(),d(!0),f(null);const v={date:o.date,route:o.route,engineHours:o.engineHours!==""&&o.engineHours!==null&&o.engineHours!==void 0?parseFloat(o.engineHours):null,distanceTotal:o.distanceTotal!==""&&o.distanceTotal!==null&&o.distanceTotal!==void 0?parseFloat(o.distanceTotal):null,distanceSails:o.distanceSails!==""&&o.distanceSails!==null&&o.distanceSails!==void 0?parseFloat(o.distanceSails):null,fuel:o.fuel!==""&&o.fuel!==null&&o.fuel!==void 0?parseFloat(o.fuel):null,notes:o.notes};let j;n?j=await ru.updateLogEntry(n.id,v):j=await ru.createLogEntry(t,e,v),j.error?(f(j.error),d(!1)):a()},_=s.jsxs("form",{onSubmit:m,children:[h&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:h}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Datum *"}),s.jsx("input",{type:"date",className:"form-input",value:o.date,onChange:x=>l(v=>({...v,date:x.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Trasa"}),s.jsx("input",{type:"text",className:"form-input",value:o.route,onChange:x=>l(v=>({...v,route:x.target.value})),placeholder:"nap. Hvar  Vis"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:i?"1fr":"1fr 1fr",gap:"var(--space-md)",marginBottom:"var(--space-md)"},children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Koncov motohodiny"}),s.jsx("input",{type:"number",step:"0.1",className:"form-input",value:o.engineHours,onChange:x=>l(v=>({...v,engineHours:x.target.value})),placeholder:"nap. 127.5"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Stav paliva (%)"}),s.jsx("input",{type:"number",step:"1",min:"0",max:"100",className:"form-input",value:o.fuel,onChange:x=>l(v=>({...v,fuel:x.target.value})),placeholder:"nap. 80"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Upluto celkem (NM)"}),s.jsx("input",{type:"number",step:"0.1",className:"form-input",value:o.distanceTotal,onChange:x=>l(v=>({...v,distanceTotal:x.target.value})),placeholder:"nap. 25"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Z toho na plachty (NM)"}),s.jsx("input",{type:"number",step:"0.1",className:"form-input",value:o.distanceSails,onChange:x=>l(v=>({...v,distanceSails:x.target.value})),placeholder:"nap. 18"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Poznmka"}),s.jsx("textarea",{className:"form-input",rows:3,value:o.notes,onChange:x=>l(v=>({...v,notes:x.target.value})),placeholder:"Poznmky k dnen plavb..."})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-lg)",flexDirection:i?"column":"row",justifyContent:i?"stretch":"flex-end"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,style:{flex:i?"1":"0 0 auto"},children:"Zruit"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,style:{flex:i?"1":"0 0 auto"},children:u?"Ukldn...":n?"Uloit zmny":"Uloit zznam"})]})]});if(i)return s.jsx(ni,{isOpen:!0,onClose:r,title:n?"Upravit zznam":"Nov zznam v denku",maxHeight:80,children:_});const E=s.jsx("div",{className:"modal-overlay active",onClick:r,children:s.jsxs("div",{className:"modal",onClick:x=>x.stopPropagation(),style:{maxWidth:"600px"},children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-book",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),n?"Upravit zznam":"Nov zznam v denku"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:r,children:s.jsx("i",{className:"fas fa-times"})})]}),_]})});return ju.createPortal(E,document.body)}function su({tripId:t,boatId:e,boatName:n="Bez nzvu",canEdit:r=!1,canView:a=!0,showStats:i=!0,statsOnly:o=!1,onEntriesChange:l}){const[u,d]=C.useState([]),[h,f]=C.useState(!0),[m,_]=C.useState(!1),[E,w]=C.useState(null);C.useEffect(()=>{t&&e&&x()},[t,e]);const x=async()=>{f(!0);const{entries:L}=await ru.getBoatLogs(t,e);d(L||[]),f(!1),l&&l(L||[])},v=async L=>{if(confirm("Opravdu chcete smazat tento zznam?")){const{error:U}=await ru.deleteLogEntry(L);U?alert("Chyba pi mazn zznamu: "+U):await x()}},j=async()=>{await x(),_(!1),w(null)},R=(()=>{if(u.length===0)return{totalDistance:0,totalDistanceSails:0,totalEngineHours:0,fuelConsumption:0};const L=[...u].sort((Q,B)=>{var D,q,G,I;const ee=(D=Q.date)!=null&&D.toDate?Q.date.toDate():(q=Q.date)!=null&&q.seconds?new Date(Q.date.seconds*1e3):new Date(0),W=(G=B.date)!=null&&G.toDate?B.date.toDate():(I=B.date)!=null&&I.seconds?new Date(B.date.seconds*1e3):new Date(0);return ee-W}),U=L[0],N=L[L.length-1],y=u.reduce((Q,B)=>(Q.totalDistance+=B.distanceTotal||0,Q.totalDistanceSails+=B.distanceSails||0,Q),{totalDistance:0,totalDistanceSails:0}),k=U==null?void 0:U.engineHours,b=N==null?void 0:N.engineHours,A=k!=null&&b!==null&&b!==void 0?b-k:0,z=U==null?void 0:U.fuel,T=N==null?void 0:N.fuel,$=z!=null&&T!==null&&T!==void 0?z-T:0;return{totalDistance:y.totalDistance,totalDistanceSails:y.totalDistanceSails,totalEngineHours:A>0?A:0,fuelConsumption:$>0?$:0,sailsPercentage:y.totalDistance>0?Math.round(y.totalDistanceSails/y.totalDistance*100):0}})();return a?h?s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Natn..."}):o?s.jsx(s.Fragment,{children:i&&u.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-chart-line",style:{color:"var(--turquoise)"}}),"Statistiky plavby"]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:[R.totalDistance>0&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Celkem upluto"}),s.jsxs("span",{className:"font-semibold",children:[R.totalDistance.toFixed(1)," NM"]})]}),R.totalDistanceSails>0&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Na plachty"}),s.jsxs("span",{className:"font-semibold",children:[R.totalDistanceSails.toFixed(1)," NM (",R.sailsPercentage,"%)"]})]}),R.totalEngineHours>0&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Motohodiny"}),s.jsxs("span",{className:"font-semibold",children:[R.totalEngineHours.toFixed(1)," h"]})]})]})]}),s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"O lodnm denku"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Lodn denk slou k zznamu prbhu plavby. Zapisujte motohodiny, uplutou vzdlenost a dleit udlosti."})]})]})}):s.jsxs("div",{className:"boat-log-view",children:[s.jsxs("div",{className:"boat-log-header",children:[s.jsxs("h4",{className:"boat-log-title",children:[s.jsx("i",{className:"fas fa-book",style:{color:"var(--turquoise)"}}),"Lodn denk  ",n]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[r&&s.jsxs("button",{className:"btn btn-sm btn-secondary",disabled:!0,style:{opacity:.5,cursor:"not-allowed"},title:"Export do PDF bude brzy dostupn",children:[s.jsx("i",{className:"fas fa-download"}),"Export PDF"]}),r&&s.jsxs("button",{className:"btn btn-sm btn-primary",type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),w(null),_(!0)},children:[s.jsx("i",{className:"fas fa-plus"}),"Nov zznam"]})]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:r?"Zapisujte denn zznamy o plavb. Doporuujeme vyplnit 1 zznam na den.":"Zznamy vypluje kapitn lod. Jako organiztor mte pstup k jejich zobrazen."}),u.length>0?s.jsx("div",{className:"log-entries-list",children:u.map(L=>{var N,y;const U=(N=L.date)!=null&&N.toDate?L.date.toDate():(y=L.date)!=null&&y.seconds?new Date(L.date.seconds*1e3):null;return s.jsxs("div",{className:"log-entry",children:[s.jsxs("div",{className:"log-entry-header",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:U?U.toLocaleDateString("cs-CZ",{day:"numeric",month:"long",year:"numeric"}):"Datum neuvedeno"}),L.route&&s.jsxs("div",{className:"text-sm text-muted",children:["Trasa: ",L.route]})]}),r&&s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)"},children:[s.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>{w(L),_(!0)},title:"Upravit zznam",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>v(L.id),title:"Smazat zznam",children:s.jsx("i",{className:"fas fa-trash"})})]})]}),s.jsxs("div",{className:"log-entry-stats",children:[L.engineHours!==null&&L.engineHours!==void 0&&s.jsxs("div",{className:"log-stat",children:[s.jsx("div",{className:"text-xs text-muted",children:"Motohodiny"}),s.jsx("div",{className:"font-semibold",children:L.engineHours})]}),L.distanceTotal!==null&&L.distanceTotal!==void 0&&s.jsxs("div",{className:"log-stat",children:[s.jsx("div",{className:"text-xs text-muted",children:"Upluto celkem"}),s.jsxs("div",{className:"font-semibold",children:[L.distanceTotal," NM"]})]}),L.distanceSails!==null&&L.distanceSails!==void 0&&s.jsxs("div",{className:"log-stat",children:[s.jsx("div",{className:"text-xs text-muted",children:"Z toho na plachty"}),s.jsxs("div",{className:"font-semibold",children:[L.distanceSails," NM"]})]}),L.fuel!==null&&L.fuel!==void 0&&s.jsxs("div",{className:"log-stat",children:[s.jsx("div",{className:"text-xs text-muted",children:"Palivo"}),s.jsxs("div",{className:"font-semibold",children:[L.fuel,"%"]})]})]}),L.notes&&s.jsxs("div",{className:"log-entry-notes",children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Poznmka:"}),s.jsx("div",{className:"text-sm",style:{whiteSpace:"pre-wrap"},children:L.notes})]})]},L.id)})}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:r?"Zatm nejsou dn zznamy. Vytvote prvn zznam.":"Zatm nejsou dn zznamy v lodnm denku."}),i&&u.length>0&&!o&&s.jsxs("div",{style:{marginTop:"var(--space-xl)",paddingTop:"var(--space-xl)",borderTop:"1px solid var(--gray-100)"},children:[s.jsxs("h4",{style:{marginBottom:"var(--space-lg)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-chart-line",style:{color:"var(--turquoise)"}}),"Statistiky plavby"]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"var(--space-md)"},children:[R.totalDistance>0&&s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Celkem upluto"}),s.jsxs("div",{className:"font-semibold",style:{fontSize:"1.25rem"},children:[R.totalDistance.toFixed(1)," NM"]})]}),R.totalDistanceSails>0&&s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Na plachty"}),s.jsxs("div",{className:"font-semibold",style:{fontSize:"1.25rem"},children:[R.totalDistanceSails.toFixed(1)," NM (",R.sailsPercentage,"%)"]})]}),R.totalEngineHours>0&&s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-xs text-muted",style:{marginBottom:"var(--space-xs)"},children:"Motohodiny"}),s.jsxs("div",{className:"font-semibold",style:{fontSize:"1.25rem"},children:[R.totalEngineHours.toFixed(1)," h"]})]})]})]}),m&&t&&e&&s.jsx(d2,{tripId:t,boatId:e,entry:E,onClose:()=>{_(!1),w(null)},onSave:j})]}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Nemte oprvnn k zobrazen lodnho denku."})}function h2({isOpen:t,onClose:e,participantId:n,tripName:r}){const a=_t(),[i,o]=C.useState(!1);if(!t)return null;const l=async()=>{if(!window.confirm(`Opravdu se chcete nezastnit tto plavby?

Tato akce vs odebere z plavby a ztratte pstup ke vem informacm o tto plavb. Tuto akci nelze vrtit zpt.`))return;o(!0);const{error:d}=await Je.removeParticipant(n);d?(alert("Chyba pi odhlen z plavby: "+d),o(!1),e()):a("/trips")};return s.jsx("div",{className:"modal-overlay active",onClick:e,children:s.jsxs("div",{className:"modal",onClick:u=>u.stopPropagation(),style:{maxWidth:"500px"},children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-user-cog",style:{color:"var(--gray-600)",marginRight:"var(--space-sm)"}}),"Sprva asti"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:["Zde mete spravovat svou ast na tto plavb",r?` "${r}"`:"","."]}),s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:s.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--danger)",margin:0,fontWeight:500},children:[s.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:"var(--space-xs)"}}),"Odhlen z plavby je nevratn akce. Po odhlen ztratte pstup ke vem informacm o tto plavb."]})})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:e,disabled:i,children:"Zruit"}),s.jsxs("button",{className:"btn",onClick:l,disabled:i,style:{background:"var(--danger)",borderColor:"var(--danger)",color:"white"},children:[s.jsx("i",{className:"fas fa-user-minus"}),i?"Odhlaovn...":"Nezastnit se plavby"]})]})]})})}function p2(){const{tripId:t}=ir(),{user:e}=yt();_t();const n=lr("(max-width: 768px)"),[r,a]=C.useState(null),[i,o]=C.useState(null),[l,u]=C.useState(null),[d,h]=C.useState([]),[f,m]=C.useState([]),[_,E]=C.useState({}),[w,x]=C.useState([]),[v,j]=C.useState(null),[S,R]=C.useState(new Map),[L,U]=C.useState(!0),[N,y]=C.useState("prehled"),[k,b]=C.useState(null),[A,z]=C.useState(!1),T=[{id:"prehled",label:"Pehled",icon:s.jsx("i",{className:"fas fa-info-circle"})},{id:"pred-plavbou",label:"Ped plavbou",icon:s.jsx("i",{className:"fas fa-flag-checkered"})},{id:"moje-lod",label:"Moje lo",icon:s.jsx("i",{className:"fas fa-ship"})},{id:"crew-list",label:"Crew list",icon:s.jsx("i",{className:"fas fa-users"})},{id:"checklisty",label:"Checklisty",icon:s.jsx("i",{className:"fas fa-tasks"})},{id:"lodni-denik",label:"Lodn denk",icon:s.jsx("i",{className:"fas fa-book"})}];C.useEffect(()=>{t&&e&&$()},[t,e]),C.useEffect(()=>{const D=window.location.hash;D==="#crew-list"?y("crew-list"):D==="#checklisty"?y("checklisty"):D==="#pred-plavbou"&&y("pred-plavbou")},[]),C.useEffect(()=>{const D=()=>{const q=window.location.hash;q==="#crew-list"?y("crew-list"):q==="#checklisty"?y("checklisty"):q==="#pred-plavbou"&&y("pred-plavbou")};return window.addEventListener("hashchange",D),()=>window.removeEventListener("hashchange",D)},[]);const $=async()=>{U(!0);const[D,q]=await Promise.all([pt.getTrip(t),Je.getParticipant(t,e.uid)]);if(D.data&&(a(D.data),D.data.organizerId)){const{data:O}=await Fo.getContactDetails(D.data.organizerId);O&&j(O)}if(q.data&&(o(q.data),q.data.boatId)){const{data:O}=await Jt.getBoat(q.data.boatId);if(O){u(O);const{participants:F}=await Je.getBoatParticipants(t,O.id);h(F);const H=F.map(oe=>oe.userId);if(H.length>0){const oe=await pi(H);R(oe)}const{instances:X}=await Fe.getTripInstances(t,{userId:e.uid}),{instances:te}=await Fe.getTripInstances(t,{boatId:O.id}),ae=[],pe=new Set;X&&X.forEach(oe=>{oe.templateId&&!pe.has(oe.templateId)&&(pe.add(oe.templateId),ae.push(oe))}),te&&te.forEach(oe=>{oe.templateId&&!pe.has(oe.templateId)&&(pe.add(oe.templateId),ae.push(oe))}),x(ae)}}const{events:G,error:I}=await wt.getTripEvents(t);if(!I&&G){const O=G.filter(H=>!H.roles||H.roles.length===0?!0:H.roles.includes("captain"));m(O);const F={};for(const H of O)if(H.checkable){const{completed:X}=await wt.getEventCompletion(H.id,e.uid);F[H.id]=X}E(F)}U(!1)},Q=async D=>{const G=!(_[D]||!1),{error:I}=await wt.setEventCompletion(D,e.uid,G);I||E(O=>({...O,[D]:G}))},B=D=>D?D.toDate?D.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):D.seconds?new Date(D.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",ee=(D,q)=>{if(!D||!q)return"Neuvedeno";const G=B(D),I=B(q);return`${G}  ${I}`},W=D=>{if(!D)return null;const I=(D.toDate?D.toDate():new Date(D.seconds*1e3))-new Date,O=Math.ceil(I/(1e3*60*60*24));return O>0?O:null};return L?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):!r||!i||i.role!=="captain"?s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Plavba nenalezena nebo nejsi kapitnem"}),s.jsx(ie,{to:"/trips",className:"btn btn-primary",children:"Zpt na plavby"})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"trip-header",style:r.bannerImageUrl?{backgroundImage:`url(${r.bannerImageUrl})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"}:{},children:[r.bannerImageUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.8), rgba(10, 22, 40, 0.6))"}}),s.jsx("div",{className:"container",style:{position:"relative",zIndex:1},children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx(ie,{to:"/trips",children:"M plavby"}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx("span",{children:r.name||"Bez nzvu"})]}),s.jsxs("div",{className:"trip-title-row",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",children:r.name||"Bez nzvu"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-xs)",flexWrap:"wrap",alignItems:"center"},children:(()=>{r.organizerId,e.uid;const D=Tm(r,i,e.uid),q="captain";return[...D].sort((I,O)=>I===q?-1:O===q?1:0).map(I=>{const O=I===q,F=I==="organizer"?"fa-crown":I==="captain"?"fa-ship":"fa-user";if(O)return s.jsxs("span",{className:`role-badge ${I}`,children:[s.jsx("i",{className:`fas ${F}`}),Ma(I)]},I);{const H=I==="organizer"?`/trip/${t}/organizer`:`/trip/${t}/participant`;return s.jsxs(ie,{to:H,className:`role-badge ${I}`,style:{cursor:"pointer",textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"var(--space-xs)"},title:`Zobrazit jako ${Ma(I).toLowerCase()}`,onMouseEnter:X=>{I==="organizer"?(X.currentTarget.style.transform="scale(1.05)",X.currentTarget.style.boxShadow="0 4px 12px rgba(249, 115, 22, 0.3)",X.currentTarget.style.background="rgba(249, 115, 22, 0.4)"):(X.currentTarget.style.transform="scale(1.05)",X.currentTarget.style.boxShadow="0 4px 12px rgba(6, 182, 212, 0.3)")},onMouseLeave:X=>{X.currentTarget.style.transform="scale(1)",X.currentTarget.style.boxShadow="none",I==="organizer"&&(X.currentTarget.style.background="rgba(249, 115, 22, 0.3)")},children:[s.jsx("i",{className:`fas ${F}`}),Ma(I),s.jsx("i",{className:"fas fa-external-link-alt",style:{marginLeft:"4px",fontSize:"0.7rem"}})]},I)}})})()})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{style:{fontSize:"0.875rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"4px"},children:"Organizuje"}),s.jsx("div",{style:{fontWeight:600,color:"var(--white)"},children:(v==null?void 0:v.name)||"Organiztor"})]})]}),s.jsxs("div",{className:"trip-header-meta",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",flexWrap:"wrap"},children:[s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-calendar"}),s.jsx("span",{children:ee(r.startDate,r.endDate)})]}),(r.locationName||r.startLocation)&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-map-marker-alt"}),s.jsx("span",{children:r.locationName||r.startLocation})]}),W(r.startDate)!==null&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-clock"}),s.jsx("span",{children:W(r.startDate)===0?"Zan dnes":W(r.startDate)===1?"Zan ztra":`${W(r.startDate)} dn do startu`})]})]}),s.jsx("button",{onClick:()=>z(!0),style:{background:"none",border:"none",color:"rgba(255, 255, 255, 0.6)",cursor:"pointer",padding:"var(--space-xs)",display:"flex",alignItems:"center",justifyContent:"center",transition:"color var(--transition-fast)",fontSize:"0.875rem"},onMouseEnter:D=>{D.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:D=>{D.currentTarget.style.color="rgba(255, 255, 255, 0.6)"},title:"Sprva asti",children:s.jsx("i",{className:"fas fa-cog"})})]})]})})]}),n?s.jsx(Cm,{tabs:T,activeTab:N,onTabChange:y}):s.jsx("div",{className:"trip-tabs",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-tabs-inner",children:[s.jsxs("button",{className:`trip-tab ${N==="prehled"?"active":""}`,onClick:()=>y("prehled"),children:[s.jsx("i",{className:"fas fa-info-circle"}),"Pehled"]}),s.jsxs("button",{className:`trip-tab ${N==="pred-plavbou"?"active":""}`,onClick:()=>y("pred-plavbou"),children:[s.jsx("i",{className:"fas fa-flag-checkered"}),"Ped plavbou"]}),s.jsxs("button",{className:`trip-tab ${N==="moje-lod"?"active":""}`,onClick:()=>y("moje-lod"),children:[s.jsx("i",{className:"fas fa-ship"}),"Moje lo"]}),s.jsxs("button",{className:`trip-tab ${N==="crew-list"?"active":""}`,onClick:()=>y("crew-list"),children:[s.jsx("i",{className:"fas fa-users"}),"Crew list"]}),s.jsxs("button",{className:`trip-tab ${N==="checklisty"?"active":""}`,onClick:()=>y("checklisty"),children:[s.jsx("i",{className:"fas fa-tasks"}),"Checklisty"]}),s.jsxs("button",{className:`trip-tab ${N==="lodni-denik"?"active":""}`,onClick:()=>y("lodni-denik"),children:[s.jsx("i",{className:"fas fa-book"}),"Lodn denk"]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",children:[N==="prehled"&&s.jsxs(s.Fragment,{children:[l&&s.jsxs("div",{className:"admin-panel animate-in",style:{background:"linear-gradient(135deg, rgba(6, 182, 212, 0.05), rgba(6, 182, 212, 0.1))",borderColor:"rgba(6, 182, 212, 0.2)",marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"admin-panel-header",style:{color:"var(--turquoise)"},children:[s.jsx("i",{className:"fas fa-ship"}),"Jste kapitnem lod ",l.name||"Bez nzvu"]}),s.jsx("p",{className:"text-sm",style:{color:"var(--gray-600)"},children:"Jako kapitn mte pstup k crew listu va posdky, mete vyplovat checklisty pedn lod a vst lodn denk."})]}),s.jsxs("div",{className:"trip-layout",children:[s.jsxs("div",{className:"main-content",children:[s.jsx(Ku,{trip:r}),s.jsx(Gu,{trip:r})]}),s.jsxs("aside",{children:[v&&s.jsx(Pm,{contacts:[{...v,role:"organizer"}]}),r.usefulLinks&&r.usefulLinks.length>0&&s.jsx(Em,{usefulLinks:r.usefulLinks}),s.jsxs("div",{className:"sidebar-card animate-in",style:{marginBottom:"var(--space-lg)"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-chart-bar",style:{color:"var(--turquoise)"}}),"Pehled"]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Vae lo"}),s.jsx("span",{className:"font-semibold",children:(l==null?void 0:l.name)||"Nepiazeno"})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Posdka"}),s.jsxs("span",{className:"font-semibold",children:[d.length," osob"]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Crew list"}),s.jsx("span",{className:"status-pill success",style:{fontSize:"0.75rem"},children:"Kompletn"})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Checklisty lod"}),s.jsx("span",{className:"status-pill warning",style:{fontSize:"0.75rem"},children:"1 k vyplnn"})]})]})]})]})]})]}),N==="pred-plavbou"&&s.jsx(Sm,{events:f,eventCompletions:_,onEventToggle:Q,viewType:"captain",tripId:t,trip:r}),N==="moje-lod"&&s.jsx("div",{className:"trip-layout",children:s.jsx("div",{className:"main-content",children:l?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-lg)"},children:[l.thumbnailUrl&&s.jsx("div",{style:{height:"200px",backgroundImage:`url(${l.thumbnailUrl})`,backgroundSize:"cover",backgroundPosition:"center",borderRadius:"var(--radius-md) var(--radius-md) 0 0"}}),s.jsxs("div",{style:{padding:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--space-md)"},children:[s.jsxs("div",{children:[s.jsx("h4",{style:{fontSize:"1.25rem",marginBottom:"var(--space-xs)"},children:l.model||"Model neuveden"}),s.jsx("p",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:l.name||"Bez nzvu"})]}),s.jsxs("span",{className:"status-pill info",style:{fontSize:"0.75rem"},children:[s.jsx("i",{className:"fas fa-anchor"})," V kapitant"]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"var(--space-md)"},children:[l.length&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Dlka"}),s.jsxs("div",{className:"font-semibold",children:[l.length," m"]})]}),l.year&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Rok vroby"}),s.jsx("div",{className:"font-semibold",children:l.year})]}),l.cabins&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Kajuty"}),s.jsx("div",{className:"font-semibold",children:l.cabins})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Obsazenost"}),s.jsxs("div",{className:"font-semibold",children:[d.length,l.capacity?`/${l.capacity}`:""]})]})]}),l.charterLink&&s.jsx("div",{style:{marginTop:"var(--space-md)",paddingTop:"var(--space-md)",borderTop:"1px solid var(--gray-100)"},children:s.jsxs("a",{href:l.charterLink,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-ghost",style:{fontSize:"0.875rem"},children:[s.jsx("i",{className:"fas fa-external-link-alt"}),"Detail lodi"]})})]})]}),s.jsxs("div",{className:"card animate-in delay-1",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-users",style:{color:"var(--turquoise)"}}),"Posdka (",d.length,l.capacity?`/${l.capacity}`:"",")"]}),s.jsx("span",{className:"text-sm text-muted",children:"Jako kapitn mete mnit podrole"})]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:d.map(D=>{const q=D.role==="captain",G=D.userId===e.uid,I=S.get(D.userId),O=(I==null?void 0:I.name)||"Neznm uivatel";let F="??";if(I!=null&&I.name){const H=I.name.trim().split(/\s+/);H.length>=2?F=(H[0][0]+H[H.length-1][0]).toUpperCase():F=I.name.substring(0,2).toUpperCase()}else F=D.userId.substring(0,2).toUpperCase();return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",padding:"var(--space-md)",background:G?"rgba(6, 182, 212, 0.1)":"var(--white)",border:`1px solid ${G?"rgba(6, 182, 212, 0.2)":"var(--gray-200)"}`,borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:`crew-avatar ${q?"captain":""}`,style:{width:"48px",height:"48px",fontSize:"1rem"},children:F}),s.jsxs("div",{style:{flex:1},children:[s.jsx("h5",{style:{margin:0,marginBottom:"var(--space-xs)"},children:O}),s.jsx("p",{style:{margin:0,color:"var(--gray-500)",fontSize:"0.875rem"},children:q?"Kapitn":"Posdka"})]}),q?s.jsx("span",{className:"crew-badge",style:{padding:"var(--space-xs) var(--space-md)",background:"var(--turquoise)",color:"white",borderRadius:"var(--radius-full)",fontSize:"0.875rem"},children:"Kapitn"}):s.jsxs("select",{className:"form-input",style:{width:"auto",minWidth:"150px",padding:"var(--space-xs) var(--space-sm)",fontSize:"0.875rem"},defaultValue:"",onChange:async H=>{console.log("Subrole update:",D.id,H.target.value)},children:[s.jsx("option",{value:"",children:"Bez podrole"}),s.jsx("option",{value:"kormidelnik",children:"Kormidelnk"}),s.jsx("option",{value:"mastman",children:"Mastman"}),s.jsx("option",{value:"bowman",children:"Bowman"})]})]},D.id)})})]}),(()=>{const D=w.filter(q=>q.boatId&&!q.userId);return D.length>0&&s.jsxs("div",{className:"card animate-in delay-2",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-tasks",style:{color:"var(--turquoise)"}}),"Checklisty lod"]}),s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>y("checklisty"),children:["Zobrazit vechny",s.jsx("i",{className:"fas fa-chevron-right",style:{marginLeft:"var(--space-xs)"}})]})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:[D.slice(0,3).map(q=>{var O,F;const G=((O=q.items)==null?void 0:O.filter(H=>H.completed).length)||0,I=((F=q.items)==null?void 0:F.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:H=>H.currentTarget.style.background="var(--gray-100)",onMouseLeave:H=>H.currentTarget.style.background="var(--gray-50)",onClick:()=>{b(q.id),y("checklisty")},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"40px",height:"40px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)",fontSize:"1rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{fontSize:"0.875rem"},children:q.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",style:{fontSize:"0.75rem"},children:q.userId===e.uid?"Osobn":"Checklist lod"})]})]}),s.jsxs("span",{className:`status-pill ${G===I&&I>0?"success":"warning"}`,style:{fontSize:"0.75rem"},children:[G,"/",I]})]},q.id)}),D.length>3&&s.jsx("div",{style:{textAlign:"center",paddingTop:"var(--space-sm)"},children:s.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>y("checklisty"),children:["Zobrazit vechny checklisty (",D.length,")"]})})]})]})})()]}):s.jsx("div",{className:"card",children:s.jsx("p",{style:{color:"var(--gray-500)",textAlign:"center",padding:"var(--space-xl)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji."})})})}),N==="crew-list"&&s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Crew list"]})}),l?s.jsx(kN,{tripId:t,boatId:l.id,canEdit:!0,userId:e.uid,viewContext:"captain",trip:r}):s.jsx("div",{style:{padding:"var(--space-xl)",textAlign:"center"},children:s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm ti nen piazena dn lo."})})]}),N==="checklisty"&&!k&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Dostupn checklisty"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Tyto checklisty vm pidlil organiztor. Kliknutm je otevete a mete je vyplovat."}),l?w.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:w.map(D=>{var I,O;const q=((I=D.items)==null?void 0:I.filter(F=>F.completed).length)||0,G=((O=D.items)==null?void 0:O.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:F=>F.currentTarget.style.background="var(--gray-100)",onMouseLeave:F=>F.currentTarget.style.background="var(--gray-50)",onClick:()=>b(D.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:D.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:D.userId===e.uid?"Osobn checklist":D.boatId?"Checklist lod":D.description||"Checklist"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsxs("span",{className:`status-pill ${q===G&&G>0?"success":"warning"}`,style:{fontSize:"0.75rem"},children:[q,"/",G]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},D.id)})}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou piazeny dn checklisty pro tuto lo. Organiztor me piadit checklisty v nastaven."}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji, pot budou dostupn checklisty."})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Tip"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Kliknutm na checklist ho otevete. Poloky mete oznaovat jako splnn a v postup se automaticky ukld."})]})})]}),N==="checklisty"&&k&&(()=>{var O,F;const D=w.find(H=>H.id===k);if(!D)return b(null),null;const q=((O=D.items)==null?void 0:O.filter(H=>H.completed).length)||0,G=((F=D.items)==null?void 0:F.length)||0,I=H=>{x(X=>X.map(te=>te.id===H.id?H:te))};return s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>b(null),style:{marginRight:"var(--space-sm)"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-check",style:{color:"var(--turquoise)"}}),D.name||"Checklist"]})]}),s.jsxs("span",{className:`status-pill ${q===G&&G>0?"success":"warning"}`,children:[q,"/",G]})]}),s.jsx("div",{style:{padding:"var(--space-xl)"},children:s.jsx(Hu,{instance:D,onUpdate:I,canEdit:!0,canView:!0,isOwnChecklist:!0,defaultMode:"edit"})})]})})})(),N==="lodni-denik"&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsx("div",{className:"card animate-in",children:l?s.jsx(su,{tripId:t,boatId:l.id,boatName:l.name||"Bez nzvu",canEdit:!0,canView:!0,showStats:!0}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Zatm ti nen piazena dn lo."})})}),s.jsx("aside",{children:l&&s.jsx(su,{tripId:t,boatId:l.id,boatName:l.name||"Bez nzvu",canEdit:!1,canView:!0,showStats:!0,statsOnly:!0})})]})]})}),s.jsx(h2,{isOpen:A,onClose:()=>z(!1),participantId:i==null?void 0:i.id,tripName:r==null?void 0:r.name})]})}function f2({tripId:t,boatId:e,userId:n,role:r,onSave:a}){const[i,o]=C.useState(null),[l,u]=C.useState({}),[d,h]=C.useState(!0),[f,m]=C.useState(!1),[_,E]=C.useState(null);C.useEffect(()=>{w()},[t,e,n]);const w=async()=>{var R,L;h(!0);const{data:S}=await Nn.getTemplate(t);if(S){o(S);const U=((R=S.fields)==null?void 0:R[r])||((L=S.fields)==null?void 0:L.participant)||[],N={};if(U.forEach(y=>{N[y.id]=y.defaultValue||""}),u(N),e){const{data:y}=await Nn.getCrewlistData(t,e,n);y&&u(k=>({...k,...y}))}}h(!1)},x=(S,R)=>{u(L=>({...L,[S]:R}))},v=async S=>{if(S.preventDefault(),!e){E("Nejste piazeni k dn lodi");return}m(!0),E(null);const{id:R,error:L}=await Nn.saveCrewlistData(t,e,n,l);L?E(L):a&&a(),m(!1)};if(d)return s.jsx("div",{className:"crewlist-loading",children:"Natn formule..."});if(!i||!i.fields)return s.jsx("div",{className:"crewlist-empty",children:s.jsx("p",{children:"Organiztor zatm nedefinoval poadovan daje pro crewlist."})});const j=i.fields[r]||i.fields.participant||[];return j.length===0?s.jsx("div",{className:"crewlist-empty",children:s.jsx("p",{children:"Pro vai roli nejsou vyadovny dn daje do crewlistu."})}):s.jsxs("form",{onSubmit:v,className:"crewlist-form",children:[_&&s.jsxs("div",{className:"crewlist-error",children:[s.jsx("i",{className:"fas fa-exclamation-circle"}),_]}),j.map(S=>s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{className:"form-label",children:[S.label,S.required&&s.jsx("span",{className:"required",children:"*"})]}),S.type==="textarea"?s.jsx("textarea",{className:"form-input",value:l[S.id]||"",onChange:R=>x(S.id,R.target.value),required:S.required,placeholder:S.placeholder,rows:3}):s.jsx("input",{type:S.type||"text",className:"form-input",value:l[S.id]||"",onChange:R=>x(S.id,R.target.value),required:S.required}),S.helpText&&s.jsx("p",{className:"form-help",children:S.helpText})]},S.id)),s.jsx("div",{className:"form-actions",children:s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f||!e,children:f?"Ukldn...":"Uloit crewlist"})})]})}function m2(){const{tripId:t}=ir(),{user:e}=yt(),n=lr("(max-width: 768px)"),[r,a]=C.useState(null),[i,o]=C.useState(null),[l,u]=C.useState(null),[d,h]=C.useState([]),[f,m]=C.useState([]),[_,E]=C.useState({}),[w,x]=C.useState([]),[v,j]=C.useState(null),[S,R]=C.useState(null),[L,U]=C.useState(new Map),[N,y]=C.useState(!0),[k,b]=C.useState("prehled"),[A,z]=C.useState(null),T=[{id:"prehled",label:"Pehled",icon:s.jsx("i",{className:"fas fa-info-circle"})},{id:"pred-plavbou",label:"Ped plavbou",icon:s.jsx("i",{className:"fas fa-flag-checkered"})},{id:"moje-lod",label:"Moje lo",icon:s.jsx("i",{className:"fas fa-ship"})},{id:"crew-list",label:"Crew list",icon:s.jsx("i",{className:"fas fa-clipboard-list"})},{id:"checklisty",label:"Checklisty",icon:s.jsx("i",{className:"fas fa-tasks"})}];C.useEffect(()=>{t&&e&&$()},[t,e]),C.useEffect(()=>{const D=window.location.hash;D==="#crew-list"?b("crew-list"):D==="#checklisty"?b("checklisty"):D==="#pred-plavbou"&&b("pred-plavbou")},[]),C.useEffect(()=>{const D=()=>{const q=window.location.hash;q==="#crew-list"?b("crew-list"):q==="#checklisty"?b("checklisty"):q==="#pred-plavbou"&&b("pred-plavbou")};return window.addEventListener("hashchange",D),()=>window.removeEventListener("hashchange",D)},[]);const $=async()=>{var O;y(!0);const[D,q]=await Promise.all([pt.getTrip(t),Je.getParticipant(t,e.uid)]);if(D.data&&(a(D.data),D.data.organizerId)){const{data:F}=await Fo.getContactDetails(D.data.organizerId);F&&j(F)}if(q.data&&(o(q.data),q.data.boatId)){const{data:F}=await Jt.getBoat(q.data.boatId);if(F){u(F);const{participants:H}=await Je.getBoatParticipants(t,F.id);h(H);const X=H.map(oe=>oe.userId);if(X.length>0){const oe=await pi(X);U(oe)}const te=H.find(oe=>oe.role==="captain");if(te){const oe=L.get(te.userId)||await ps.getProfile(te.userId).then(De=>De.data);oe&&R(oe)}const{instances:ae}=await Fe.getTripInstances(t,{boatId:F.id,role:"participant"});ae&&x(ae);const{instances:pe}=await Fe.getTripInstances(t,{userId:e.uid});pe&&pe.length>0&&x(oe=>{const De=[...oe];return pe.forEach(Te=>{De.find(V=>V.id===Te.id)||De.push(Te)}),De})}}const{events:G,error:I}=await wt.getTripEvents(t);if(!I&&G){const F=((O=q.data)==null?void 0:O.role)||"participant",H=G.filter(te=>!!(!te.roles||te.roles.length===0||F==="captain"&&te.roles.includes("captain")||F==="participant"&&te.roles.includes("participant")));m(H);const X={};for(const te of H)if(te.checkable){const{completed:ae}=await wt.getEventCompletion(te.id,e.uid);X[te.id]=ae}E(X)}y(!1)},Q=async D=>{const G=!(_[D]||!1),{error:I}=await wt.setEventCompletion(D,e.uid,G);I||E(O=>({...O,[D]:G}))},B=D=>D?D.toDate?D.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):D.seconds?new Date(D.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",ee=(D,q)=>{if(!D||!q)return"Neuvedeno";const G=B(D),I=B(q);return`${G}  ${I}`},W=D=>{if(!D)return null;const I=(D.toDate?D.toDate():new Date(D.seconds*1e3))-new Date,O=Math.ceil(I/(1e3*60*60*24));return O>0?O:null};return N?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):!r||!i?s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Plavba nenalezena nebo nejsi astnkem"}),s.jsx(ie,{to:"/trips",className:"btn btn-primary",children:"Zpt na plavby"})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"trip-header",style:r.bannerImageUrl?{backgroundImage:`url(${r.bannerImageUrl})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"}:{},children:[r.bannerImageUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.8), rgba(10, 22, 40, 0.6))"}}),s.jsx("div",{className:"container",style:{position:"relative",zIndex:1},children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx(ie,{to:"/trips",children:"M plavby"}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx("span",{children:r.name||"Bez nzvu"})]}),s.jsxs("div",{className:"trip-title-row",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",children:r.name||"Bez nzvu"}),s.jsx("div",{style:{display:"flex",gap:"var(--space-xs)",flexWrap:"wrap",alignItems:"center"},children:(()=>{r.organizerId,e.uid;const D=Tm(r,i,e.uid),q=(i==null?void 0:i.role)==="captain"?"captain":"participant";return[...D].sort((I,O)=>I===q?-1:O===q?1:0).map(I=>{const O=I===q,F=I==="organizer"?"fa-crown":I==="captain"?"fa-ship":"fa-user";if(O)return s.jsxs("span",{className:`role-badge ${I}`,children:[s.jsx("i",{className:`fas ${F}`}),Ma(I)]},I);{const H=I==="organizer"?`/trip/${t}/organizer`:I==="captain"?`/trip/${t}/captain`:`/trip/${t}/participant`;return s.jsxs(ie,{to:H,className:`role-badge ${I}`,style:{cursor:"pointer",textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"var(--space-xs)"},title:`Zobrazit jako ${Ma(I).toLowerCase()}`,onMouseEnter:X=>{I==="organizer"?(X.currentTarget.style.transform="scale(1.05)",X.currentTarget.style.boxShadow="0 4px 12px rgba(249, 115, 22, 0.3)",X.currentTarget.style.background="rgba(249, 115, 22, 0.4)"):(X.currentTarget.style.transform="scale(1.05)",X.currentTarget.style.boxShadow="0 4px 12px rgba(6, 182, 212, 0.3)")},onMouseLeave:X=>{X.currentTarget.style.transform="scale(1)",X.currentTarget.style.boxShadow="none",I==="organizer"&&(X.currentTarget.style.background="rgba(249, 115, 22, 0.3)")},children:[s.jsx("i",{className:`fas ${F}`}),Ma(I),s.jsx("i",{className:"fas fa-external-link-alt",style:{marginLeft:"4px",fontSize:"0.7rem"}})]},I)}})})()})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{style:{fontSize:"0.875rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"4px"},children:"Organizuje"}),s.jsx("div",{style:{fontWeight:600,color:"var(--white)"},children:(v==null?void 0:v.name)||"Organiztor"})]})]}),s.jsxs("div",{className:"trip-header-meta",children:[s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-calendar"}),s.jsx("span",{children:ee(r.startDate,r.endDate)})]}),(r.locationName||r.startLocation)&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-map-marker-alt"}),s.jsx("span",{children:r.locationName||r.startLocation})]}),W(r.startDate)!==null&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-clock"}),s.jsx("span",{children:W(r.startDate)===0?"Zan dnes":W(r.startDate)===1?"Zan ztra":`${W(r.startDate)} dn do startu`})]})]})]})})]}),n?s.jsx(Cm,{tabs:T,activeTab:k,onTabChange:b}):s.jsx("div",{className:"trip-tabs",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-tabs-inner",children:[s.jsxs("button",{className:`trip-tab ${k==="prehled"?"active":""}`,onClick:()=>b("prehled"),children:[s.jsx("i",{className:"fas fa-info-circle"}),"Pehled"]}),s.jsxs("button",{className:`trip-tab ${k==="pred-plavbou"?"active":""}`,onClick:()=>b("pred-plavbou"),children:[s.jsx("i",{className:"fas fa-flag-checkered"}),"Ped plavbou"]}),s.jsxs("button",{className:`trip-tab ${k==="moje-lod"?"active":""}`,onClick:()=>b("moje-lod"),children:[s.jsx("i",{className:"fas fa-ship"}),"Moje lo"]}),s.jsxs("button",{className:`trip-tab ${k==="crew-list"?"active":""}`,onClick:()=>b("crew-list"),children:[s.jsx("i",{className:"fas fa-clipboard-list"}),"Crew list"]}),s.jsxs("button",{className:`trip-tab ${k==="checklisty"?"active":""}`,onClick:()=>b("checklisty"),children:[s.jsx("i",{className:"fas fa-tasks"}),"Checklisty"]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",children:[k==="prehled"&&s.jsxs("div",{className:"trip-layout",children:[s.jsxs("div",{className:"main-content",children:[s.jsx(Ku,{trip:r}),s.jsx(Gu,{trip:r}),s.jsxs("div",{className:"card animate-in delay-2",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)"}}),"Lod ve flotile"]})}),l?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"var(--space-lg)"},children:s.jsx(Im,{boat:l,participantCount:d.length,highlighted:!0,clickable:!0,onClick:()=>b("moje-lod"),viewType:"participant"})}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji."})]})]}),s.jsxs("aside",{children:[s.jsx(Pm,{contacts:[...S&&(S.name||S.email||S.phone)?[{...S,role:"captain"}]:[],...v&&(v.name||v.email||v.phone)?[{...v,role:"organizer"}]:[]]}),r.usefulLinks&&r.usefulLinks.length>0&&s.jsx(Em,{usefulLinks:r.usefulLinks})]})]}),k==="pred-plavbou"&&s.jsx(Sm,{events:f,eventCompletions:_,onEventToggle:Q,viewType:"participant",tripId:t,trip:r}),k==="moje-lod"&&s.jsx("div",{className:"trip-layout",children:s.jsx("div",{className:"main-content",children:l?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"card animate-in",style:{marginBottom:"var(--space-lg)"},children:s.jsxs("div",{style:{padding:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--space-md)"},children:[s.jsxs("div",{children:[s.jsx("h4",{style:{fontSize:"1.25rem",marginBottom:"var(--space-xs)"},children:l.model||"Model neuveden"}),s.jsx("p",{style:{fontSize:"0.875rem",color:"var(--gray-600)"},children:l.name||"Bez nzvu"})]}),s.jsx("span",{className:"status-pill info",style:{fontSize:"0.75rem"},children:"Vae lo"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"var(--space-md)"},children:[l.length&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Dlka"}),s.jsxs("div",{className:"font-semibold",children:[l.length," m"]})]}),l.year&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Rok vroby"}),s.jsx("div",{className:"font-semibold",children:l.year})]}),l.cabins&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Kajuty"}),s.jsx("div",{className:"font-semibold",children:l.cabins})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Kapacita"}),s.jsx("div",{className:"font-semibold",children:l.capacity||"-"})]})]})]})}),s.jsxs("div",{className:"card animate-in delay-1",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-users",style:{color:"var(--turquoise)"}}),"Posdka"]})}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:d&&d.length>0?d.map(D=>{const q=D.role==="captain",G=D.userId===e.uid,I=L.get(D.userId),O=(I==null?void 0:I.name)||"Neznm uivatel";let F="??";if(I!=null&&I.name){const H=I.name.trim().split(/\s+/);H.length>=2?F=(H[0][0]+H[H.length-1][0]).toUpperCase():F=I.name.substring(0,2).toUpperCase()}else F=D.userId.substring(0,2).toUpperCase();return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",padding:"var(--space-md)",background:G?"rgba(6, 182, 212, 0.1)":"var(--white)",border:`1px solid ${G?"rgba(6, 182, 212, 0.2)":"var(--gray-200)"}`,borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:`crew-avatar ${q?"captain":""}`,style:{width:"48px",height:"48px",fontSize:"1rem"},children:F}),s.jsxs("div",{style:{flex:1},children:[s.jsx("h5",{style:{margin:0,marginBottom:"var(--space-xs)"},children:O}),s.jsx("p",{style:{margin:0,color:"var(--gray-500)",fontSize:"0.875rem"},children:q?"Kapitn":"Posdka"})]}),q&&s.jsx("span",{className:"crew-badge",style:{padding:"var(--space-xs) var(--space-md)",background:"var(--turquoise)",color:"white",borderRadius:"var(--radius-full)",fontSize:"0.875rem"},children:"Kapitn"})]},D.id)}):s.jsx("p",{style:{color:"var(--gray-500)",textAlign:"center",padding:"var(--space-md)"},children:"Zatm nen piazena dn posdka."})})]})]}):s.jsx("div",{className:"card",children:s.jsx("p",{style:{color:"var(--gray-500)",textAlign:"center",padding:"var(--space-xl)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji."})})})}),k==="crew-list"&&s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Crew list"]})}),l?s.jsx(f2,{tripId:t,boatId:l.id,userId:e.uid,role:(i==null?void 0:i.role)||"participant",onSave:()=>{}}):s.jsx("div",{style:{padding:"var(--space-xl)",textAlign:"center"},children:s.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"var(--space-lg)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji, pot bude moci vyplnit crewlist."})})]}),k==="checklisty"&&!A&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Dostupn checklisty"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Tyto checklisty vm pidlil organiztor. Kliknutm je otevete a mete je vyplovat."}),l?w.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:w.map(D=>{var I,O;const q=((I=D.items)==null?void 0:I.filter(F=>F.completed).length)||0,G=((O=D.items)==null?void 0:O.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:F=>F.currentTarget.style.background="var(--gray-100)",onMouseLeave:F=>F.currentTarget.style.background="var(--gray-50)",onClick:()=>z(D.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:D.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:D.description||"Osobn checklist"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsxs("span",{className:`status-pill ${q===G&&G>0?"success":"warning"}`,style:{fontSize:"0.75rem"},children:[q,"/",G]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},D.id)})}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou piazeny dn checklisty pro tuto lo. Organiztor me piadit checklisty v nastaven."}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm ti nen piazena dn lo. Organiztor ti piad lo pozdji, pot budou dostupn checklisty."})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Tip"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Kliknutm na checklist ho otevete. Poloky mete oznaovat jako splnn a v postup se automaticky ukld."})]})})]}),k==="checklisty"&&A&&(()=>{var F,H,X;const D=w.find(te=>te.id===A);if(!D)return z(null),null;const q=((F=D.items)==null?void 0:F.filter(te=>te.completed).length)||0,G=((H=D.items)==null?void 0:H.length)||0,I={},O=[];return(X=D.items)==null||X.forEach((te,ae)=>{const pe=te.id||ae.toString(),oe=te.category||"";oe?(I[oe]||(I[oe]=[]),I[oe].push({...te,itemId:pe})):O.push({...te,itemId:pe})}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>z(null),style:{marginRight:"var(--space-sm)"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-check",style:{color:"var(--turquoise)"}}),D.name||"Checklist"]})]}),s.jsxs("span",{className:`status-pill ${q===G&&G>0?"success":"warning"}`,children:[q,"/",G]})]}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[D.description&&s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:D.description}),D.items&&D.items.length>0?s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:[Object.keys(I).map(te=>s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-sm)",paddingBottom:"var(--space-xs)",borderBottom:"1px solid var(--gray-200)"},children:te}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:I[te].map(ae=>{const pe=ae.inputType||"checkbox",oe=ae.allowNote||!1,De=ae.completed||!1,Te=ae.value!==void 0?ae.value:De?!0:"";return s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)",padding:"var(--space-sm)",background:De&&pe==="checkbox"?"rgba(16, 185, 129, 0.1)":"var(--white)",borderRadius:"var(--radius-sm)",border:`1px solid ${De&&pe==="checkbox"?"var(--success)":"var(--gray-200)"}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[pe==="checkbox"?s.jsx("input",{type:"checkbox",checked:De,onChange:async()=>{const V=!De;x(J=>J.map(Z=>Z.id===D.id?{...Z,items:Z.items.map(le=>(le.id||le.itemId)===ae.itemId?{...le,completed:V}:le)}:Z)),await Fe.updateItem(D.id,ae.itemId,{completed:V})}}):null,s.jsx("span",{style:{flex:1,textDecoration:De&&pe==="checkbox"?"line-through":"none",opacity:De&&pe==="checkbox"?.7:1},children:ae.name||ae.text||"Poloka"}),pe==="number"&&s.jsx("input",{type:"number",className:"form-input",style:{width:"100px",fontSize:"0.875rem"},value:Te,onChange:async V=>{const J=V.target.value?parseFloat(V.target.value):null;x(Z=>Z.map(le=>le.id===D.id?{...le,items:le.items.map(de=>(de.id||de.itemId)===ae.itemId?{...de,value:J,completed:J!==null&&J!==""}:de)}:le)),await Fe.updateItem(D.id,ae.itemId,{value:J,completed:J!==null&&J!==""})},placeholder:"0"}),pe==="text"&&s.jsx("input",{type:"text",className:"form-input",style:{width:"200px",fontSize:"0.875rem"},value:Te||"",onChange:async V=>{const J=V.target.value;x(Z=>Z.map(le=>le.id===D.id?{...le,items:le.items.map(de=>(de.id||de.itemId)===ae.itemId?{...de,value:J,completed:J!==""}:de)}:le)),await Fe.updateItem(D.id,ae.itemId,{value:J,completed:J!==""})},placeholder:"Zadejte text..."})]}),oe&&s.jsx("div",{style:{marginTop:"var(--space-xs)"},children:s.jsx("input",{type:"text",className:"form-input",style:{width:"100%",fontSize:"0.875rem"},value:ae.note||"",onChange:async V=>{const J=V.target.value;x(Z=>Z.map(le=>le.id===D.id?{...le,items:le.items.map(de=>(de.id||de.itemId)===ae.itemId?{...de,note:J}:de)}:le)),await Fe.updateItem(D.id,ae.itemId,{note:J})},placeholder:"Poznmka (voliteln)..."})}),!oe&&ae.note&&s.jsxs("div",{className:"text-xs text-muted",style:{fontStyle:"italic",marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-sticky-note"})," ",ae.note]})]},ae.itemId)})})]},te)),O.length>0&&s.jsxs("div",{children:[Object.keys(I).length>0&&s.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--gray-700)",marginBottom:"var(--space-sm)",paddingBottom:"var(--space-xs)",borderBottom:"1px solid var(--gray-200)"},children:"Ostatn"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:O.map(te=>{const ae=te.inputType||"checkbox",pe=te.allowNote||!1,oe=te.completed||!1,De=te.value!==void 0?te.value:oe?!0:"";return s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)",padding:"var(--space-sm)",background:oe&&ae==="checkbox"?"rgba(16, 185, 129, 0.1)":"var(--white)",borderRadius:"var(--radius-sm)",border:`1px solid ${oe&&ae==="checkbox"?"var(--success)":"var(--gray-200)"}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[ae==="checkbox"?s.jsx("input",{type:"checkbox",checked:oe,onChange:async()=>{const Te=!oe;x(V=>V.map(J=>J.id===D.id?{...J,items:J.items.map(Z=>(Z.id||Z.itemId)===te.itemId?{...Z,completed:Te}:Z)}:J)),await Fe.updateItem(D.id,te.itemId,{completed:Te})}}):null,s.jsx("span",{style:{flex:1,textDecoration:oe&&ae==="checkbox"?"line-through":"none",opacity:oe&&ae==="checkbox"?.7:1},children:te.name||te.text||"Poloka"}),ae==="number"&&s.jsx("input",{type:"number",className:"form-input",style:{width:"100px",fontSize:"0.875rem"},value:De,onChange:async Te=>{const V=Te.target.value?parseFloat(Te.target.value):null;x(J=>J.map(Z=>Z.id===D.id?{...Z,items:Z.items.map(le=>(le.id||le.itemId)===te.itemId?{...le,value:V,completed:V!==null&&V!==""}:le)}:Z)),await Fe.updateItem(D.id,te.itemId,{value:V,completed:V!==null&&V!==""})},placeholder:"0"}),ae==="text"&&s.jsx("input",{type:"text",className:"form-input",style:{width:"200px",fontSize:"0.875rem"},value:De||"",onChange:async Te=>{const V=Te.target.value;x(J=>J.map(Z=>Z.id===D.id?{...Z,items:Z.items.map(le=>(le.id||le.itemId)===te.itemId?{...le,value:V,completed:V!==""}:le)}:Z)),await Fe.updateItem(D.id,te.itemId,{value:V,completed:V!==""})},placeholder:"Zadejte text..."})]}),pe&&s.jsx("div",{style:{marginTop:"var(--space-xs)"},children:s.jsx("input",{type:"text",className:"form-input",style:{width:"100%",fontSize:"0.875rem"},value:te.note||"",onChange:async Te=>{const V=Te.target.value;x(J=>J.map(Z=>Z.id===D.id?{...Z,items:Z.items.map(le=>(le.id||le.itemId)===te.itemId?{...le,note:V}:le)}:Z)),await Fe.updateItem(D.id,te.itemId,{note:V})},placeholder:"Poznmka (voliteln)..."})}),!pe&&te.note&&s.jsxs("div",{className:"text-xs text-muted",style:{fontStyle:"italic",marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-sticky-note"})," ",te.note]})]},te.itemId)})})]})]}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Tento checklist neobsahuje dn poloky."})]})]})})()]})})]})}function g2(){const{tripId:t}=ir(),e=_t(),{user:n}=yt(),[r,a]=C.useState(null),[i,o]=C.useState([]),[l,u]=C.useState([]),[d,h]=C.useState(null),[f,m]=C.useState(!0),[_,E]=C.useState(!1),[w,x]=C.useState(!1);C.useEffect(()=>{t&&v()},[t]);const v=async()=>{m(!0);try{const[k,b]=await Promise.all([pt.getTrip(t),Jt.getTripBoats(t)]);if(k.data){const{password:z,...T}=k.data;if(a(T),T.organizerId){const{data:$}=await Fo.getContactDetails(T.organizerId);$&&h($)}}b&&b.boats?o(b.boats):b&&b.error?(console.error("Error loading boats:",b.error),o([])):o([]);const A=await Je.getTripParticipants(t);A?A.participants&&Array.isArray(A.participants)?u(A.participants):A.error?(console.error("Error loading participants:",A.error),u([])):u([]):u([])}catch(k){console.error("Error loading trip data:",k),o([]),u([])}finally{m(!1)}},j=k=>k?k.toDate?k.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):k.seconds?new Date(k.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",S=(k,b)=>{if(!k||!b)return"Neuvedeno";const A=j(k),z=j(b);return`${A}  ${z}`},R=k=>{if(!k)return"";try{let b;return k.toDate?b=k.toDate():k.seconds?b=new Date(k.seconds*1e3):typeof k=="string"?b=new Date(k):b=new Date(k),isNaN(b.getTime())?"":b.toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},L=()=>{const k=i.reduce((A,z)=>A+(z.capacity||0),0),b=l.length;return Math.max(0,k-b)},U=k=>{if(!k)return null;const z=(k.toDate?k.toDate():new Date(k.seconds*1e3))-new Date,T=Math.ceil(z/(1e3*60*60*24));return T>0?T:null};if(f)return s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})});if(!r)return s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Plavba nenalezena"}),s.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"var(--space-lg)"},children:"Plavba s tmto ID neexistuje nebo nen veejn dostupn."}),s.jsx(ie,{to:"/",className:"btn btn-primary",children:"Zpt na hlavn strnku"})]})});const N=L(),y=U(r.startDate);return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"header",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"header-inner",children:[s.jsxs(ie,{to:"/",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsxs("div",{className:"header-actions",children:[s.jsx(ie,{to:"/login",className:"btn btn-ghost",children:"Pihlsit se"}),s.jsx(ie,{to:"/register",className:"btn btn-primary",children:"Registrace"})]})]})})}),s.jsxs("div",{className:"trip-header",style:r.bannerImageUrl?{backgroundImage:`url(${r.bannerImageUrl})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"}:{},children:[r.bannerImageUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.8), rgba(10, 22, 40, 0.6))"}}),s.jsx("div",{className:"container",style:{position:"relative",zIndex:1},children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"trip-title-row",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",children:r.name||"Bez nzvu"}),s.jsxs("span",{className:"role-badge",style:{background:N>0?"linear-gradient(135deg, var(--success), #059669)":"var(--gray-500)"},children:[s.jsx("i",{className:"fas fa-door-open"}),N>0?`Voln msta: ${N}`:"Plno"]})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{style:{fontSize:"0.875rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"4px"},children:"Organizuje"}),s.jsx("div",{style:{fontWeight:600,color:"var(--white)"},children:"Organiztor"})]})]}),s.jsxs("div",{className:"trip-header-meta",style:{justifyContent:"space-between",alignItems:"flex-end"},children:[s.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"var(--space-lg)"},children:[s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-calendar"}),s.jsx("span",{children:S(r.startDate,r.endDate)})]}),(r.locationName||r.startLocation)&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-map-marker-alt"}),s.jsx("span",{children:r.locationName||r.startLocation})]}),y!==null&&s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-clock"}),s.jsx("span",{children:y===0?"Zan dnes":y===1?"Zan ztra":`${y} dn do startu`})]}),s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-ship"}),s.jsxs("span",{children:[i.length," ",i.length===1?"lo":i.length<5?"lod":"lod"]})]}),s.jsxs("div",{className:"trip-header-meta-item",children:[s.jsx("i",{className:"fas fa-users"}),s.jsx("span",{children:l.length>0?`${l.length} ${l.length===1?"astnk":l.length<5?"astnci":"astnk"}`:"Zatm dn astnci"})]})]}),s.jsxs("button",{className:"btn btn-lg",onClick:()=>{n?x(!0):e(`/onboarding?mode=join-trip&tripId=${t}`)},style:{flexShrink:0,background:"linear-gradient(135deg, var(--coral), #ea580c)",color:"white",boxShadow:"0 4px 14px rgba(251, 113, 133, 0.4)"},children:[s.jsx("i",{className:"fas fa-plus-circle"}),"Chci se pidat"]})]})]})})]}),s.jsx("main",{className:"trip-content",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-layout",children:[s.jsxs("div",{className:"main-content",children:[s.jsx(Ku,{trip:r,viewType:"public",onShowMore:()=>E(!0)}),s.jsx(Gu,{trip:r}),s.jsxs("div",{className:"card animate-in delay-2",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)"}}),"Lod"]})}),i.length>0?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"var(--space-lg)"},children:i.map(k=>{const A=n&&l.length>0?l.filter(z=>z.boatId===k.id):[];return s.jsx(Im,{boat:k,participantCount:A.length,showDetails:!0,viewType:"public"},k.id)})}):s.jsx("p",{style:{color:"var(--gray-500)",textAlign:"center",padding:"var(--space-xl)"},children:"Zatm nejsou pidny dn lod."})]})]}),s.jsxs("aside",{children:[s.jsxs("div",{className:"sidebar-card animate-in delay-1",style:{marginBottom:"var(--space-lg)"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Zkladn info"]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:[r.price&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"var(--space-md)"},children:[s.jsx("span",{className:"text-muted",style:{flexShrink:0},children:"Cena"}),s.jsx("span",{className:"font-semibold",style:{textAlign:"right",wordBreak:"break-word"},children:r.price})]}),r.startDate&&r.endDate&&(()=>{const k=r.startDate.toDate?r.startDate.toDate():new Date(r.startDate.seconds*1e3),b=r.endDate.toDate?r.endDate.toDate():new Date(r.endDate.seconds*1e3),A=Math.ceil((b-k)/(1e3*60*60*24));return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"var(--space-md)"},children:[s.jsx("span",{className:"text-muted",style:{flexShrink:0},children:"Dlka plavby"}),s.jsxs("span",{className:"font-semibold",style:{textAlign:"right",wordBreak:"break-word"},children:[A," ",A===1?"den":A<5?"dny":"dn"]})]})})(),r.checkInDateTime&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"var(--space-md)"},children:[s.jsx("span",{className:"text-muted",style:{flexShrink:0},children:"Check-in"}),s.jsx("span",{className:"font-semibold",style:{textAlign:"right",wordBreak:"break-word"},children:R(r.checkInDateTime)})]})]})]}),d&&s.jsx(Pm,{contacts:[{...d,role:"organizer"}]})]})]})})}),s.jsx("footer",{style:{background:"var(--ocean-deep)",color:"white",padding:"var(--space-xl) 0",textAlign:"center"},children:s.jsxs("div",{className:"container",children:[s.jsxs(ie,{to:"/",className:"logo",style:{justifyContent:"center",color:"white",marginBottom:"var(--space-md)"},children:[s.jsx("div",{className:"logo-icon",style:{background:"rgba(255,255,255,0.1)"},children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsx("p",{style:{opacity:.6,fontSize:"0.875rem"},children:" 2025 SailPlan. Vechna prva vyhrazena."})]})}),_&&s.jsx("div",{className:"modal-overlay active",onClick:()=>E(!1),children:s.jsxs("div",{className:"modal",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h4",{children:"Informace o plavb"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>E(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"modal-body",children:s.jsx("div",{style:{color:"var(--gray-600)",lineHeight:1.8},children:r.descriptionForParticipants?s.jsx("p",{style:{marginBottom:"var(--space-md)",whiteSpace:"pre-wrap"},children:r.descriptionForParticipants}):s.jsx("p",{style:{marginBottom:"var(--space-md)",color:"var(--gray-400)"},children:"Zatm nen pidn popis plavby."})})}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn btn-ghost",onClick:()=>E(!1),children:"Zavt"}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{E(!1),n?x(!0):e(`/onboarding?mode=join-trip&tripId=${t}`)},children:[s.jsx("i",{className:"fas fa-plus-circle"}),"Chci se pidat"]})]})]})}),w&&s.jsx(km,{tripId:t,onClose:()=>x(!1),onSuccess:()=>{x(!1),e("/login")}})]})}function v2(){const{user:t}=yt(),e=_t(),[n,r]=C.useState("checklists"),[a,i]=C.useState([]),[o,l]=C.useState([]),[u,d]=C.useState(!0),[h,f]=C.useState(!1),[m,_]=C.useState(!1),[E,w]=C.useState(null),[x,v]=C.useState(null),[j,S]=C.useState({name:"",email:"",phone:"",address:""}),[R,L]=C.useState(!1);C.useEffect(()=>{t&&(n==="contacts"?N():U())},[t,n]);const U=async()=>{if(d(!0),n==="checklists"){const{templates:$,error:Q}=await Fe.getTemplates(t.uid);Q||i($)}else{const{templates:$,error:Q}=await nu.getTemplates(t.uid);Q||l($)}d(!1)},N=async()=>{d(!0);const{data:$,error:Q}=await Fo.getContactDetails(t.uid);!Q&&$&&S({name:$.name||"",email:$.email||"",phone:$.phone||"",address:$.address||""}),d(!1)},y=async $=>{$.preventDefault(),L(!0);const{error:Q}=await Fo.saveContactDetails(t.uid,j);alert(Q?"Chyba pi ukldn: "+Q:"Kontaktn daje byly uloeny."),L(!1)},k=async $=>{if(confirm("Opravdu chcete smazat tento checklist?")){const{error:Q}=await Fe.deleteTemplate($);Q||await U()}},b=$=>{const Q={name:$.name,description:$.description,categories:$.categories||[],items:($.items||[]).map(D=>({id:D.id,text:D.text||D.name,name:D.name||D.text,category:D.category||"",inputType:D.inputType||"checkbox",allowNote:D.allowNote||!1}))},B=new Blob([JSON.stringify(Q,null,2)],{type:"application/json"}),ee=URL.createObjectURL(B),W=document.createElement("a");W.href=ee,W.download=`${$.name||"checklist"}.json`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ee)},A=()=>{const $=document.createElement("input");$.type="file",$.accept=".json",$.onchange=async Q=>{const B=Q.target.files[0];if(B)try{const ee=await B.text(),W=JSON.parse(ee);if(!W.name||!Array.isArray(W.items)){alert("Neplatn formt souboru. Checklist mus obsahovat nzev a pole poloek.");return}const{id:D,error:q}=await Fe.createTemplate(t.uid,{name:W.name,description:W.description||"",categories:W.categories||[],items:W.items.map((G,I)=>({id:G.id||Date.now().toString()+I,text:G.text||G.name||"",name:G.name||G.text||"",category:G.category||"",inputType:G.inputType||"checkbox",allowNote:G.allowNote||!1}))});q?alert("Chyba pi importu: "+q):(alert("Checklist byl spn importovn."),await U())}catch(ee){alert("Chyba pi natn souboru: "+ee.message)}},$.click()},z=async $=>{if(confirm("Opravdu chcete smazat tento templt?")){const{error:Q}=await nu.deleteTemplate($);Q||await U()}},T=$=>{e(`/trip/new?template=${$}`)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"trip-header",style:{padding:"var(--space-xl) 0"},children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:"Nastaven organiztora"})]}),s.jsx("div",{className:"trip-title-row",style:{marginTop:"var(--space-lg)"},children:s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",style:{fontSize:"2rem"},children:"Nastaven organiztora"}),s.jsx("p",{style:{color:"var(--gray-400)",marginTop:"var(--space-sm)"},children:"Sprva checklist a templat plaveb"})]})})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",style:{maxWidth:1e3},children:[s.jsxs("div",{className:"settings-nav",children:[s.jsxs("button",{className:`settings-nav-item ${n==="checklists"?"active":""}`,onClick:()=>r("checklists"),children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{marginRight:"var(--space-sm)"}}),"Checklisty"]}),s.jsxs("button",{className:`settings-nav-item ${n==="templates"?"active":""}`,onClick:()=>r("templates"),children:[s.jsx("i",{className:"fas fa-copy",style:{marginRight:"var(--space-sm)"}}),"Templaty plaveb"]}),s.jsxs("button",{className:`settings-nav-item ${n==="contacts"?"active":""}`,onClick:()=>r("contacts"),children:[s.jsx("i",{className:"fas fa-address-card",style:{marginRight:"var(--space-sm)"}}),"Kontaktn daje"]})]}),n==="checklists"&&s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Moje checklisty"]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:A,title:"Importovat checklist z JSON",children:[s.jsx("i",{className:"fas fa-upload"}),"Import"]}),s.jsxs(ie,{to:"/checklist/new",className:"btn btn-primary",children:[s.jsx("i",{className:"fas fa-plus"}),"Nov checklist"]})]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:"Vytvote si vlastn checklisty pro rzn ely  pedn lod, vracen lod, balen pro posdku a dal. Checklisty pak mete piadit k jednotlivm plavbm."}),u?s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Natn..."}):a.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:a.map($=>{var ee,W;const Q=((ee=$.items)==null?void 0:ee.length)||0,B=new Set((W=$.items)==null?void 0:W.map(D=>D.category).filter(Boolean)).size;return s.jsxs("div",{className:"checklist-template-card",children:[s.jsxs("div",{className:"checklist-template-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:48,height:48,background:"rgba(249, 115, 22, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--coral)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",style:{fontSize:"1.125rem"},children:$.name||"Bez nzvu"}),s.jsxs("div",{className:"text-sm text-muted",children:[Q," poloek  ",B," kategori"]})]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>b($),title:"Exportovat checklist",children:s.jsx("i",{className:"fas fa-download"})}),s.jsxs(ie,{to:`/checklist/${$.id}/edit`,className:"btn btn-sm btn-secondary",children:[s.jsx("i",{className:"fas fa-edit"})," Upravit"]}),s.jsx("button",{className:"btn btn-sm btn-ghost",style:{color:"var(--danger)"},onClick:()=>k($.id),children:s.jsx("i",{className:"fas fa-trash"})})]})]}),$.categories&&$.categories.length>0&&s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:$.categories.map((D,q)=>s.jsx("span",{className:"status-pill info",style:{fontSize:"0.6875rem"},children:D},q))})]},$.id)})}):s.jsxs("div",{className:"empty-state",children:[s.jsx("i",{className:"fas fa-clipboard-list"}),s.jsx("p",{children:"Zatm nemte dn checklisty. Vytvote prvn checklist."})]})]}),n==="contacts"&&s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-address-card",style:{color:"var(--coral)"}}),"Kontaktn daje organiztora"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:'Tyto kontaktn daje budou zobrazeny astnkm plaveb, kter organizujete. Jsou oddlen od vaich uivatelskch kontaktnch daj (ty se nastavuj v "Mj profil").'}),u?s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Natn..."}):s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Jmno"}),s.jsx("input",{type:"text",className:"form-input",value:j.name,onChange:$=>S(Q=>({...Q,name:$.target.value})),placeholder:"nap. Jan Novk"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Email"}),s.jsx("input",{type:"email",className:"form-input",value:j.email,onChange:$=>S(Q=>({...Q,email:$.target.value})),placeholder:"nap. jan@example.com"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Telefon"}),s.jsx("input",{type:"tel",className:"form-input",value:j.phone,onChange:$=>S(Q=>({...Q,phone:$.target.value})),placeholder:"nap. +420 123 456 789"})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Adresa (voliteln)"}),s.jsx("textarea",{className:"form-input",rows:3,value:j.address,onChange:$=>S(Q=>({...Q,address:$.target.value})),placeholder:"Adresa pro korespondenci..."})]})]}),s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"var(--space-xl)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--gray-100)"},children:s.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:R,children:[s.jsx("i",{className:"fas fa-save"}),R?"Ukldn...":"Uloit kontaktn daje"]})})]})]}),n==="templates"&&s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-copy",style:{color:"var(--coral)"}}),"Templaty plaveb"]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{v(null),_(!0)},children:[s.jsx("i",{className:"fas fa-plus"}),"Nov templt"]})]}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-xl)"},children:"Ulote si oblben nastaven plaveb jako templaty a pouvejte je pro rychl vytvoen novch plaveb."}),u?s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Natn..."}):o.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:o.map($=>{var W,D;const Q=(W=$.startDate)!=null&&W.toDate?$.startDate.toDate():null,B=(D=$.endDate)!=null&&D.toDate?$.endDate.toDate():null,ee=Q&&B?Math.ceil((B-Q)/(1e3*60*60*24)):null;return s.jsxs("div",{className:"trip-template-card",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:48,height:48,background:"linear-gradient(135deg, var(--coral), var(--coral-light))",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-sailboat"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",style:{fontSize:"1.125rem"},children:$.name||"Bez nzvu"}),s.jsxs("div",{className:"text-sm text-muted",children:[$.location||"Lokace neuvedena",ee&&`  ${ee} dn`]})]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>T($.id),children:[s.jsx("i",{className:"fas fa-plus"})," Pout"]}),s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>{v($),_(!0)},children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{className:"btn btn-sm btn-ghost",style:{color:"var(--danger)"},onClick:()=>z($.id),children:s.jsx("i",{className:"fas fa-trash"})})]})]},$.id)})}):s.jsxs("div",{className:"empty-state",children:[s.jsx("i",{className:"fas fa-copy"}),s.jsx("p",{children:"Zatm nemte dn templaty. Vytvote prvn templt z existujc plavby."})]})]})]})}),h&&s.jsx("div",{className:"modal-overlay active",onClick:()=>{f(!1),w(null)},children:s.jsx(y2,{checklist:E,onClose:()=>{f(!1),w(null)},onSave:U,userId:t.uid})}),m&&s.jsx(x2,{template:x,onClose:()=>{_(!1),v(null)},onSave:U,userId:t.uid})]})}function y2({checklist:t,onClose:e,onSave:n,userId:r}){const[a,i]=C.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",categories:(t==null?void 0:t.categories)||[],items:(t==null?void 0:t.items)||[]}),[o,l]=C.useState(!1),[u,d]=C.useState(null),[h,f]=C.useState(""),[m,_]=C.useState({text:"",category:""}),[E,w]=C.useState(""),[x,v]=C.useState(""),j=async N=>{if(N.preventDefault(),l(!0),d(null),!a.name.trim()){d("Nzev checklistu je povinn"),l(!1);return}let y;if(t){if(y=await Fe.updateTemplate(t.id,a),!y.error){const k=await Fe.syncInstancesFromTemplate(t.id);k.error&&console.error("Chyba pi synchronizaci instanc:",k.error)}}else y=await Fe.createTemplate(r,a);y.error?d(y.error):(n(),e()),l(!1)},S=()=>{h.trim()&&!a.categories.includes(h.trim())&&(i(N=>({...N,categories:[...N.categories,h.trim()]})),f(""))},R=N=>{i(y=>({...y,categories:y.categories.filter(k=>k!==N),items:y.items.map(k=>k.category===N?{...k,category:""}:k)}))},L=()=>{m.text.trim()&&(i(N=>({...N,items:[...N.items,{id:Date.now().toString(),text:m.text.trim(),category:m.category||"",required:!1}]})),_({text:"",category:""}))},U=N=>{i(y=>({...y,items:y.items.filter(k=>k.id!==N)}))};return s.jsxs("div",{className:"modal",onClick:N=>N.stopPropagation(),style:{background:"var(--white)",borderRadius:"var(--radius-xl)",boxShadow:"var(--shadow-xl)",maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("div",{className:"modal-header",style:{padding:"var(--space-xl)",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-plus",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),t?"Upravit checklist":"Nov checklist"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{onSubmit:j,children:[s.jsxs("div",{className:"modal-body",style:{padding:"var(--space-xl)",maxHeight:"60vh",overflowY:"auto"},children:[u&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:u}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Nzev checklistu *"}),s.jsx("input",{type:"text",className:"form-input",value:a.name,onChange:N=>i(y=>({...y,name:N.target.value})),placeholder:"nap. Pedn lod",required:!0})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Popis (voliteln)"}),s.jsx("textarea",{className:"form-input",rows:2,value:a.description,onChange:N=>i(y=>({...y,description:N.target.value})),placeholder:"Strun popis checklistu..."})]}),s.jsxs("div",{style:{borderTop:"1px solid var(--gray-100)",paddingTop:"var(--space-lg)",marginTop:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-md)"},children:[s.jsx("h5",{children:"Kategorie"}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",style:{width:200},value:h,onChange:N=>f(N.target.value),onKeyPress:N=>N.key==="Enter"&&(N.preventDefault(),S()),placeholder:"Nzev kategorie"}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:S,children:[s.jsx("i",{className:"fas fa-plus"})," Pidat"]})]})]}),a.categories.length>0&&s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap",marginBottom:"var(--space-md)"},children:a.categories.map(N=>s.jsxs("span",{className:"status-pill info",style:{fontSize:"0.875rem"},children:[N,s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost",style:{marginLeft:"var(--space-xs)",padding:0,fontSize:"0.75rem"},onClick:()=>R(N),children:s.jsx("i",{className:"fas fa-times"})})]},N))}),s.jsxs("div",{style:{marginTop:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-md)"},children:[s.jsx("h5",{children:"Poloky"}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[s.jsx("input",{type:"text",className:"form-input",style:{width:200},value:m.text,onChange:N=>_(y=>({...y,text:N.target.value})),onKeyPress:N=>N.key==="Enter"&&(N.preventDefault(),L()),placeholder:"Nzev poloky"}),a.categories.length>0&&s.jsxs("select",{className:"form-input",style:{width:150},value:m.category,onChange:N=>_(y=>({...y,category:N.target.value})),children:[s.jsx("option",{value:"",children:"Bez kategorie"}),a.categories.map(N=>s.jsx("option",{value:N,children:N},N))]}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:L,children:[s.jsx("i",{className:"fas fa-plus"})," Pidat"]})]})]}),a.items.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginBottom:"var(--space-md)"},children:[s.jsx("input",{type:"text",className:"form-input",style:{flex:1},value:E,onChange:N=>w(N.target.value),placeholder:"Vyhledat poloku..."}),a.categories.length>0&&s.jsxs("select",{className:"form-input",style:{width:200},value:x,onChange:N=>v(N.target.value),children:[s.jsx("option",{value:"",children:"Vechny kategorie"}),a.categories.map(N=>s.jsx("option",{value:N,children:N},N))]})]}),s.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",padding:"var(--space-sm)"},children:(()=>{const N=a.items.filter(y=>{const k=!E||y.text.toLowerCase().includes(E.toLowerCase()),b=!x||y.category===x;return k&&b});return N.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:N.map(y=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)",padding:"var(--space-sm)",background:"var(--gray-50)",borderRadius:"var(--radius-sm)",transition:"background 0.2s"},onMouseEnter:k=>k.currentTarget.style.background="var(--gray-100)",onMouseLeave:k=>k.currentTarget.style.background="var(--gray-50)",children:[s.jsx("span",{style:{flex:1,fontSize:"0.875rem"},children:y.text}),y.category&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.75rem"},children:y.category}),s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost btn-sm",style:{color:"var(--danger)"},onClick:()=>U(y.id),title:"Odstranit poloku",children:s.jsx("i",{className:"fas fa-times"})})]},y.id))}):s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem",textAlign:"center",padding:"var(--space-md)"},children:E||x?"dn poloky neodpovdaj filtru":"Zatm nejsou dn poloky"})})()}),s.jsxs("div",{style:{marginTop:"var(--space-sm)",fontSize:"0.875rem",color:"var(--gray-500)"},children:["Celkem: ",a.items.length," poloek",(E||x)&&` (zobrazeno: ${a.items.filter(N=>{const y=!E||N.text.toLowerCase().includes(E.toLowerCase()),k=!x||N.category===x;return y&&k}).length})`]})]}):s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem"},children:"Zatm nejsou dn poloky"})]})]})]}),s.jsxs("div",{className:"modal-footer",style:{padding:"var(--space-lg) var(--space-xl)",borderTop:"1px solid var(--gray-100)",display:"flex",justifyContent:"flex-end",gap:"var(--space-sm)"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:e,children:"Zruit"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Ukldn...":t?"Uloit zmny":"Vytvoit"})]})]})]})}function x2({template:t,onClose:e,onSave:n,userId:r}){const[a,i]=C.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||""}),[o,l]=C.useState(!1),[u,d]=C.useState(null),h=async f=>{if(f.preventDefault(),l(!0),d(null),!a.name.trim()){d("Nzev templatu je povinn"),l(!1);return}let m;if(t)m=await nu.updateTemplate(t.id,a);else{e(),window.location.href="/trip/new?createTemplate=true&templateName="+encodeURIComponent(a.name);return}m.error?d(m.error):(n(),e()),l(!1)};return s.jsx("div",{className:"modal-overlay",onClick:e,style:{position:"fixed",inset:0,background:"rgba(10, 22, 40, 0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:s.jsxs("div",{className:"modal",onClick:f=>f.stopPropagation(),style:{background:"var(--white)",borderRadius:"var(--radius-xl)",boxShadow:"var(--shadow-xl)",maxWidth:500,width:"90%",maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("div",{className:"modal-header",style:{padding:"var(--space-xl)",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-plus",style:{color:"var(--coral)",marginRight:"var(--space-sm)"}}),t?"Upravit templt":"Nov templt plavby"]}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:e,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{onSubmit:h,children:[s.jsxs("div",{className:"modal-body",style:{padding:"var(--space-xl)"},children:[u&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:u}),!t&&s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Vytvote nov templt vyplnnm formule plavby. Templt si pak budete moci pout pro rychl vytvoen novch plaveb."}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Nzev templatu *"}),s.jsx("input",{type:"text",className:"form-input",value:a.name,onChange:f=>i(m=>({...m,name:f.target.value})),placeholder:"nap. Chorvatsko 2025",required:!0})]}),t&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Popis"}),s.jsx("textarea",{className:"form-input",rows:3,value:a.description,onChange:f=>i(m=>({...m,description:f.target.value})),placeholder:"Popis templatu..."})]})]}),s.jsxs("div",{className:"modal-footer",style:{padding:"var(--space-lg) var(--space-xl)",borderTop:"1px solid var(--gray-100)",display:"flex",justifyContent:"flex-end",gap:"var(--space-sm)"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:e,children:"Zruit"}),t?s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Ukldn...":"Uloit zmny"}):s.jsxs(ie,{to:"/trip/new",className:"btn btn-primary",onClick:f=>{a.name.trim()||(f.preventDefault(),alert("Nejprve zadejte nzev templatu"))},children:[s.jsx("i",{className:"fas fa-arrow-right"}),"Pokraovat na formul"]})]})]})]})})}function w2(){const{tripId:t,boatId:e}=ir();_t();const{user:n}=yt(),[r,a]=C.useState(null),[i,o]=C.useState(null),[l,u]=C.useState([]),[d,h]=C.useState(new Map),[f,m]=C.useState([]),[_,E]=C.useState(!0),[w,x]=C.useState("posadka"),[v,j]=C.useState(null);C.useEffect(()=>{t&&e&&n&&S()},[t,e,n]),C.useEffect(()=>{window.location.hash==="#crew-list"&&x("crew-list")},[]),C.useEffect(()=>{const b=()=>{window.location.hash==="#crew-list"&&x("crew-list")};return window.addEventListener("hashchange",b),()=>window.removeEventListener("hashchange",b)},[]);const S=async()=>{E(!0);const[b,A,z]=await Promise.all([pt.getTrip(t),Jt.getBoat(e),Je.getBoatParticipants(t,e)]),{instances:T}=await Fe.getTripInstances(t,{boatId:e});if(T&&m(T),b.data&&a(b.data),A.data&&o(A.data),z.participants){u(z.participants);const $=z.participants.map(Q=>Q.userId);if($.length>0){const Q=await pi($);h(Q)}}E(!1)},R=l.find(b=>b.userId===(n==null?void 0:n.uid)),L=XD(r,i,R,n==null?void 0:n.uid),U=e2(r,i,R,n==null?void 0:n.uid),N=t2(r,i,R,n==null?void 0:n.uid),k=rr(r,n==null?void 0:n.uid)?"organizer":(R==null?void 0:R.role)==="captain"&&(R==null?void 0:R.boatId)===(i==null?void 0:i.id)?"captain":"participant";return _?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):!i||!r?s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Lo nenalezena"}),s.jsx(ie,{to:`/trip/${t}/organizer`,className:"btn btn-primary",children:"Zpt na plavbu"})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"boat-hero",style:i.thumbnailUrl?{backgroundImage:`url(${i.thumbnailUrl})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"}:{},children:[i.thumbnailUrl&&s.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(135deg, rgba(10, 22, 40, 0.8), rgba(10, 22, 40, 0.6))"}}),s.jsxs("div",{className:"container",style:{position:"relative",zIndex:1},children:[s.jsxs("div",{className:"breadcrumb",style:{color:"rgba(255,255,255,0.7)",marginBottom:"var(--space-lg)"},children:[s.jsx(ie,{to:"/dashboard",style:{color:"inherit"},children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:`/trip/${t}/organizer`,style:{color:"inherit"},children:r.name||"Plavba"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{style:{color:"white"},children:i.name||"Bez nzvu"})]}),s.jsxs("div",{className:"boat-hero-content",children:[s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"2rem",fontWeight:700,marginBottom:"var(--space-xs)",color:"white"},children:i.model||"Model neuveden"}),s.jsx("p",{style:{fontSize:"1.25rem",opacity:.9,color:"white"},children:i.name||"Bez nzvu"}),i.charterLink&&s.jsxs("a",{href:i.charterLink,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",style:{marginTop:"var(--space-sm)",background:"rgba(255,255,255,0.2)",color:"white",backdropFilter:"blur(10px)",borderColor:"rgba(255,255,255,0.3)"},children:[s.jsx("i",{className:"fas fa-external-link-alt"}),"Detail lodi"]})]}),s.jsxs(ie,{to:`/trip/${t}/organizer`,className:"btn",style:{background:"rgba(255,255,255,0.2)",color:"white",backdropFilter:"blur(10px)"},children:[s.jsx("i",{className:"fas fa-arrow-left"}),"Zpt na plavbu"]})]}),s.jsxs("div",{className:"boat-specs",children:[i.length&&s.jsxs("div",{className:"boat-spec",children:[s.jsx("div",{className:"boat-spec-value",children:i.length}),s.jsx("div",{className:"boat-spec-label",children:"Dlka"})]}),i.year&&s.jsxs("div",{className:"boat-spec",children:[s.jsx("div",{className:"boat-spec-value",children:i.year}),s.jsx("div",{className:"boat-spec-label",children:"Rok vroby"})]}),i.cabins&&s.jsxs("div",{className:"boat-spec",children:[s.jsx("div",{className:"boat-spec-value",children:i.cabins}),s.jsx("div",{className:"boat-spec-label",children:"Kajuty"})]}),s.jsxs("div",{className:"boat-spec",children:[s.jsxs("div",{className:"boat-spec-value",children:[l.length,i.capacity?`/${i.capacity}`:""]}),s.jsx("div",{className:"boat-spec-label",children:"Obsazenost"})]})]})]})]}),s.jsx("div",{className:"trip-tabs",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-tabs-inner",children:[s.jsxs("button",{className:`trip-tab ${w==="posadka"?"active":""}`,onClick:()=>x("posadka"),children:[s.jsx("i",{className:"fas fa-users"}),"Posdka"]}),s.jsxs("button",{className:`trip-tab ${w==="crew-list"?"active":""}`,onClick:()=>x("crew-list"),children:[s.jsx("i",{className:"fas fa-clipboard-list"}),"Crew list"]}),s.jsxs("button",{className:`trip-tab ${w==="checklisty"?"active":""}`,onClick:()=>x("checklisty"),children:[s.jsx("i",{className:"fas fa-tasks"}),"Checklisty"]}),s.jsxs("button",{className:`trip-tab ${w==="lodni-denik"?"active":""}`,onClick:()=>x("lodni-denik"),children:[s.jsx("i",{className:"fas fa-book"}),"Lodn denk"]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",children:[w==="posadka"&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-users",style:{color:"var(--turquoise)"}}),"Posdka (",l.length,i.capacity?`/${i.capacity}`:"",")"]}),L&&s.jsxs(ie,{to:`/trip/${t}/organizer`,className:"btn btn-sm btn-primary",children:[s.jsx("i",{className:"fas fa-user-plus"}),"Spravovat posdku"]})]}),s.jsx("div",{className:"crew-list",children:l.map(b=>{const A=b.role==="captain";return s.jsxs("div",{className:"crew-member",style:A?{background:"rgba(6, 182, 212, 0.1)",border:"1px solid rgba(6, 182, 212, 0.2)"}:{},children:[s.jsx("div",{className:`crew-avatar ${A?"captain":""}`,children:(()=>{const z=d.get(b.userId);if(z!=null&&z.name){const T=z.name.trim().split(/\s+/);return T.length>=2?(T[0][0]+T[T.length-1][0]).toUpperCase():z.name.substring(0,2).toUpperCase()}return b.userId.substring(0,2).toUpperCase()})()}),s.jsxs("div",{className:"crew-info",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)"},children:[s.jsx("h5",{children:(()=>{const z=d.get(b.userId);return(z==null?void 0:z.name)||"Neznm uivatel"})()}),b.userId===(n==null?void 0:n.uid)&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.7rem",padding:"2px 6px"},children:"J"})]}),s.jsx("p",{className:"text-muted",children:"astnk plavby"})]}),A&&s.jsx("span",{className:"crew-badge",children:"Kapitn"})]},b.id)})})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-chart-pie",style:{color:"var(--turquoise)"}}),"Stav posdky"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{className:"text-muted",children:"Obsazenost"}),s.jsxs("span",{className:"font-semibold",children:[l.length,i.capacity?`/${i.capacity}`:""]})]})})]})})]}),w==="crew-list"&&s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Crew list  ",i.name||"Bez nzvu"]})}),s.jsx(kN,{tripId:t,boatId:e,canEdit:L,userId:n.uid,viewContext:k,trip:r})]}),w==="checklisty"&&!v&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-tasks",style:{color:"var(--turquoise)"}}),"Systmov checklisty"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Checklisty piazen tto lodi. Kliknutm je otevete a upravte."}),f.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:f.map(b=>{var T,$;const A=((T=b.items)==null?void 0:T.filter(Q=>Q.completed).length)||0,z=(($=b.items)==null?void 0:$.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:Q=>Q.currentTarget.style.background="var(--gray-100)",onMouseLeave:Q=>Q.currentTarget.style.background="var(--gray-50)",onClick:()=>j(b.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:b.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:b.description||"Checklist lod"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-lg)"},children:[s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{className:"text-sm text-muted",children:"Vyplnno"}),s.jsxs("div",{className:"font-medium",children:[A,"/",z," poloek"]})]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},b.id)})}):s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou piazeny dn checklisty pro tuto lo. Organiztor me piadit checklisty v nastaven."})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"O checklistech"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Systmov checklisty se definuj v Nastaven organiztora a piazuj se k jednotlivm lodm nebo rolm."})]})})]}),w==="checklisty"&&v&&(()=>{var Q,B;const b=f.find(ee=>ee.id===v);if(!b)return j(null),null;const A=((Q=b.items)==null?void 0:Q.filter(ee=>ee.completed).length)||0,z=((B=b.items)==null?void 0:B.length)||0,T=_N(r,b,i,R,n==null?void 0:n.uid),$=ee=>{m(W=>W.map(D=>D.id===ee.id?ee:D))};return s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>j(null),style:{marginRight:"var(--space-sm)"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-check",style:{color:"var(--turquoise)"}}),b.name||"Checklist"]})]}),s.jsxs("span",{className:`status-pill ${A===z&&z>0?"success":"warning"}`,children:[A,"/",z]})]}),s.jsx("div",{style:{padding:"var(--space-xl)"},children:s.jsx(Hu,{instance:b,onUpdate:$,canEdit:T,viewContext:k})})]})})})(),w==="lodni-denik"&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsx("div",{className:"card animate-in",children:i&&N?s.jsx(su,{tripId:t,boatId:e,boatName:i.name||"Bez nzvu",canEdit:U,canView:N,showStats:!1}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:"Lo nenalezena nebo nemte oprvnn k zobrazen lodnho denku."})})}),s.jsx("aside",{children:i&&N&&s.jsx(su,{tripId:t,boatId:e,boatName:i.name||"Bez nzvu",canEdit:!1,canView:N,showStats:!0,statsOnly:!0})})]})]})})]})}function yx(){const{tripId:t,boatId:e}=ir(),n=_t(),{user:r}=yt(),a=!!e,[i,o]=C.useState(null),[l,u]=C.useState({name:"",model:"",length:"",year:"",cabins:"",capacity:"",charterLink:"",thumbnailUrl:""}),[d,h]=C.useState(!1),[f,m]=C.useState(!0);C.useEffect(()=>{t&&r&&_()},[t,e,r]);const _=async()=>{m(!0);const w=await pt.getTrip(t);if(w.data&&o(w.data),a&&e){const x=await Jt.getBoat(e);x.data&&u({name:x.data.name||"",model:x.data.model||"",length:x.data.length||"",year:x.data.year||"",cabins:x.data.cabins||"",capacity:x.data.capacity||"",charterLink:x.data.charterLink||"",thumbnailUrl:x.data.thumbnailUrl||""})}m(!1)},E=async w=>{if(w.preventDefault(),!r){alert("Muste bt pihleni");return}if(!i||!jN(i,r.uid)){alert("Nemte oprvnn upravovat tuto plavbu");return}h(!0);const x={...l,capacity:l.capacity?parseInt(l.capacity):null,year:l.year?parseInt(l.year):null,cabins:l.cabins?parseInt(l.cabins):null};if(a){const{error:v}=await Jt.updateBoat(e,x);if(v){alert("Chyba pi ukldn: "+v),h(!1);return}n(`/trip/${t}/organizer`)}else{const{id:v,error:j}=await Jt.createBoat(t,x);if(j){alert("Chyba pi vytven: "+j),h(!1);return}n(`/trip/${t}/organizer`)}h(!1)};return f?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):i?s.jsxs("div",{children:[s.jsx("div",{className:"trip-header",style:{padding:"var(--space-xl) 0"},children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:"/organizing",children:"Organizuji"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:`/trip/${t}/organizer`,children:i.name||"Plavba"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:a?"Upravit lo":"Nov lo"})]}),s.jsxs("div",{className:"trip-title-row",style:{marginTop:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",style:{fontSize:"2rem"},children:a?"Upravit lo":"Nov lo"}),a&&l.name&&s.jsx("p",{style:{color:"var(--gray-400)",marginTop:"var(--space-sm)"},children:l.name})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)"},children:[s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>n(-1),style:{background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.3)",color:"white"},children:[s.jsx("i",{className:"fas fa-times"}),"Zruit"]}),s.jsxs("button",{type:"submit",form:"boat-form",className:"btn btn-coral",disabled:d,children:[s.jsx("i",{className:"fas fa-save"}),d?"Ukldn...":a?"Uloit zmny":"Vytvoit lo"]})]})]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsx("div",{className:"container",style:{maxWidth:"1000px"},children:s.jsxs("form",{id:"boat-form",onSubmit:E,children:[s.jsxs("div",{className:"form-section animate-in",children:[s.jsx("div",{className:"form-section-header",children:s.jsx("div",{className:"form-section-title",children:s.jsxs("div",{children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)",marginRight:"var(--space-sm)"}}),"Informace o lodi"]}),s.jsx("p",{children:"Zkladn daje o lodi"})]})})}),s.jsxs("div",{className:"form-grid three-cols",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Nzev lod"}),s.jsx("input",{type:"text",className:"form-input",value:l.name,onChange:w=>u({...l,name:w.target.value}),placeholder:"nap. Mosk Vla"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Model"}),s.jsx("input",{type:"text",className:"form-input",value:l.model,onChange:w=>u({...l,model:w.target.value}),placeholder:"nap. Bavaria 46"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Kapacita"}),s.jsx("input",{type:"number",className:"form-input",value:l.capacity,onChange:w=>u({...l,capacity:w.target.value}),placeholder:"nap. 8",min:"1"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Dlka"}),s.jsx("input",{type:"text",className:"form-input",value:l.length,onChange:w=>u({...l,length:w.target.value}),placeholder:"nap. 14.27m"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Rok vroby"}),s.jsx("input",{type:"number",className:"form-input",value:l.year,onChange:w=>u({...l,year:w.target.value}),placeholder:"nap. 2019",min:"1900",max:new Date().getFullYear()+1})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Kajuty"}),s.jsx("input",{type:"number",className:"form-input",value:l.cabins,onChange:w=>u({...l,cabins:w.target.value}),placeholder:"nap. 4",min:"1"})]})]}),s.jsxs("div",{className:"form-grid two-cols",style:{marginTop:"var(--space-lg)"},children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Odkaz na chartrovku"}),s.jsx("input",{type:"url",className:"form-input",value:l.charterLink,onChange:w=>u({...l,charterLink:w.target.value}),placeholder:"https://..."}),s.jsx("p",{className:"form-help",children:"Odkaz na web chartrovky s informacemi o lodi"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"URL obrzku lod"}),s.jsx("input",{type:"url",className:"form-input",value:l.thumbnailUrl,onChange:w=>u({...l,thumbnailUrl:w.target.value}),placeholder:"https://..."}),s.jsx("p",{className:"form-help",children:"Odkaz na obrzek lod (extern server)"})]})]}),l.thumbnailUrl&&s.jsxs("div",{style:{marginTop:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Nhled obrzku"}),s.jsxs("div",{style:{marginTop:"var(--space-sm)"},children:[s.jsx("img",{src:l.thumbnailUrl,alt:"Nhled lod",style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},onError:w=>{w.target.style.display="none",w.target.nextSibling.style.display="block"}}),s.jsx("div",{style:{display:"none",padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",textAlign:"center",color:"var(--gray-500)"},children:"Obrzek se nepodailo nast"})]})]})]}),s.jsxs("div",{className:"sticky-actions",children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>n(-1),children:"Zruit"}),s.jsxs("button",{type:"submit",className:"btn btn-coral",disabled:d,children:[s.jsx("i",{className:"fas fa-save"}),d?"Ukldn...":a?"Uloit zmny":"Vytvoit lo"]})]})]})})})]}):s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Plavba nenalezena"}),s.jsx(ie,{to:"/organizing",className:"btn btn-primary",children:"Zpt na plavby"})]})})}function j2(){const{tripId:t,participantId:e}=ir();_t();const{user:n}=yt(),[r,a]=C.useState(null),[i,o]=C.useState(null),[l,u]=C.useState(null),[d,h]=C.useState(null),[f,m]=C.useState([]),[_,E]=C.useState({}),[w,x]=C.useState(null),[v,j]=C.useState(null),[S,R]=C.useState([]),[L,U]=C.useState(new Map),[N,y]=C.useState(!0),[k,b]=C.useState("prehled"),[A,z]=C.useState(!1),[T,$]=C.useState(null);C.useEffect(()=>{t&&e&&n&&Q()},[t,e,n]);const Q=async()=>{y(!0);const[I,O]=await Promise.all([pt.getTrip(t),Je.getParticipantById(e)]);if(I.data&&a(I.data),O.data){o(O.data);const F=[O.data.userId];if(O.data.boatId){const{participants:ae}=await Je.getBoatParticipants(t,O.data.boatId);ae.forEach(oe=>{F.includes(oe.userId)||F.push(oe.userId)});const pe=ae.find(oe=>oe.role==="captain");pe&&h(pe)}if(F.length>0){const ae=await pi(F);U(ae)}if(O.data.boatId){const{data:ae}=await Jt.getBoat(O.data.boatId);ae&&u(ae)}if(O.data.boatId){const[ae,pe]=await Promise.all([Nn.getCrewlistData(t,O.data.boatId,O.data.userId),Nn.getTemplate(t)]);ae.data&&x(ae.data),pe.data&&j(pe.data)}const{events:H,error:X}=await wt.getTripEvents(t);if(!X&&H){m(H);const ae={};for(const pe of H)if(pe.checkable){const{completed:oe}=await wt.getEventCompletion(pe.id,O.data.userId);ae[pe.id]=oe}E(ae)}const{instances:te}=await Fe.getTripInstances(t,{userId:O.data.userId});if(te){const ae=[],pe=new Set;te.forEach(oe=>{oe.templateId&&!pe.has(oe.templateId)?(pe.add(oe.templateId),ae.push(oe)):oe.templateId||pe.has(oe.id)||(pe.add(oe.id),ae.push(oe))}),R(ae)}else R([])}y(!1)},B=I=>I?I.toDate?I.toDate().toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):I.seconds?new Date(I.seconds*1e3).toLocaleDateString("cs-CZ",{day:"numeric",month:"numeric",year:"numeric"}):"":"",ee=I=>({participant:"Posdka",captain:"Kapitn",organizer:"Organiztor"})[I]||I,W=async I=>{if(!D)return;const O=_[I]||!1,{error:F}=await wt.setEventCompletion(I,i.userId,!O);F||E(H=>({...H,[I]:!O}))};if(N)return s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})});if(!i||!r)return s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"astnk nenalezen"}),s.jsx(ie,{to:`/trip/${t}/organizer`,className:"btn btn-primary",children:"Zpt na plavbu"})]})});if(!r2(r,n==null?void 0:n.uid))return s.jsx("div",{className:"container",children:s.jsxs("div",{style:{textAlign:"center",padding:"var(--space-3xl)"},children:[s.jsx("h2",{children:"Nem oprvnn k tto strnce"}),s.jsx(ie,{to:`/trip/${t}/organizer`,className:"btn btn-primary",children:"Zpt na plavbu"})]})});const D=n2(r,i,n==null?void 0:n.uid),q=Object.values(_).filter(I=>I===!0).length,G=f.filter(I=>I.checkable).length;return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"trip-header organizer",style:{padding:"var(--space-xl) 0"},children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:`/trip/${t}/organizer`,children:r.name||"Plavba"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx(ie,{to:`/trip/${t}/organizer#tab-ucastnici`,children:"astnci"}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:(()=>{const I=L.get(i.userId);return(I==null?void 0:I.name)||"Neznm uivatel"})()})]}),s.jsxs("div",{className:"trip-title-row",style:{marginTop:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-lg)"},children:[s.jsx("div",{className:"crew-avatar",style:{width:"64px",height:"64px",fontSize:"1.5rem",background:"linear-gradient(135deg, var(--coral), var(--coral-light))"},children:(()=>{const I=L.get(i.userId);if(I!=null&&I.name){const O=I.name.trim().split(/\s+/);return O.length>=2?(O[0][0]+O[O.length-1][0]).toUpperCase():I.name.substring(0,2).toUpperCase()}return i.userId.substring(0,2).toUpperCase()})()}),s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",style:{fontSize:"2rem",marginBottom:"var(--space-xs)"},children:(()=>{const I=L.get(i.userId),O=(I==null?void 0:I.name)||"Neznm uivatel";return i.userId===n.uid?`${O} (organiztor)`:O})()}),s.jsx("p",{style:{color:"var(--gray-400)",margin:0},children:"astnk plavby"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)"},children:[s.jsxs(ie,{to:`/trip/${t}/organizer#tab-ucastnici`,className:"btn btn-secondary",children:[s.jsx("i",{className:"fas fa-arrow-left"}),"Zpt na seznam"]}),D&&s.jsxs("button",{className:"btn btn-primary",onClick:()=>z(!0),children:[s.jsx("i",{className:"fas fa-edit"}),"Upravit piazen"]})]})]})]})})}),s.jsx("div",{className:"trip-tabs",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-tabs-inner",children:[s.jsxs("button",{className:`trip-tab ${k==="prehled"?"active":""}`,onClick:()=>b("prehled"),children:[s.jsx("i",{className:"fas fa-info-circle"}),"Pehled"]}),s.jsxs("button",{className:`trip-tab ${k==="crew-list"?"active":""}`,onClick:()=>b("crew-list"),children:[s.jsx("i",{className:"fas fa-clipboard-list"}),"Crewlist"]}),s.jsxs("button",{className:`trip-tab ${k==="pred-plavbou"?"active":""}`,onClick:()=>b("pred-plavbou"),children:[s.jsx("i",{className:"fas fa-flag-checkered"}),"Ped plavbou"]}),s.jsxs("button",{className:`trip-tab ${k==="checklisty"?"active":""}`,onClick:()=>b("checklisty"),children:[s.jsx("i",{className:"fas fa-tasks"}),"Checklisty"]})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",children:[k==="prehled"&&s.jsxs("div",{className:"trip-layout",children:[s.jsxs("div",{className:"main-content",children:[s.jsxs("div",{className:"card animate-in",style:{marginBottom:"var(--space-xl)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-ship",style:{color:"var(--turquoise)"}}),"Piazen do lod"]})}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Lo"}),s.jsx("div",{className:"font-medium",style:{fontSize:"1.125rem"},children:l?`${l.model||""} ${l.model&&l.name?"":""} ${l.name||"Bez nzvu"}`.trim():"Nepiazeno"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Role"}),s.jsx("div",{className:"font-medium",style:{fontSize:"1.125rem"},children:ee(i.role)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Podrole"}),s.jsx("div",{className:"font-medium",style:{fontSize:"1.125rem"},children:""})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Kapitn lod"}),s.jsx("div",{className:"font-medium",style:{fontSize:"1.125rem"},children:(()=>{if(!d)return"";const I=L.get(d.userId);return(I==null?void 0:I.name)||"Neznm uivatel"})()})]})]})]}),s.jsxs("div",{className:"card animate-in delay-1",style:{marginBottom:"var(--space-xl)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Pehled stavu"]})}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"var(--space-lg)"},children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Hlavn checklist"}),s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:s.jsxs("span",{className:`status-pill ${q===G&&G>0?"success":"warning"}`,style:{fontSize:"0.875rem"},children:[q,"/",G," ",q===G&&G>0?"splnno":"nesplnno"]})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:"Crewlist"}),s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:s.jsx("span",{className:`status-pill ${w?"success":"warning"}`,style:{fontSize:"0.875rem"},children:w?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-check"})," Vyplnno"]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-exclamation"})," Nevyplnno"]})})})]})]})]})]}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-address-card",style:{color:"var(--turquoise)"}}),"Kontaktn daje"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",marginTop:"var(--space-lg)"},children:(()=>{const I=L.get(i.userId),O=(I==null?void 0:I.email)||(w==null?void 0:w.email),F=(I==null?void 0:I.phone)||(w==null?void 0:w.telefon)||(w==null?void 0:w.phone);return O||F?s.jsxs(s.Fragment,{children:[O&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Email"}),s.jsx("div",{className:"font-medium",children:O})]}),F&&s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted",children:"Telefon"}),s.jsx("div",{className:"font-medium",children:F})]})]}):s.jsx("div",{className:"text-sm text-muted",children:"Kontaktn daje nejsou k dispozici"})})()}),(()=>{const I=L.get(i.userId),O=(I==null?void 0:I.email)||(w==null?void 0:w.email),F=(I==null?void 0:I.phone)||(w==null?void 0:w.telefon)||(w==null?void 0:w.phone);return O||F?s.jsx("div",{style:{marginTop:"var(--space-lg)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--gray-100)"},children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-sm)"},children:[O&&s.jsxs("a",{href:`mailto:${O}`,className:"btn btn-sm btn-secondary",style:{width:"100%"},children:[s.jsx("i",{className:"fas fa-envelope"}),"Poslat email"]}),F&&s.jsxs("a",{href:`tel:${F.replace(/\s/g,"")}`,className:"btn btn-sm btn-secondary",style:{width:"100%"},children:[s.jsx("i",{className:"fas fa-phone"}),"Zavolat"]})]})}):null})()]})})]}),k==="crew-list"&&s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Crewlist"]})}),l?s.jsx("div",{children:w?s.jsxs("div",{children:[s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"daje vyplnn astnkem do crewlistu."}),s.jsx("div",{style:{display:"grid",gap:"var(--space-md)"},children:(()=>{const I=[];return v!=null&&v.fields&&Object.keys(v.fields).forEach(O=>{v.fields[O].forEach(F=>{I.find(H=>H.id===F.id)||I.push(F)})}),Object.entries(w).filter(([O])=>!["id","tripId","boatId","userId","createdAt","updatedAt"].includes(O)).map(([O,F])=>{const H=I.find(te=>te.id===O),X=(H==null?void 0:H.label)||O;return s.jsxs("div",{style:{padding:"var(--space-md)",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:X}),s.jsx("div",{className:"font-medium",children:F||"-"})]},O)})})()})]}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:s.jsx("p",{children:"astnk zatm nevyplnil crewlist."})})}):s.jsx("div",{style:{textAlign:"center",padding:"var(--space-xl)",color:"var(--gray-500)"},children:s.jsx("p",{children:"astnk nen piazen k dn lodi."})})]}),k==="pred-plavbou"&&s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-flag-checkered",style:{color:"var(--coral)"}}),"Hlavn checklist"]})}),f.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",padding:"var(--space-xl)"},children:f.map(I=>{var H,X;const O=_[I.id]||!1,F=(H=I.date)!=null&&H.toDate?I.date.toDate():(X=I.date)!=null&&X.seconds?new Date(I.date.seconds*1e3):null;return s.jsx("div",{className:`checklist-event ${O?"completed":""}`,children:s.jsxs("div",{className:"checklist-event-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"var(--space-md)"},children:[I.checkable?s.jsx("div",{className:`checklist-event-checkbox ${O?"completed":""}`,onClick:()=>D&&W(I.id),style:{cursor:D?"pointer":"default"},children:O&&s.jsx("i",{className:"fas fa-check",style:{fontSize:"0.75rem"}})}):s.jsx("div",{className:"checklist-event-checkbox",style:{cursor:"default"}}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{className:"font-medium",style:{marginBottom:"var(--space-xs)"},children:I.name||"Bez nzvu"}),I.description&&s.jsx("div",{className:"text-sm text-muted",style:{marginBottom:"var(--space-xs)"},children:I.description}),s.jsx("div",{className:"text-sm text-muted",style:{textTransform:"capitalize"},children:I.type==="crewlist"?"Crewlist":I.type==="payment"?"Platba":"Vlastn"})]})]}),s.jsxs("div",{style:{textAlign:"right"},children:[F&&s.jsxs("div",{className:`text-xs ${F<new Date&&!O?"text-danger":"text-muted"}`,style:{marginTop:"var(--space-xs)"},children:["do ",B(I.date)]}),O&&s.jsx("span",{className:"status-pill success",style:{fontSize:"0.75rem",marginTop:"var(--space-xs)",display:"block"},children:"Splnno"})]})]})},I.id)})}):s.jsx("div",{style:{padding:"var(--space-xl)"},children:s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou definovan dn udlosti v timeline."})})]}),k==="checklisty"&&s.jsxs("div",{className:"trip-layout",children:[s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-tasks",style:{color:"var(--turquoise)"}}),"Systmov checklisty"]})}),s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-lg)"},children:"Checklisty piazen tomuto astnkovi. Kliknutm je otevete."}),S.length>0?s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)",padding:"var(--space-xl)"},children:S.map(I=>{var H,X;const O=((H=I.items)==null?void 0:H.filter(te=>te.completed).length)||0,F=((X=I.items)==null?void 0:X.length)||0;return s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-lg)",background:"var(--gray-50)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:te=>te.currentTarget.style.background="var(--gray-100)",onMouseLeave:te=>te.currentTarget.style.background="var(--gray-50)",onClick:()=>$(I.id),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",background:"rgba(6, 182, 212, 0.1)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--turquoise)",fontSize:"1.25rem"},children:s.jsx("i",{className:"fas fa-clipboard-check"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:I.name||"Checklist"}),s.jsx("div",{className:"text-sm text-muted",children:I.description||"Osobn checklist"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsxs("span",{className:`status-pill ${O===F&&F>0?"success":"warning"}`,style:{fontSize:"0.75rem"},children:[O,"/",F]}),s.jsx("i",{className:"fas fa-chevron-right",style:{color:"var(--gray-400)"}})]})]},I.id)})}):s.jsx("div",{style:{padding:"var(--space-xl)"},children:s.jsx("p",{style:{color:"var(--gray-500)"},children:"Zatm nejsou piazeny dn checklisty pro tohoto astnka."})})]})}),s.jsx("aside",{children:s.jsxs("div",{className:"sidebar-card animate-in delay-1",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Tip"]}),s.jsx("p",{className:"text-muted",style:{marginTop:"var(--space-md)"},children:"Kliknutm na checklist ho otevete. Poloky mete oznaovat jako splnn a v postup se automaticky ukld."})]})})]}),k==="checklisty"&&T&&(()=>{var te,ae;const I=S.find(pe=>pe.id===T);if(!I)return $(null),null;const O=((te=I.items)==null?void 0:te.filter(pe=>pe.completed).length)||0,F=((ae=I.items)==null?void 0:ae.length)||0,H=_N(r,I,l,i,n==null?void 0:n.uid),X=pe=>{R(oe=>oe.map(De=>De.id===pe.id?pe:De))};return s.jsx("div",{className:"main-content",children:s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)"},children:[s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>$(null),style:{marginRight:"var(--space-sm)"},children:s.jsx("i",{className:"fas fa-arrow-left"})}),s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-check",style:{color:"var(--turquoise)"}}),I.name||"Checklist"]})]}),s.jsxs("span",{className:`status-pill ${O===F&&F>0?"success":"warning"}`,children:[O,"/",F]})]}),s.jsx("div",{style:{padding:"var(--space-xl)"},children:s.jsx(Hu,{instance:I,onUpdate:X,canEdit:H,canView:!0,isOwnChecklist:!1,defaultMode:"view"})})]})})})()]})}),A&&s.jsx(_2,{tripId:t,participant:i,boats:[],onClose:()=>z(!1),onSave:Q})]})}function _2({tripId:t,participant:e,boats:n,onClose:r,onSave:a}){const[i,o]=C.useState({role:(e==null?void 0:e.role)||"participant",boatId:(e==null?void 0:e.boatId)||null}),[l,u]=C.useState(!1),[d,h]=C.useState(null),[f,m]=C.useState([]);C.useEffect(()=>{_()},[]);const _=async()=>{const{boats:w}=await Jt.getTripBoats(t);m(w)},E=async w=>{if(w.preventDefault(),u(!0),h(null),i.role!==e.role){const{error:x}=await Je.updateParticipantRole(e.id,i.role);if(x){h(x),u(!1);return}}if(i.boatId!==e.boatId){const{error:x}=await Je.assignToBoat(e.id,i.boatId);if(x){h(x),u(!1);return}}a(),r(),u(!1)};return s.jsx("div",{className:"modal-overlay",onClick:r,style:{position:"fixed",inset:0,background:"rgba(10, 22, 40, 0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:s.jsxs("div",{className:"modal",onClick:w=>w.stopPropagation(),style:{background:"var(--white)",borderRadius:"var(--radius-xl)",boxShadow:"var(--shadow-xl)",maxWidth:600,width:"90%",maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("div",{className:"modal-header",style:{padding:"var(--space-xl)",borderBottom:"1px solid var(--gray-100)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("h4",{children:"Upravit piazen astnka"}),s.jsx("button",{className:"btn btn-icon btn-ghost",onClick:r,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{onSubmit:E,children:[s.jsxs("div",{className:"modal-body",style:{padding:"var(--space-xl)"},children:[d&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:d}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Lo"}),s.jsxs("select",{className:"form-input",value:i.boatId||"",onChange:w=>o(x=>({...x,boatId:w.target.value||null})),children:[s.jsx("option",{value:"",children:"Nepiazeno"}),f.map(w=>s.jsx("option",{value:w.id,children:w.name||"Bez nzvu"},w.id))]})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Role *"}),s.jsxs("select",{className:"form-input",value:i.role,onChange:w=>o(x=>({...x,role:w.target.value})),required:!0,children:[s.jsx("option",{value:"participant",children:"Posdka"}),s.jsx("option",{value:"captain",children:"Kapitn"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Podrole (voliteln)"}),s.jsxs("select",{className:"form-input",children:[s.jsx("option",{value:"",children:"Bez podrole"}),s.jsx("option",{value:"kormidelnik",children:"Kormidelnk"}),s.jsx("option",{value:"mastman",children:"Mastman"}),s.jsx("option",{value:"bowman",children:"Bowman"})]})]})]}),s.jsxs("div",{className:"modal-footer",style:{padding:"var(--space-lg) var(--space-xl)",borderTop:"1px solid var(--gray-100)",display:"flex",justifyContent:"flex-end",gap:"var(--space-sm)"},children:[s.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,children:"Zruit"}),s.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:l,children:[s.jsx("i",{className:"fas fa-save"}),l?"Ukldn...":"Uloit zmny"]})]})]})]})})}function N2(){const{user:t}=yt(),[e,n]=C.useState({name:"",email:"",phone:"",address:""}),[r,a]=C.useState(""),[i,o]=C.useState(!1),[l,u]=C.useState(!0),[d,h]=C.useState(!1),[f,m]=C.useState(""),[_,E]=C.useState(!1);C.useEffect(()=>{if(t){const v=t.providerData&&t.providerData.some(j=>j.providerId==="google.com");E(v),w()}},[t]);const w=async()=>{u(!0);const{data:v,error:j}=await ps.getProfile(t.uid);if(!j&&v){const S=v.name||"";n({name:S,email:v.email||"",phone:v.phone||"",address:v.address||""}),a(S)}else{const S=(t==null?void 0:t.displayName)||"";n({name:S,email:(t==null?void 0:t.email)||"",phone:"",address:""}),a(S)}u(!1)},x=async v=>{v.preventDefault(),m("");const j=e.name.trim(),S=e.email.trim(),R=e.phone.trim();if(j.length<2){m("Jmno a pjmen mus obsahovat alespo 2 znaky");return}if(S.length===0){alert("Email je povinn");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S)){alert("Email nen ve sprvnm formtu");return}if(R.length===0){alert("Telefon je povinn");return}if(r&&r.trim().length>0&&j.length===0){m("Jmno a pjmen nelze smazat. Muste zadat nov jmno.");return}o(!0),h(!1);const{error:L}=await ps.saveProfile(t.uid,{...e,name:j,email:S,phone:R});L?alert("Chyba pi ukldn: "+L):(a(j),a2(),h(!0),setTimeout(()=>h(!1),3e3)),o(!1)};return l?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"trip-header",style:{padding:"var(--space-xl) 0"},children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:"0.75rem"}}),s.jsx("span",{children:"Mj profil"})]}),s.jsx("div",{className:"trip-title-row",style:{marginTop:"var(--space-lg)"},children:s.jsxs("div",{children:[s.jsx("h1",{className:"trip-title",style:{fontSize:"2rem"},children:"Mj profil"}),s.jsx("p",{style:{color:"var(--gray-400)",marginTop:"var(--space-sm)"},children:"Spravujte sv kontaktn daje, kter budou zobrazeny ostatnm astnkm plaveb"})]})})]})})}),s.jsx("main",{className:"trip-content",children:s.jsxs("div",{className:"container",style:{maxWidth:800},children:[s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-user",style:{color:"var(--turquoise)"}}),"Kontaktn daje"]})}),d&&s.jsxs("div",{style:{margin:"var(--space-md) var(--space-xl)",padding:"var(--space-md)",background:"var(--success-light)",color:"var(--success)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[s.jsx("i",{className:"fas fa-check-circle"}),"Kontaktn daje byly spn uloeny."]}),s.jsxs("form",{onSubmit:x,style:{padding:"var(--space-xl)"},children:[s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Jmno a pjmen *"}),s.jsx("input",{type:"text",className:`form-input ${f?"error":""}`,value:e.name,onChange:v=>{n(j=>({...j,name:v.target.value})),m("")},placeholder:"nap. Jan Novk",required:!0,minLength:2}),f&&s.jsx("p",{className:"form-error",style:{color:"var(--danger)",marginTop:"var(--space-xs)",fontSize:"0.875rem"},children:f}),s.jsx("p",{className:"form-help",children:"Toto jmno bude zobrazeno ostatnm astnkm plaveb. Jmno a pjmen je povinn a nelze ho smazat bez nahrazen."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Email *"}),s.jsx("input",{type:"email",className:"form-input",value:e.email,onChange:v=>n(j=>({...j,email:v.target.value})),placeholder:"nap. jan@example.com",required:!0,disabled:_}),_?s.jsxs("p",{className:"form-help",style:{color:"var(--gray-500)",fontSize:"0.875rem",marginTop:"var(--space-xs)"},children:[s.jsx("i",{className:"fas fa-lock",style:{marginRight:"4px"}}),"Email je propojen s vam Google tem a nelze ho zmnit"]}):s.jsx("p",{className:"form-help",children:"Email pro kontaktovn"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Telefon *"}),s.jsx("input",{type:"tel",className:"form-input",value:e.phone,onChange:v=>n(j=>({...j,phone:v.target.value})),placeholder:"nap. +420 123 456 789",required:!0}),s.jsx("p",{className:"form-help",children:"Telefonn slo pro kontaktovn"})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{className:"form-label",children:"Adresa (voliteln)"}),s.jsx("textarea",{className:"form-input",rows:3,value:e.address,onChange:v=>n(j=>({...j,address:v.target.value})),placeholder:"Adresa pro korespondenci..."}),s.jsx("p",{className:"form-help",children:"Adresa pro korespondenci nebo fakturaci"})]})]}),s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"var(--space-xl)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--gray-100)"},children:s.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:i,children:[s.jsx("i",{className:"fas fa-save"}),i?"Ukldn...":"Uloit zmny"]})})]})]}),s.jsxs("div",{className:"card animate-in delay-1",style:{marginTop:"var(--space-lg)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-info-circle",style:{color:"var(--turquoise)"}}),"Informace"]})}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[s.jsx("p",{className:"text-muted",style:{marginBottom:"var(--space-md)"},children:"Vae kontaktn daje budou zobrazeny:"}),s.jsxs("ul",{style:{color:"var(--gray-600)",lineHeight:1.8,paddingLeft:"var(--space-lg)"},children:[s.jsx("li",{children:"astnkm plaveb, kter organizujete"}),s.jsx("li",{children:"Kapitnm lod, pokud jste kapitnem"}),s.jsx("li",{children:"Ostatnm astnkm, pokud jste kapitnem jejich lod"})]})]})]})]})})]})}function xx(){const{checklistId:t}=ir(),e=_t(),{user:n}=yt(),[r,a]=C.useState({name:"",description:"",categories:[],items:[]}),[i,o]=C.useState(!1),[l,u]=C.useState(!0),[d,h]=C.useState(null),[f,m]=C.useState(""),[_,E]=C.useState({text:"",category:"",inputType:"checkbox",allowNote:!1}),[w,x]=C.useState(null),[v,j]=C.useState(""),[S,R]=C.useState("");C.useEffect(()=>{n&&t?L():n&&!t&&u(!1)},[n,t]);const L=async()=>{u(!0);const{data:T,error:$}=await Fe.getTemplate(t);!$&&T?a({name:T.name||"",description:T.description||"",categories:T.categories||[],items:T.items||[]}):h("Checklist nenalezen"),u(!1)},U=async T=>{if(T.preventDefault(),o(!0),h(null),!r.name.trim()){h("Nzev checklistu je povinn"),o(!1);return}let $;if(t){if($=await Fe.updateTemplate(t,r),!$.error){const Q=await Fe.syncInstancesFromTemplate(t);Q.error&&console.error("Chyba pi synchronizaci instanc:",Q.error)}}else $=await Fe.createTemplate(n.uid,r);$.error?h($.error):(e("/settings/organizer?tab=checklists"),window.location.href="/settings/organizer?tab=checklists"),o(!1)},N=()=>{f.trim()&&!r.categories.includes(f.trim())&&(a(T=>({...T,categories:[...T.categories,f.trim()]})),m(""))},y=T=>{a($=>({...$,categories:$.categories.filter(Q=>Q!==T),items:$.items.map(Q=>Q.category===T?{...Q,category:""}:Q)}))},k=()=>{_.text.trim()&&(a(T=>({...T,items:[...T.items,{id:Date.now().toString(),text:_.text.trim(),name:_.text.trim(),category:_.category||"",required:!1,inputType:_.inputType||"checkbox",allowNote:_.allowNote||!1}]})),E({text:"",category:"",inputType:"checkbox",allowNote:!1}))},b=(T,$)=>{a(Q=>({...Q,items:Q.items.map(B=>B.id===T?{...B,...$}:B)})),x(null)},A=T=>{a($=>({...$,items:$.items.filter(Q=>Q.id!==T)}))},z=r.items.filter(T=>{var B;const $=!v||T.text.toLowerCase().includes(v.toLowerCase())||((B=T.name)==null?void 0:B.toLowerCase().includes(v.toLowerCase())),Q=!S||T.category===S;return $&&Q});return l?s.jsx("div",{className:"container",children:s.jsx("div",{style:{textAlign:"center",padding:"var(--space-3xl)",color:"var(--gray-500)"},children:"Natn..."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"trip-header",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"trip-header-content",children:[s.jsxs("div",{className:"breadcrumb",children:[s.jsx(ie,{to:"/dashboard",children:s.jsx("i",{className:"fas fa-home"})}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx(ie,{to:"/settings/organizer",children:"Nastaven organiztora"}),s.jsx("i",{className:"fas fa-chevron-right"}),s.jsx("span",{children:t?"Upravit checklist":"Nov checklist"})]}),s.jsx("div",{className:"trip-title-row",children:s.jsx("div",{children:s.jsx("h1",{className:"trip-title",children:t?"Upravit checklist":"Nov checklist"})})})]})})}),s.jsx("main",{className:"trip-content",children:s.jsx("div",{className:"container",style:{maxWidth:1200},children:s.jsxs("form",{onSubmit:U,children:[s.jsxs("div",{className:"card animate-in",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-clipboard-list",style:{color:"var(--turquoise)"}}),"Zkladn informace"]})}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[d&&s.jsx("div",{style:{padding:"var(--space-md)",background:"var(--danger-light)",color:"var(--danger)",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"},children:d}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Nzev checklistu *"}),s.jsx("input",{type:"text",className:"form-input",value:r.name,onChange:T=>a($=>({...$,name:T.target.value})),placeholder:"nap. Pedn lod",required:!0})]}),s.jsxs("div",{className:"form-group",style:{marginBottom:"var(--space-md)"},children:[s.jsx("label",{className:"form-label",children:"Popis (voliteln)"}),s.jsx("textarea",{className:"form-input",rows:2,value:r.description,onChange:T=>a($=>({...$,description:T.target.value})),placeholder:"Strun popis checklistu..."})]})]})]}),s.jsxs("div",{className:"card animate-in delay-1",style:{marginTop:"var(--space-lg)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-tags",style:{color:"var(--coral)"}}),"Kategorie"]})}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginBottom:"var(--space-md)"},children:[s.jsx("input",{type:"text",className:"form-input",style:{flex:1,maxWidth:300},value:f,onChange:T=>m(T.target.value),onKeyPress:T=>T.key==="Enter"&&(T.preventDefault(),N()),placeholder:"Nzev kategorie"}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:N,children:[s.jsx("i",{className:"fas fa-plus"})," Pidat kategorii"]})]}),r.categories.length>0&&s.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",flexWrap:"wrap"},children:r.categories.map(T=>s.jsxs("span",{className:"status-pill info",style:{fontSize:"0.875rem"},children:[T,s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost",style:{marginLeft:"var(--space-xs)",padding:0,fontSize:"0.75rem"},onClick:()=>y(T),children:s.jsx("i",{className:"fas fa-times"})})]},T))})]})]}),s.jsxs("div",{className:"card animate-in delay-2",style:{marginTop:"var(--space-lg)"},children:[s.jsx("div",{className:"card-header",children:s.jsxs("h4",{className:"card-title",children:[s.jsx("i",{className:"fas fa-list",style:{color:"var(--turquoise)"}}),"Poloky (",r.items.length,")"]})}),s.jsxs("div",{style:{padding:"var(--space-xl)"},children:[s.jsxs("div",{style:{marginBottom:"var(--space-lg)"},children:[s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginBottom:"var(--space-sm)",flexWrap:"wrap"},children:[s.jsx("input",{type:"text",className:"form-input",style:{flex:1,minWidth:200},value:_.text,onChange:T=>E($=>({...$,text:T.target.value})),onKeyPress:T=>T.key==="Enter"&&(T.preventDefault(),k()),placeholder:"Nzev poloky"}),r.categories.length>0&&s.jsxs("select",{className:"form-input",style:{width:200},value:_.category,onChange:T=>E($=>({...$,category:T.target.value})),children:[s.jsx("option",{value:"",children:"Bez kategorie"}),r.categories.map(T=>s.jsx("option",{value:T,children:T},T))]}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:k,children:[s.jsx("i",{className:"fas fa-plus"})," Pidat poloku"]})]}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",alignItems:"center",flexWrap:"wrap",fontSize:"0.875rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)"},children:[s.jsx("input",{type:"checkbox",checked:_.allowNote,onChange:T=>E($=>({...$,allowNote:T.target.checked}))}),s.jsx("span",{children:"Povolit poznmku"})]}),s.jsxs("select",{className:"form-input",style:{width:150},value:_.inputType,onChange:T=>E($=>({...$,inputType:T.target.value})),children:[s.jsx("option",{value:"checkbox",children:"Zakrtnut"}),s.jsx("option",{value:"number",children:"slo"}),s.jsx("option",{value:"text",children:"Text"})]})]})]}),r.items.length>0&&s.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginBottom:"var(--space-md)",flexWrap:"wrap"},children:[s.jsx("input",{type:"text",className:"form-input",style:{flex:1,minWidth:200},value:v,onChange:T=>j(T.target.value),placeholder:"Vyhledat poloku..."}),r.categories.length>0&&s.jsxs("select",{className:"form-input",style:{width:200},value:S,onChange:T=>R(T.target.value),children:[s.jsx("option",{value:"",children:"Vechny kategorie"}),r.categories.map(T=>s.jsx("option",{value:T,children:T},T))]})]}),z.length>0?s.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",padding:"var(--space-sm)"},children:s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:z.map(T=>s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)",padding:"var(--space-sm)",background:w===T.id?"rgba(6, 182, 212, 0.1)":"var(--gray-50)",borderRadius:"var(--radius-sm)",transition:"background 0.2s",border:w===T.id?"1px solid rgba(6, 182, 212, 0.3)":"1px solid transparent"},onMouseEnter:$=>!w&&($.currentTarget.style.background="var(--gray-100)"),onMouseLeave:$=>!w&&($.currentTarget.style.background="var(--gray-50)"),children:w===T.id?s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:[s.jsx("input",{type:"text",className:"form-input",style:{fontSize:"0.875rem"},value:T.text||T.name,onChange:$=>b(T.id,{text:$.target.value,name:$.target.value}),autoFocus:!0}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",alignItems:"center",flexWrap:"wrap",fontSize:"0.75rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-xs)"},children:[s.jsx("input",{type:"checkbox",checked:T.allowNote||!1,onChange:$=>b(T.id,{allowNote:$.target.checked})}),s.jsx("span",{children:"Poznmka"})]}),s.jsxs("select",{className:"form-input",style:{width:120,fontSize:"0.75rem",padding:"var(--space-xs)"},value:T.inputType||"checkbox",onChange:$=>b(T.id,{inputType:$.target.value}),children:[s.jsx("option",{value:"checkbox",children:"Zakrtnut"}),s.jsx("option",{value:"number",children:"slo"}),s.jsx("option",{value:"text",children:"Text"})]})]})]}),s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost btn-sm",onClick:()=>x(null),title:"Hotovo",children:s.jsx("i",{className:"fas fa-check"})})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:[s.jsx("span",{style:{fontSize:"0.875rem"},children:T.text||T.name}),s.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)",flexWrap:"wrap",fontSize:"0.75rem"},children:[T.category&&s.jsx("span",{className:"status-pill info",style:{fontSize:"0.75rem"},children:T.category}),T.inputType&&T.inputType!=="checkbox"&&s.jsx("span",{className:"status-pill",style:{fontSize:"0.75rem",background:"var(--turquoise-light)",color:"var(--turquoise)"},children:T.inputType==="number"?"slo":"Text"}),T.allowNote&&s.jsxs("span",{className:"status-pill",style:{fontSize:"0.75rem",background:"var(--coral-light)",color:"var(--coral)"},children:[s.jsx("i",{className:"fas fa-sticky-note"})," Poznmka"]})]})]}),s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost btn-sm",onClick:()=>x(T.id),title:"Upravit poloku",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{type:"button",className:"btn btn-icon btn-ghost btn-sm",style:{color:"var(--danger)"},onClick:()=>A(T.id),title:"Odstranit poloku",children:s.jsx("i",{className:"fas fa-times"})})]})},T.id))})}):s.jsx("p",{className:"text-muted",style:{fontSize:"0.875rem",textAlign:"center",padding:"var(--space-md)"},children:v||S?"dn poloky neodpovdaj filtru":"Zatm nejsou dn poloky"}),r.items.length>0&&s.jsxs("div",{style:{marginTop:"var(--space-sm)",fontSize:"0.875rem",color:"var(--gray-500)"},children:["Celkem: ",r.items.length," poloek",(v||S)&&` (zobrazeno: ${z.length})`]})]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"var(--space-sm)",marginTop:"var(--space-xl)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--gray-200)"},children:[s.jsx(ie,{to:"/settings/organizer?tab=checklists",className:"btn btn-ghost",children:"Zruit"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Ukldn...":t?"Uloit zmny":"Vytvoit"})]})]})})})]})}const b2=({isOpen:t,onClose:e,currentUser:n=null})=>{const r=_t(),a=ar(),[i,o]=C.useState(!1),[l,u]=C.useState(!1),[d,h]=C.useState("U"),f=300;if(C.useEffect(()=>{n!=null&&n.uid&&bN(n.uid).then(v=>{h(v)})},[n]),C.useEffect(()=>{let v,j;return t?(o(!0),document.documentElement.style.setProperty("overflow","hidden","important"),document.body.style.setProperty("overflow","hidden","important"),v=setTimeout(()=>{u(!0)},50)):(u(!1),j=setTimeout(()=>{o(!1),document.documentElement.style.removeProperty("overflow"),document.body.style.removeProperty("overflow")},f)),()=>{clearTimeout(v),clearTimeout(j),document.documentElement.style.removeProperty("overflow"),document.body.style.removeProperty("overflow")}},[t,f]),!i)return null;const m=v=>{r(v),e()},_=async()=>{try{await zf(Hn),r("/"),e()}catch(v){console.error("Error signing out:",v)}},E=[{path:"/dashboard",label:"Dashboard",icon:""},{path:"/trips",label:"M plavby",icon:""},{path:"/organizing",label:"Organizuji",icon:""}],w=l?"opacity-100":"opacity-0",x=l?"translate-x-0":"-translate-x-full";return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`side-drawer-backdrop ${w}`,onClick:e,"aria-hidden":"true"}),s.jsxs("div",{className:`side-drawer ${x}`,role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"side-drawer-header",children:[s.jsxs("div",{className:"side-drawer-brand",children:[s.jsx("div",{className:"side-drawer-logo",children:""}),s.jsx("div",{children:s.jsx("div",{className:"side-drawer-app-name",children:"SailPlan"})})]}),s.jsx("button",{onClick:e,className:"side-drawer-close","aria-label":"Zavt",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("nav",{className:"side-drawer-nav",children:E.map(v=>{const j=a.pathname===v.path;return s.jsxs("button",{onClick:()=>m(v.path),className:`side-drawer-nav-item ${j?"active":""}`,children:[s.jsx("span",{className:"side-drawer-nav-icon",children:v.icon}),s.jsx("span",{children:v.label})]},v.path)})}),s.jsxs("div",{className:"side-drawer-footer",children:[s.jsxs("button",{onClick:()=>m("/profile"),className:"side-drawer-nav-item",children:[s.jsx("i",{className:"fas fa-user"}),s.jsx("span",{children:"Mj profil"})]}),s.jsxs("button",{onClick:()=>m("/settings/organizer"),className:"side-drawer-nav-item",children:[s.jsx("span",{className:"side-drawer-nav-icon",children:""}),s.jsx("span",{children:"Nastaven organiztora"})]}),s.jsx("div",{className:"side-drawer-divider"}),n&&s.jsxs("div",{className:"side-drawer-user",children:[s.jsx("div",{className:"side-drawer-avatar",children:d}),s.jsxs("div",{className:"side-drawer-user-info",children:[s.jsx("div",{className:"side-drawer-user-name",children:n.displayName||"Uivatel"}),s.jsx("div",{className:"side-drawer-user-email",children:n.email})]})]}),s.jsxs("button",{onClick:_,className:"side-drawer-nav-item",children:[s.jsx("i",{className:"fas fa-sign-out-alt"}),s.jsx("span",{children:"Odhlsit se"})]})]})]})]})},EN=Tp.memo(({onMenuClick:t})=>{const e=ar(),n=_t(),r=[{path:"/dashboard",label:"Dashboard",icon:s.jsx("i",{className:"fas fa-tachometer-alt"}),action:()=>n("/dashboard")},{path:"/trips",label:"M plavby",icon:s.jsx("i",{className:"fas fa-ship"}),action:()=>n("/trips")},{path:"/organizing",label:"Organizuji",icon:s.jsx("i",{className:"fas fa-sitemap"}),action:()=>n("/organizing")},{path:"/profile",label:"Profil",icon:s.jsx("i",{className:"fas fa-user"}),action:()=>n("/profile")},{path:"menu",label:"Menu",icon:s.jsx("i",{className:"fas fa-bars"}),action:t}],a=i=>i==="menu"?!1:e.pathname===i||e.pathname.startsWith(i+"/");return s.jsx("nav",{className:"bottom-nav",children:r.map(i=>{const o=a(i.path);return s.jsxs("button",{onClick:i.action,className:`bottom-nav-item ${o?"active":""}`,"aria-current":o?"page":void 0,children:[s.jsx("span",{className:"bottom-nav-icon",children:i.icon}),s.jsx("span",{className:"bottom-nav-label",children:i.label})]},i.path)})})});EN.displayName="BottomNav";function k2(){const{user:t}=yt(),e=ar(),n=_t(),[r,a]=C.useState(!1),[i,o]=C.useState("U"),[l,u]=C.useState(!1),d=C.useRef(null),h=lr("(max-width: 768px)");C.useEffect(()=>{t!=null&&t.uid&&bN(t.uid).then(E=>{o(E)})},[t]);const f=async()=>{try{await zf(Hn),n("/")}catch(E){console.error("Error signing out:",E)}},m=()=>{d.current&&clearTimeout(d.current),a(!0)},_=()=>{d.current=setTimeout(()=>{a(!1)},200)};return t?s.jsxs("div",{className:`dashboard ${h?"dashboard-mobile":""}`,children:[h?s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"header header-mobile",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"header-inner",children:[s.jsx("button",{className:"mobile-menu-btn",onClick:()=>u(!0),"aria-label":"Otevt menu",children:s.jsx("i",{className:"fas fa-bars"})}),s.jsxs(ie,{to:"/dashboard",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:s.jsx("i",{className:"fas fa-sailboat"})}),"SailPlan"]}),s.jsx(ie,{to:"/profile",className:"profile-btn-mobile",children:s.jsx("div",{className:"profile-avatar",children:i})})]})})}),s.jsx(b2,{isOpen:l,onClose:()=>u(!1),currentUser:t}),s.jsx(EN,{onMenuClick:()=>u(!0)})]}):s.jsx("header",{className:"header",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"header-inner",children:[s.jsxs(ie,{to:"/dashboard",className:"logo",children:[s.jsx("div",{className:"logo-icon",children:""}),"SailPlan"]}),s.jsx("nav",{className:"nav",children:s.jsxs("ul",{className:"nav-links",children:[s.jsx("li",{children:s.jsx(ie,{to:"/dashboard",className:`nav-link ${e.pathname==="/dashboard"?"active":""}`,children:"Dashboard"})}),s.jsx("li",{children:s.jsx(ie,{to:"/trips",className:`nav-link ${e.pathname==="/trips"?"active":""}`,children:"M plavby"})}),s.jsx("li",{children:s.jsx(ie,{to:"/organizing",className:`nav-link ${e.pathname==="/organizing"?"active":""}`,children:"Organizuji"})})]})}),s.jsx("div",{className:"header-actions",children:s.jsxs("div",{className:"profile-btn",onMouseEnter:m,onMouseLeave:_,children:[s.jsx("div",{className:"profile-avatar",children:i}),r&&s.jsxs("div",{className:"dropdown",onMouseEnter:m,onMouseLeave:_,children:[s.jsxs("div",{className:"dropdown-item",style:{flexDirection:"column",alignItems:"flex-start",padding:"var(--space-md)"},children:[s.jsx("div",{style:{fontWeight:600,color:"var(--ocean-deep)"},children:(t==null?void 0:t.displayName)||"Uivatel"}),s.jsx("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",marginTop:"var(--space-xs)"},children:t==null?void 0:t.email})]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs(ie,{to:"/profile",className:"dropdown-item",onClick:()=>a(!1),children:[s.jsx("i",{className:"fas fa-user"}),"Mj profil"]}),s.jsxs(ie,{to:"/settings/organizer",className:"dropdown-item",onClick:()=>a(!1),children:[s.jsx("i",{className:"fas fa-cog"}),"Nastaven organiztora"]}),s.jsx("div",{className:"dropdown-divider"}),s.jsxs("button",{className:"dropdown-item",onClick:f,style:{width:"100%",textAlign:"left",border:"none",background:"none",cursor:"pointer"},children:[s.jsx("i",{className:"fas fa-sign-out-alt"}),"Odhlsit se"]})]})]})})]})})}),s.jsx("main",{className:`dashboard-content ${h?"dashboard-content-mobile":""}`,children:s.jsx(wE,{})})]}):null}function Mt({children:t}){const{user:e,loading:n}=yt(),r=ar(),[a,i]=C.useState(!0),[o,l]=C.useState(!1);return C.useEffect(()=>{n||(async()=>{if(!e){i(!1);return}const d=await fc(e.uid);l(d),i(!1)})()},[e,n]),n||a?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx("div",{children:"Natn..."})}):e?o?t:(sessionStorage.setItem("onboardingReturnUrl",r.pathname+r.search),s.jsx(Aa,{to:"/onboarding?mode=onboarding",replace:!0})):(sessionStorage.setItem("onboardingReturnUrl",r.pathname+r.search),s.jsx(Aa,{to:"/",replace:!0}))}function T2(){const{tripId:t}=ir();return s.jsx(Aa,{to:`/onboarding?mode=join-trip&tripId=${t}`,replace:!0})}function E2(){const{user:t,loading:e}=yt();return e?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx("div",{children:"Natn..."})}):s.jsxs(_E,{children:[s.jsx(Xe,{path:"/",element:t?s.jsx(Aa,{to:"/dashboard"}):s.jsx($D,{})}),s.jsx(Xe,{path:"/login",element:t?s.jsx(Aa,{to:"/dashboard"}):s.jsx(WD,{})}),s.jsx(Xe,{path:"/register",element:s.jsx(Aa,{to:"/onboarding?mode=register",replace:!0})}),s.jsx(Xe,{path:"/join-trip/:tripId",element:s.jsx(T2,{})}),s.jsx(Xe,{path:"/onboarding",element:s.jsx(HD,{})}),s.jsx(Xe,{path:"/trip/:tripId/public",element:s.jsx(g2,{})}),s.jsxs(Xe,{element:s.jsx(k2,{}),children:[s.jsx(Xe,{path:"/dashboard",element:s.jsx(Mt,{children:s.jsx(KD,{})})}),s.jsx(Xe,{path:"/trips",element:s.jsx(Mt,{children:s.jsx(GD,{})})}),s.jsx(Xe,{path:"/organizing",element:s.jsx(Mt,{children:s.jsx(QD,{})})}),s.jsx(Xe,{path:"/trip/new",element:s.jsx(Mt,{children:s.jsx(mx,{})})}),s.jsx(Xe,{path:"/trip/:tripId/edit",element:s.jsx(Mt,{children:s.jsx(mx,{})})}),s.jsx(Xe,{path:"/trip/:tripId/organizer",element:s.jsx(Mt,{children:s.jsx(l2,{})})}),s.jsx(Xe,{path:"/trip/:tripId/captain",element:s.jsx(Mt,{children:s.jsx(p2,{})})}),s.jsx(Xe,{path:"/trip/:tripId/participant",element:s.jsx(Mt,{children:s.jsx(m2,{})})}),s.jsx(Xe,{path:"/trip/:tripId/boat/new",element:s.jsx(Mt,{children:s.jsx(yx,{})})}),s.jsx(Xe,{path:"/trip/:tripId/boat/:boatId/edit",element:s.jsx(Mt,{children:s.jsx(yx,{})})}),s.jsx(Xe,{path:"/trip/:tripId/boat/:boatId",element:s.jsx(Mt,{children:s.jsx(w2,{})})}),s.jsx(Xe,{path:"/trip/:tripId/participant/:participantId",element:s.jsx(Mt,{children:s.jsx(j2,{})})}),s.jsx(Xe,{path:"/profile",element:s.jsx(Mt,{children:s.jsx(N2,{})})}),s.jsx(Xe,{path:"/settings/organizer",element:s.jsx(Mt,{children:s.jsx(v2,{})})}),s.jsx(Xe,{path:"/checklist/new",element:s.jsx(Mt,{children:s.jsx(xx,{})})}),s.jsx(Xe,{path:"/checklist/:checklistId/edit",element:s.jsx(Mt,{children:s.jsx(xx,{})})})]})]})}Yd.createRoot(document.getElementById("root")).render(s.jsx(Tp.StrictMode,{children:s.jsx(CE,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:s.jsx(E2,{})})}));
